{ 
  "text" : "An issue was discovered on BLU Advance 5.0 and BLU R1 HD devices with Shanghai Adups software. The com.adups.fota.sysoper app is installed as a system app and cannot be disabled by the user. In the com.adups.fota.sysoper app's AndroidManifest.xml file, it sets the android:sharedUserId attribute to a value of android.uid.system which makes it execute as the system user, which is a very privileged user on the device. The app has an exported broadcast receiver named com.adups.fota.sysoper.WriteCommandReceiver which any app on the device can interact with. Therefore, any app can send a command embedded in an intent which will be executed by the WriteCommandReceiver component which is executing as the system user. The third-party app, utilizing the WriteCommandReceiver, can perform the following actions: call a phone number, factory reset the device, take pictures of the screen, record the screen in a video, install applications, inject events, obtain the Android log, and others. In addition, the com.adups.fota.sysoper.TaskService component will make a request to a URL of http://rebootv5.adsunflower.com/ps/fetch.do where the commands in the String array with a key of sf in the JSON Object sent back by the server will be executed as the system user. Since the connection is made via HTTP, it is vulnerable to a MITM attack.\n" ,
  "entities" : [ { 
    "eid" : "E1" ,
    "keyid" : "Endpoint#d832d99ddc479904a0dbce84eaec23d3" ,
    "type" : "Endpoint" ,
    "subType" : "Endpoint" ,
    "value" : "rebootv5.adsunflower.com:80" ,
    "begin" : -1 ,
    "end" : -1 ,
    "canonicalForm" : "rebootv5.adsunflower.com:80" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E2" ,
    "keyid" : "Port#f033ab37c30201f73f142449d037028d" ,
    "type" : "Port" ,
    "subType" : "Port" ,
    "value" : "80" ,
    "begin" : -1 ,
    "end" : -1 ,
    "canonicalForm" : "80" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E3" ,
    "keyid" : "0aae4c8f3cc35693d0cbbe631f2e8b52" ,
    "type" : "MiscEntity" ,
    "subType" : "issue" ,
    "value" : "issue" ,
    "begin" : 3 ,
    "end" : 8 ,
    "canonicalForm" : "issue" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E4" ,
    "keyid" : "Location#22638a3131d0f0a7346b178fd29f939c" ,
    "type" : "Location" ,
    "subType" : "Location" ,
    "value" : "shanghai" ,
    "begin" : 70 ,
    "end" : 78 ,
    "canonicalForm" : "Shanghai" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E5" ,
    "keyid" : "FileName#a48d6def78e18cbabab3c95ae3c9fc49" ,
    "type" : "FileName" ,
    "subType" : "FileName" ,
    "value" : "AndroidManifest.xml" ,
    "begin" : 227 ,
    "end" : 246 ,
    "canonicalForm" : "AndroidManifest.xml" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E6" ,
    "keyid" : "Product#c31b32364ce19ca8fcd150a417ecce58" ,
    "type" : "Product" ,
    "subType" : "OperatingSystem" ,
    "value" : "android" ,
    "begin" : 265 ,
    "end" : 272 ,
    "canonicalForm" : "android" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E7" ,
    "keyid" : "AvSignature#ca4726f681e41c15f7267f8b6133097b" ,
    "type" : "AvSignature" ,
    "subType" : "AvSignature" ,
    "value" : "android.uid.system" ,
    "begin" : 310 ,
    "end" : 328 ,
    "canonicalForm" : "android.uid.system" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E8" ,
    "keyid" : "Product#c31b32364ce19ca8fcd150a417ecce58" ,
    "type" : "Product" ,
    "subType" : "OperatingSystem" ,
    "value" : "android" ,
    "begin" : 310 ,
    "end" : 317 ,
    "canonicalForm" : "android" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E9" ,
    "keyid" : "Identity#c31b32364ce19ca8fcd150a417ecce58" ,
    "type" : "Identity" ,
    "subType" : "Organization" ,
    "value" : "android" ,
    "begin" : 965 ,
    "end" : 972 ,
    "canonicalForm" : "Android" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E10" ,
    "keyid" : "Product#c31b32364ce19ca8fcd150a417ecce58" ,
    "type" : "Product" ,
    "subType" : "OperatingSystem" ,
    "value" : "android" ,
    "begin" : 965 ,
    "end" : 972 ,
    "canonicalForm" : "Android" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E11" ,
    "keyid" : "URL#d5d9bf1943dfe29775071981fa0518ad" ,
    "type" : "URL" ,
    "subType" : "URL" ,
    "value" : "http://rebootv5.adsunflower.com/ps" ,
    "begin" : 1084 ,
    "end" : 1118 ,
    "canonicalForm" : "http://rebootv5.adsunflower.com/ps" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E12" ,
    "keyid" : "Protocol#80791b3ae7002cb88c246876d9faa8f8" ,
    "type" : "Protocol" ,
    "subType" : "Protocol" ,
    "value" : "http" ,
    "begin" : 1084 ,
    "end" : 1088 ,
    "canonicalForm" : "http" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E13" ,
    "keyid" : "DomainName#9edd7d7b47c44ee8f481fab9b35adca4" ,
    "type" : "DomainName" ,
    "subType" : "DomainName" ,
    "value" : "rebootv5.adsunflower.com" ,
    "begin" : 1091 ,
    "end" : 1115 ,
    "canonicalForm" : "rebootv5.adsunflower.com" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E14" ,
    "keyid" : "DomainName#9c4289fedea2bfac7e449cd19f45b11c" ,
    "type" : "DomainName" ,
    "subType" : "DomainName" ,
    "value" : "adsunflower.com" ,
    "begin" : 1100 ,
    "end" : 1115 ,
    "canonicalForm" : "adsunflower.com" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E15" ,
    "keyid" : "FilePath#adbefd990bdf38505773332bea2ff6b2" ,
    "type" : "FilePath" ,
    "subType" : "FilePath" ,
    "value" : "/ps/fetch" ,
    "begin" : 1115 ,
    "end" : 1124 ,
    "canonicalForm" : "/ps/fetch" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E16" ,
    "keyid" : "UrlPath#9fbc3f0cafbd30673f319cb0a1681c3f" ,
    "type" : "UrlPath" ,
    "subType" : "UrlPath" ,
    "value" : "/ps" ,
    "begin" : 1115 ,
    "end" : 1118 ,
    "canonicalForm" : "/ps" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E17" ,
    "keyid" : "DomainName#14d8dcde5a0655364211a1a0efc445bc" ,
    "type" : "DomainName" ,
    "subType" : "DomainName" ,
    "value" : "fetch.do" ,
    "begin" : 1119 ,
    "end" : 1127 ,
    "canonicalForm" : "fetch.do" ,
    "score" : "0.0"
  }
  ,  ] ,
  "relations" : [ { 
    "rid" : "R1" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1084 ,
      "end" : 1118 ,
      "eid" : "E11" ,
      "canonicalForm" : "http://rebootv5.adsunflower.com/ps"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1119 ,
      "end" : 1127 ,
      "eid" : "E17" ,
      "canonicalForm" : "fetch.do"
    }
    ,  ]
  }
  , { 
    "rid" : "R2" ,
    "type" : "SUBDOMAIN" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1091 ,
      "end" : 1115 ,
      "eid" : "E13" ,
      "canonicalForm" : "rebootv5.adsunflower.com"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1100 ,
      "end" : 1115 ,
      "eid" : "E14" ,
      "canonicalForm" : "adsunflower.com"
    }
    ,  ]
  }
  , { 
    "rid" : "R3" ,
    "type" : "relatedFilePath" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1115 ,
      "end" : 1124 ,
      "eid" : "E15" ,
      "canonicalForm" : "/ps/fetch"
    }
    ,  ]
  }
  , { 
    "rid" : "R4" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1084 ,
      "end" : 1118 ,
      "eid" : "E11" ,
      "canonicalForm" : "http://rebootv5.adsunflower.com/ps"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1115 ,
      "end" : 1124 ,
      "eid" : "E15" ,
      "canonicalForm" : "/ps/fetch"
    }
    ,  ]
  }
  , { 
    "rid" : "R5" ,
    "type" : "relatedFileName" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 227 ,
      "end" : 246 ,
      "eid" : "E5" ,
      "canonicalForm" : "AndroidManifest.xml"
    }
    ,  ]
  }
  , { 
    "rid" : "R6" ,
    "type" : "CONTAINS" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : -1 ,
      "end" : -1 ,
      "eid" : "E1" ,
      "canonicalForm" : "rebootv5.adsunflower.com:80"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1091 ,
      "end" : 1115 ,
      "eid" : "E13" ,
      "canonicalForm" : "rebootv5.adsunflower.com"
    }
    ,  ]
  }
  , { 
    "rid" : "R7" ,
    "type" : "relatedDomainName" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1119 ,
      "end" : 1127 ,
      "eid" : "E17" ,
      "canonicalForm" : "fetch.do"
    }
    ,  ]
  }
  , { 
    "rid" : "R8" ,
    "type" : "CONTAINS" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1084 ,
      "end" : 1118 ,
      "eid" : "E11" ,
      "canonicalForm" : "http://rebootv5.adsunflower.com/ps"
    }
    , { 
      "argnum" : 2 ,
      "begin" : -1 ,
      "end" : -1 ,
      "eid" : "E1" ,
      "canonicalForm" : "rebootv5.adsunflower.com:80"
    }
    ,  ]
  }
  , { 
    "rid" : "R9" ,
    "type" : "CONTAINS" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1084 ,
      "end" : 1118 ,
      "eid" : "E11" ,
      "canonicalForm" : "http://rebootv5.adsunflower.com/ps"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1115 ,
      "end" : 1118 ,
      "eid" : "E16" ,
      "canonicalForm" : "/ps"
    }
    ,  ]
  }
  , { 
    "rid" : "R10" ,
    "type" : "CONTAINS" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1084 ,
      "end" : 1118 ,
      "eid" : "E11" ,
      "canonicalForm" : "http://rebootv5.adsunflower.com/ps"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1084 ,
      "end" : 1088 ,
      "eid" : "E12" ,
      "canonicalForm" : "http"
    }
    ,  ]
  }
  , { 
    "rid" : "R11" ,
    "type" : "relatedProduct" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 265 ,
      "end" : 272 ,
      "eid" : "E6" ,
      "canonicalForm" : "android"
    }
    ,  ]
  }
  , { 
    "rid" : "R12" ,
    "type" : "relatedProduct" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 965 ,
      "end" : 972 ,
      "eid" : "E10" ,
      "canonicalForm" : "Android"
    }
    ,  ]
  }
  , { 
    "rid" : "R13" ,
    "type" : "discovered_on" ,
    "predicate" : { 
      "begin" : 13 ,
      "end" : 26 ,
      "surfaceForm" : "discovered on"
    }
     ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 3 ,
      "end" : 8 ,
      "eid" : "E3" ,
      "canonicalForm" : "issue"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 70 ,
      "end" : 78 ,
      "eid" : "E4" ,
      "canonicalForm" : "Shanghai"
    }
    ,  ]
  }
  , { 
    "rid" : "R14" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 1115 ,
      "end" : 1124 ,
      "eid" : "E15" ,
      "canonicalForm" : "/ps/fetch"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1119 ,
      "end" : 1127 ,
      "eid" : "E17" ,
      "canonicalForm" : "fetch.do"
    }
    ,  ]
  }
  , { 
    "rid" : "R15" ,
    "type" : "relatedIdentity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 965 ,
      "end" : 972 ,
      "eid" : "E9" ,
      "canonicalForm" : "Android"
    }
    ,  ]
  }
  , { 
    "rid" : "R16" ,
    "type" : "relatedURL" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 1084 ,
      "end" : 1118 ,
      "eid" : "E11" ,
      "canonicalForm" : "http://rebootv5.adsunflower.com/ps"
    }
    ,  ]
  }
  , { 
    "rid" : "R17" ,
    "type" : "CONTAINS" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : -1 ,
      "end" : -1 ,
      "eid" : "E1" ,
      "canonicalForm" : "rebootv5.adsunflower.com:80"
    }
    , { 
      "argnum" : 2 ,
      "begin" : -1 ,
      "end" : -1 ,
      "eid" : "E2" ,
      "canonicalForm" : "80"
    }
    ,  ]
  }
  , { 
    "rid" : "R18" ,
    "type" : "relatedLocation" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 310 ,
      "end" : 328 ,
      "eid" : "E7" ,
      "canonicalForm" : "android.uid.system"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 70 ,
      "end" : 78 ,
      "eid" : "E4" ,
      "canonicalForm" : "Shanghai"
    }
    ,  ]
  }
  ,  ]
}
