{ 
  "text" : "TeamPass before 2.1.27.9 does not properly enforce manager access control when requesting users.queries.php. It is then possible for a manager user to delete an arbitrary user (including admin), or modify attributes of any arbitrary user except administrator. To exploit the vulnerability, an authenticated attacker must have the manager rights on the application, then tamper with the requests sent directly, for example by changing the \"id\" parameter when invoking \"delete_user\" on users.queries.php.\n" ,
  "entities" : [ { 
    "eid" : "E1" ,
    "keyid" : "IpAddress#d937d9322d8eda215f98ca8a5c6c0b5f" ,
    "type" : "IpAddress" ,
    "subType" : "ipv4" ,
    "value" : "0x00000000000000000000ffff211b9" ,
    "begin" : 16 ,
    "end" : 24 ,
    "canonicalForm" : "2.1.27.9" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E2" ,
    "keyid" : "cd99fa2da13f9fe9f948db4c961af483" ,
    "type" : "MiscEntity" ,
    "subType" : "control" ,
    "value" : "manager access control" ,
    "begin" : 51 ,
    "end" : 73 ,
    "canonicalForm" : "manager access control" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E3" ,
    "keyid" : "FileName#3ff929d0bac1b0a2966eb8c57e25979e" ,
    "type" : "FileName" ,
    "subType" : "FileName" ,
    "value" : "queries.php" ,
    "begin" : 96 ,
    "end" : 107 ,
    "canonicalForm" : "queries.php" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E4" ,
    "keyid" : "ThreatActor#20fe593b16d096a317ecf22f544add30" ,
    "type" : "ThreatActor" ,
    "subType" : "ThreatActor" ,
    "value" : "authenticated attacker" ,
    "begin" : 293 ,
    "end" : 315 ,
    "canonicalForm" : "authenticated attacker" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E5" ,
    "keyid" : "512dae4ed007a74964deb483ca2ab705" ,
    "type" : "MiscEntity" ,
    "subType" : "right" ,
    "value" : "manager right" ,
    "begin" : 330 ,
    "end" : 363 ,
    "canonicalForm" : "manager right" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E6" ,
    "keyid" : "FileName#3ff929d0bac1b0a2966eb8c57e25979e" ,
    "type" : "FileName" ,
    "subType" : "FileName" ,
    "value" : "queries.php" ,
    "begin" : 490 ,
    "end" : 501 ,
    "canonicalForm" : "queries.php" ,
    "score" : "0.0"
  }
  ,  ] ,
  "relations" : [ { 
    "rid" : "R1" ,
    "type" : "tamper_with" ,
    "predicate" : { 
      "begin" : 316 ,
      "end" : 381 ,
      "surfaceForm" : "must have the manager rights on the application, then tamper with"
    }
     ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 293 ,
      "end" : 315 ,
      "eid" : "E4" ,
      "canonicalForm" : "authenticated attacker"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 330 ,
      "end" : 363 ,
      "eid" : "E5" ,
      "canonicalForm" : "manager right"
    }
    ,  ]
  }
  , { 
    "rid" : "R2" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 293 ,
      "end" : 315 ,
      "eid" : "E4" ,
      "canonicalForm" : "authenticated attacker"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 490 ,
      "end" : 501 ,
      "eid" : "E6" ,
      "canonicalForm" : "queries.php"
    }
    ,  ]
  }
  , { 
    "rid" : "R3" ,
    "type" : "not_enforce" ,
    "predicate" : { 
      "begin" : 25 ,
      "end" : 50 ,
      "surfaceForm" : "does not properly enforce"
    }
     ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 16 ,
      "end" : 24 ,
      "eid" : "E1" ,
      "canonicalForm" : "2.1.27.9"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 51 ,
      "end" : 73 ,
      "eid" : "E2" ,
      "canonicalForm" : "manager access control"
    }
    ,  ]
  }
  , { 
    "rid" : "R4" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 16 ,
      "end" : 24 ,
      "eid" : "E1" ,
      "canonicalForm" : "2.1.27.9"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 96 ,
      "end" : 107 ,
      "eid" : "E3" ,
      "canonicalForm" : "queries.php"
    }
    ,  ]
  }
  ,  ]
}
