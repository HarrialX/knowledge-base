{ 
  "text" : "Nagios XI before 5.6.6 allows remote command execution as root. The exploit requires access to the server as the nagios user, or access as the admin user via the web interface. The getprofile.sh script, invoked by downloading a system profile (profile.php?cmd=download), is executed as root via a passwordless sudo entry; the script executes check_plugin, which is owned by the nagios user. A user logged into Nagios XI with permissions to modify plugins, or the nagios user on the server, can modify the check_plugin executable and insert malicious commands to execute as root.\n" ,
  "entities" : [ { 
    "eid" : "E1" ,
    "keyid" : "Product#4a35675d04046649d72569aa278fc5cf" ,
    "type" : "Product" ,
    "subType" : "Application" ,
    "value" : "nagios xi" ,
    "begin" : 0 ,
    "end" : 9 ,
    "canonicalForm" : "Nagios XI" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E2" ,
    "keyid" : "Identity#0eb0a38cfbcf77985e4d281b78cc3336" ,
    "type" : "Identity" ,
    "subType" : "Organization" ,
    "value" : "nagios" ,
    "begin" : 0 ,
    "end" : 6 ,
    "canonicalForm" : "Nagios" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E3" ,
    "keyid" : "TTP#9b18e4fe14c0ae110aba6d96f7fa8cf0" ,
    "type" : "TTP" ,
    "subType" : "TTP" ,
    "value" : "remote command execution" ,
    "begin" : 30 ,
    "end" : 54 ,
    "canonicalForm" : "remote command execution" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E4" ,
    "keyid" : "63a9f0ea7bb98050796b649e85481845" ,
    "type" : "MiscEntity" ,
    "subType" : "root" ,
    "value" : "root" ,
    "begin" : 58 ,
    "end" : 62 ,
    "canonicalForm" : "root" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E5" ,
    "keyid" : "FileName#448dced686cfe27ee608fc30ad3546f3" ,
    "type" : "FileName" ,
    "subType" : "FileName" ,
    "value" : "getprofile.sh" ,
    "begin" : 181 ,
    "end" : 194 ,
    "canonicalForm" : "getprofile.sh" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E6" ,
    "keyid" : "DomainName#448dced686cfe27ee608fc30ad3546f3" ,
    "type" : "DomainName" ,
    "subType" : "DomainName" ,
    "value" : "getprofile.sh" ,
    "begin" : 181 ,
    "end" : 194 ,
    "canonicalForm" : "getprofile.sh" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E7" ,
    "keyid" : "FileName#0c9a0d007d4ec630fce23854067a6df1" ,
    "type" : "FileName" ,
    "subType" : "FileName" ,
    "value" : "(profile.php" ,
    "begin" : 243 ,
    "end" : 255 ,
    "canonicalForm" : "(profile.php" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E8" ,
    "keyid" : "ee11cbb19052e40b07aac0ca060c23ee" ,
    "type" : "MiscEntity" ,
    "subType" : "user" ,
    "value" : "user" ,
    "begin" : 393 ,
    "end" : 397 ,
    "canonicalForm" : "user" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E9" ,
    "keyid" : "Product#4a35675d04046649d72569aa278fc5cf" ,
    "type" : "Product" ,
    "subType" : "Application" ,
    "value" : "nagios xi" ,
    "begin" : 410 ,
    "end" : 419 ,
    "canonicalForm" : "Nagios XI" ,
    "score" : "0.0"
  }
  , { 
    "eid" : "E10" ,
    "keyid" : "Identity#0eb0a38cfbcf77985e4d281b78cc3336" ,
    "type" : "Identity" ,
    "subType" : "Organization" ,
    "value" : "nagios" ,
    "begin" : 410 ,
    "end" : 416 ,
    "canonicalForm" : "Nagios" ,
    "score" : "0.0"
  }
  ,  ] ,
  "relations" : [ { 
    "rid" : "R1" ,
    "type" : "allow" ,
    "predicate" : { 
      "begin" : 23 ,
      "end" : 29 ,
      "surfaceForm" : "allows"
    }
     ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 0 ,
      "end" : 9 ,
      "eid" : "E1" ,
      "canonicalForm" : "Nagios XI"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 30 ,
      "end" : 54 ,
      "eid" : "E3" ,
      "canonicalForm" : "remote command execution"
    }
    ,  ]
  }
  , { 
    "rid" : "R2" ,
    "type" : "allow_as" ,
    "predicate" : { 
      "begin" : 23 ,
      "end" : 57 ,
      "surfaceForm" : "allows remote command execution as"
    }
     ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 30 ,
      "end" : 54 ,
      "eid" : "E3" ,
      "canonicalForm" : "remote command execution"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 58 ,
      "end" : 62 ,
      "eid" : "E4" ,
      "canonicalForm" : "root"
    }
    ,  ]
  }
  , { 
    "rid" : "R3" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 181 ,
      "end" : 194 ,
      "eid" : "E5" ,
      "canonicalForm" : "getprofile.sh"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 243 ,
      "end" : 255 ,
      "eid" : "E7" ,
      "canonicalForm" : "(profile.php"
    }
    ,  ]
  }
  , { 
    "rid" : "R4" ,
    "type" : "relatedEntity" ,
    "predicate" : { } ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 181 ,
      "end" : 194 ,
      "eid" : "E6" ,
      "canonicalForm" : "getprofile.sh"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 243 ,
      "end" : 255 ,
      "eid" : "E7" ,
      "canonicalForm" : "(profile.php"
    }
    ,  ]
  }
  , { 
    "rid" : "R5" ,
    "type" : "log_into" ,
    "predicate" : { 
      "begin" : 398 ,
      "end" : 409 ,
      "surfaceForm" : "logged into"
    }
     ,
    "arguments" : [ { 
      "argnum" : 1 ,
      "begin" : 393 ,
      "end" : 397 ,
      "eid" : "E8" ,
      "canonicalForm" : "user"
    }
    , { 
      "argnum" : 2 ,
      "begin" : 410 ,
      "end" : 416 ,
      "eid" : "E10" ,
      "canonicalForm" : "Nagios"
    }
    ,  ]
  }
  ,  ]
}
