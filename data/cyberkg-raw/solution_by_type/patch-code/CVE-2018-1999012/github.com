Original Source:
https://github.com/FFmpeg/FFmpeg/commit/9807d3976be0e92e4ece3b4b1701be894cd7c2e1

Commit history:

  @@ -134,6 +134,10 @@ static int read_part_of_packet(AVFormatContext *s, int64_t *pts,
              pes_flags              = avio_rb16(pb);
              pes_header_data_length = avio_r8(pb);
  
+  if (avio_feof(pb)) {
+  return AVERROR_EOF;
+             }
+ 
   if (pes_signal != 1 || pes_header_data_length == 0) {
   pva_log(s, AV_LOG_WARNING, "expected non empty signaled PES packet, "
   "trying to recover\n");
  
