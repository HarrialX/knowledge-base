Original Source:
https://github.com/vim/vim/commit/399c297aa93afe2c0a39e2a1b3f972aebba44c9d

Commit history:

  @@ -1595,6 +1595,9 @@ spell_read_tree(
      len = get4c(fd);
   if (len < 0)
   return SP_TRUNCERROR;
+  if (len >= 0x3ffffff)
+  /* Invalid length, multiply with sizeof(int) would overflow. */
+  return SP_FORMERROR;
   if (len > 0)
      {
   /* Allocate the byte array. */
  
  @@ -764,6 +764,8 @@ static char *(features[]) =
  
  static int included_patches[] =
  {   /* Add new patch number below this line */
+ /**/
+  322,
  /**/
   321,
  /**/
  
