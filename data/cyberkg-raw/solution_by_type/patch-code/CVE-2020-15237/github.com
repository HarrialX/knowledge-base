Original Source:
https://github.com/shrinerb/shrine/commit/1b27090ce31543bf39f186c20ea47c8250fca2f0

Commit history:

  @@ -1,5 +1,7 @@
  ## master
  
+ * `derivation_endpoint` – Avoid possibility of timing attacks when comparing signatures (@esparta)
+ 
  * `derivatives` – Avoid downloading the attached file when calling default no-op processor (@janko)
  
  * `derivatives` – Add `:download` processor setting for skipping downloading source file (@jrochkind, @janko)
  
  @@ -739,7 +739,7 @@ def verify_url(url)
   def verify_signature(string, signature)
   if signature.nil?
   fail InvalidSignature, "missing \"signature\" param"
-  elsif signature != generate_signature(string)
+  elsif !Rack::Utils.secure_compare(signature, generate_signature(string))
   fail InvalidSignature, "provided signature does not match the calculated signature"
   end
   end
  
