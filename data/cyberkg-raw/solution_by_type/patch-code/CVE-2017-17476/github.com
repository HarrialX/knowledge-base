Original Source:
https://github.com/OTRS/otrs/commit/720c73fbf53e476ca7dfdf2ae1d4d3d2aad2b953

Commit history:

  @@ -214,7 +214,7 @@ sub Output {
   my $Target  = $2;
   my $End     = $3;
   my $RealEnd = $4;
-  if ( lc $Target =~ /^(http:|https:|#|ftp:)/ ||
+  if ( lc($Target) =~ /^(http:|https:|#|ftp:)/ ||
   $Target !~ /\.(pl|php|cgi|fcg|fcgi|fpl)(\?|$)/ ||
   $Target =~ /(\?|&|;)\Q$Self->{SessionName}\E=/) {
   $AHref.$Target.$End.$RealEnd;
  @@ -232,7 +232,7 @@ sub Output {
   my $AHref = $1;
   my $Target = $2;
   my $End = $3;
-  if (lc $Target =~ m{^http s? :}smx || !$Self->{SessionID} ||
+  if (lc($Target) =~ m{^http s? :}smx || !$Self->{SessionID} ||
   $Target !~ /\.(pl|php|cgi|fcg|fcgi|fpl)(\?|$)/ ||
   $Target =~ /\Q$Self->{SessionName}\E=/) {
   $AHref.$Target.$End;
  
