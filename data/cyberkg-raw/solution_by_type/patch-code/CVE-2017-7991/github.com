Original Source:
https://github.com/exponentcms/exponent-cms/commit/67a9c2f0229de120431f3eecb0f5017075517105

Commit history:

  @@ -80,6 +80,8 @@ public function api() {
   $ar->send();  //FIXME this doesn't seem to work correctly in this scenario
          } else {
   $key = expUnserialize(base64_decode(urldecode($this->params['apikey'])));
+  preg_match('/[^a-zA-Z_][^a-zA-Z0-9_]*/', $key, $matches);
+  $key = $matches[0];
   $cfg = new expConfig($key);
   $this->config = $cfg->config;
   if(empty($cfg->id)) {
  
