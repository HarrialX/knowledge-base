Original Source:
https://github.com/upx/upx/commit/28e761cd42211dfe0124b7a29b2f74730f453e46

Commit history:

  @@ -1552,6 +1552,9 @@ int PackMachBase<T>::canUnpack()
   if (2048 < headway) {
   infoWarning("Mach_header.sizeofcmds(%d) > 2048", headway);
      }
+  if(!headway){
+  throwCantPack("Mach_header.sizeofcmds == 0");
+     }
      rawmseg_buf.alloc(mhdri.sizeofcmds);
      rawmseg = (Mach_segment_command *)rawmseg_buf.getVoidPtr();
      fi->readx(rawmseg, mhdri.sizeofcmds);
  
