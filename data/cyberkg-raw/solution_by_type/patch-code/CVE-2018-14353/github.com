Original Source:
https://github.com/neomutt/neomutt/commit/65d64a5b60a4a3883f2cd799d92c6091d8854f23

Commit history:

  @@ -821,9 +821,9 @@ void imap_quote_string(char *dest, size_t dlen, const char *src, bool quote_back
    {
   if (strchr(quote, *s))
      {
-       dlen -= 2;
-  if (dlen == 0)
+  if (dlen < 2)
   break;
+       dlen -= 2;
        *pt++ = '\\';
        *pt++ = *s;
      }
  
