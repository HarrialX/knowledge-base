Original Source:
https://github.com/php/php-src/commit/b88393f08a558eec14964a55d3c680fe67407712?w=1

Commit history:

  @@ -0,0 +1,27 @@
+ --TEST--
+ Bug #72860: wddx_deserialize use-after-free
+ --SKIPIF--
+ <?php
+ if (!extension_loaded('wddx')) {
+  die('skip. wddx not available');
+ }
+ ?>
+ --FILE--
+ <?php
+ 
+ $xml=<<<XML
+ <?xml version='1.0'?>
+ <!DOCTYPE wddxPacket SYSTEM 'wddx_0100.dtd'>
+ <wddxPacket version='1.0'>
+        <recordset fieldNames='F'>
+                <field name='F'>
+        </recordset>
+ </wddxPacket>
+ XML;
+ 
+ var_dump(wddx_deserialize($xml));
+ ?>
+ DONE
+ --EXPECT--
+ NULL
+ DONE
  @@ -230,7 +230,8 @@ static int wddx_stack_destroy(wddx_stack *stack)
  
   if (stack->elements) {
   for (i = 0; i < stack->top; i++) {
-  if (((st_entry *)stack->elements[i])->data)	{
+  if (((st_entry *)stack->elements[i])->data
+ 					&& ((st_entry *)stack->elements[i])->type != ST_FIELD)	{
   zval_ptr_dtor(&((st_entry *)stack->elements[i])->data);
  			}
   if (((st_entry *)stack->elements[i])->varname) {
  
