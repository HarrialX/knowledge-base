Original Source:
https://github.com/torvalds/linux/commit/c4baad50297d84bde1a7ad45e50c73adae4a2192

Commit history:

  @@ -1136,6 +1136,8 @@ static int put_chars(u32 vtermno, const char *buf, int count)
  {
   struct port *port;
   struct scatterlist sg[1];
+  void *data;
+  int ret;
  
   if (unlikely(early_put_chars))
   return early_put_chars(vtermno, buf, count);
  @@ -1144,8 +1146,14 @@ static int put_chars(u32 vtermno, const char *buf, int count)
   if (!port)
   return -EPIPE;
  
-  sg_init_one(sg, buf, count);
-  return __send_to_port(port, sg, 1, count, (void *)buf, false);
+ 	data = kmemdup(buf, count, GFP_ATOMIC);
+  if (!data)
+  return -ENOMEM;
+ 
+  sg_init_one(sg, data, count);
+ 	ret = __send_to_port(port, sg, 1, count, data, false);
+  kfree(data);
+  return ret;
  }
  
  /*
  
