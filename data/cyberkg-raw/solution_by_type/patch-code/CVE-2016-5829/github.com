Original Source:
https://github.com/torvalds/linux/commit/93a2001bdfd5376c3dc2158653034c20392d15c5

Commit history:

  @@ -516,13 +516,13 @@ static noinline int hiddev_ioctl_usage(struct hiddev *hiddev, unsigned int cmd,
   goto inval;
  			} else if (uref->usage_index >= field->report_count)
   goto inval;
- 
-  else if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&
- 				 (uref_multi->num_values > HID_MAX_MULTI_USAGES ||
- 				  uref->usage_index + uref_multi->num_values > field->report_count))
-  goto inval;
  		}
  
+  if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&
+ 		    (uref_multi->num_values > HID_MAX_MULTI_USAGES ||
+ 		     uref->usage_index + uref_multi->num_values > field->report_count))
+  goto inval;
+ 
   switch (cmd) {
   case HIDIOCGUSAGE:
  			uref->value = field->value[uref->usage_index];
  
