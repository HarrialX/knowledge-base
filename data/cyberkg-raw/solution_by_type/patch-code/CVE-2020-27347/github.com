Original Source:
https://github.com/tmux/tmux/commit/a868bacb46e3c900530bed47a1c6f85b0fbe701c

Commit history:

  @@ -1976,8 +1976,13 @@ input_csi_dispatch_sgr_colon(struct input_ctx *ictx, u_int i)
   free(copy);
   return;
  			}
- 		} else
+ 		} else {
  			n++;
+  if (n == nitems(p)) {
+  free(copy);
+  return;
+ 			}
+ 		}
   log_debug("%s: %u = %d", __func__, n - 1, p[n - 1]);
  	}
   free(copy);
  
