Original Source:
https://github.com/znc/znc/commit/2bd410ee5570cea127233f1133ea22f25174eb28

Commit history:

  @@ -426,7 +426,7 @@ class CWebAdminMod : public CModule {
  			CIRCNetwork* pNetwork = SafeGetNetworkFromParam(WebSock);
  
   // Admin||Self Check
-  if (!spSession->IsAdmin() && (!spSession->GetUser() || spSession->GetUser() != pNetwork->GetUser())) {
+  if (!spSession->IsAdmin() && (!spSession->GetUser() || !pNetwork || spSession->GetUser() != pNetwork->GetUser())) {
   return false;
  			}
  
  @@ -455,7 +455,7 @@ class CWebAdminMod : public CModule {
  			CIRCNetwork* pNetwork = SafeGetNetworkFromParam(WebSock);
  
   // Admin||Self Check
-  if (!spSession->IsAdmin() && (!spSession->GetUser() || spSession->GetUser() != pNetwork->GetUser())) {
+  if (!spSession->IsAdmin() && (!spSession->GetUser() || !pNetwork || spSession->GetUser() != pNetwork->GetUser())) {
   return false;
  			}
  
  @@ -479,7 +479,7 @@ class CWebAdminMod : public CModule {
  			CIRCNetwork* pNetwork = SafeGetNetworkFromParam(WebSock);
  
   // Admin||Self Check
-  if (!spSession->IsAdmin() && (!spSession->GetUser() || spSession->GetUser() != pNetwork->GetUser())) {
+  if (!spSession->IsAdmin() && (!spSession->GetUser() || !pNetwork || spSession->GetUser() != pNetwork->GetUser())) {
   return false;
  			}
  
  @@ -493,7 +493,7 @@ class CWebAdminMod : public CModule {
  			CIRCNetwork* pNetwork = SafeGetNetworkFromParam(WebSock);
  
   // Admin||Self Check
-  if (!spSession->IsAdmin() && (!spSession->GetUser() || spSession->GetUser() != pNetwork->GetUser())) {
+  if (!spSession->IsAdmin() && (!spSession->GetUser() || !pNetwork || spSession->GetUser() != pNetwork->GetUser())) {
   return false;
  			}
  
  
