Original Source:
https://github.com/ctz/rustls/commit/a93ee1abd2ab19ebe4bf9d684d56637ee54a6074

Commit history:

  @@ -179,7 +179,7 @@ impl Connection {
   self.do_tls_write_and_handle_error();
          }
  
-  if self.closing && !self.tls_session.wants_write() {
+  if self.closing {
   let _ = self.socket.shutdown(Shutdown::Both);
   self.close_back();
   self.closed = true;
  
