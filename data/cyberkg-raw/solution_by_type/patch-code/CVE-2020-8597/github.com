Original Source:
https://github.com/paulusmack/ppp/commit/8d7970b8f3db727fe798b65f3377fe6787575426

Commit history:

  @@ -1420,7 +1420,7 @@ int len;
  		}
  
   /* Not so likely to happen. */
-  if (vallen >= len + sizeof (rhostname)) {
+  if (len - vallen >= sizeof (rhostname)) {
   dbglog("EAP: trimming really long peer name down");
   BCOPY(inp + vallen, rhostname, sizeof (rhostname) - 1);
  			rhostname[sizeof (rhostname) - 1] = '\0';
  @@ -1846,7 +1846,7 @@ int len;
  		}
  
   /* Not so likely to happen. */
-  if (vallen >= len + sizeof (rhostname)) {
+  if (len - vallen >= sizeof (rhostname)) {
   dbglog("EAP: trimming really long peer name down");
   BCOPY(inp + vallen, rhostname, sizeof (rhostname) - 1);
  			rhostname[sizeof (rhostname) - 1] = '\0';
  
