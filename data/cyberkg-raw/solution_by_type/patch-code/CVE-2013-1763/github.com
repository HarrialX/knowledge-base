Original Source:
https://github.com/torvalds/linux/commit/6e601a53566d84e1ffd25e7b6fe0b6894ffd79c0

Commit history:

  @@ -121,6 +121,9 @@ static int __sock_diag_rcv_msg(struct sk_buff *skb, struct nlmsghdr *nlh)
   if (nlmsg_len(nlh) < sizeof(*req))
   return -EINVAL;
  
+  if (req->sdiag_family >= AF_MAX)
+  return -EINVAL;
+ 
  	hndl = sock_diag_lock_handler(req->sdiag_family);
   if (hndl == NULL)
  		err = -ENOENT;
  
