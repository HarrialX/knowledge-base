Original Source:
https://github.com/ImageMagick/ImageMagick/commit/82e2049862a8b8a999e160734ad64fb6cc3b145f

Commit history:

  @@ -2566,9 +2566,12 @@ static void RemoveICCProfileFromResourceBlock(StringInfo *bim_profile)
      p=PushLongPixel(MSBEndian,p,&count);
   if (id == 0x0000040f)
        {
-         (void) CopyMagickMemory(q,q+PSDQuantum(count)+12,length-
-           (PSDQuantum(count)+12)-(q-datum));
-  SetStringInfoLength(bim_profile,length-(PSDQuantum(count)+12));
+  if ((q+PSDQuantum(count)+12) < (datum+length-16))
+           {
+             (void) CopyMagickMemory(q,q+PSDQuantum(count)+12,length-
+               (PSDQuantum(count)+12)-(q-datum));
+  SetStringInfoLength(bim_profile,length-(PSDQuantum(count)+12));
+           }
   break;
        }
      p+=count;
  
