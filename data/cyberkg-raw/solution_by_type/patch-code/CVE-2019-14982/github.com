Original Source:
https://github.com/Exiv2/exiv2/pull/962/commits/e925bc5addd881543fa503470c8a859e112cca62

Commit history:

  @@ -827,8 +827,9 @@ namespace Exiv2 {
          }
      }
  
-  long WebPImage::getHeaderOffset(byte *data, long data_size,
-                                     byte *header, long header_size) {
+  long WebPImage::getHeaderOffset(byte* data, long data_size, byte* header, long header_size)
+     {
+  if (data_size < header_size) { return -1; }
   long pos = -1;
   for (long i=0; i < data_size - header_size; i++) {
   if (memcmp(header, &data[i], header_size) == 0) {
  
