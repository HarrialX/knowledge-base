Original Source:
https://github.com/libgit2/libgit2/commit/3db1af1f370295ad5355b8f64b865a2a357bcac0

Commit history:

  @@ -2379,6 +2379,10 @@ static int read_entry(
  
   GITERR_CHECK_ALLOC_ADD(&path_len, prefix_len, suffix_len);
   GITERR_CHECK_ALLOC_ADD(&path_len, path_len, 1);
+ 
+  if (path_len > GIT_PATH_MAX)
+  return index_error_invalid("unreasonable path length");
+ 
  		tmp_path = git__malloc(path_len);
   GITERR_CHECK_ALLOC(tmp_path);
  
  
