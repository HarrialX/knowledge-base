Original Source:
https://github.com/facebook/mcrouter/commit/98ce6624cd2563cfdb5da3b2949d5e1e03867034

Commit history:

  @@ -81,6 +81,9 @@ class McAsciiParserBase {
   const char* posStart,
   const char* posEnd);
  
+  // limit the value size.
+  static constexpr uint32_t maxValueBytes = 1 * 1024 * 1024 * 1024; // 1GB
+ 
    std::string currentErrorDescription_;
  
   uint64_t currentUInt_{0};
  
  @@ -137,6 +137,10 @@ exptime_req = negative? uint %{
  
  value_bytes = uint %{
    remainingIOBufLength_ = static_cast<size_t>(currentUInt_);
+   // Enforce maximum on value size obtained from parser                       
+   if (remainingIOBufLength_ > maxValueBytes) {
+     remainingIOBufLength_ = maxValueBytes;                                    
+   }
  };
  
  cas_id = uint %{
  
