Original Source:
https://github.com/ImageMagick/ImageMagick/commit/e14fd0a2801f73bdc123baf4fbab97dec55919eb

Commit history:

  @@ -835,7 +835,8 @@ static MagickBooleanType ReadPSDChannelPixels(Image *image,
   SetPixelIndex(image,(((unsigned char) pixel) &
                      (0x01 << (7-bit))) != 0 ? 0 : 255,q);
   SetPixelViaPixelInfo(image,image->colormap+(ssize_t)
-  GetPixelIndex(image,q),q);
+  ConstrainColormapIndex(image,GetPixelIndex(image,q),
+  exception),q);
                    q+=GetPixelChannels(image);
                    x++;
                  }
  
