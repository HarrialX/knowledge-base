Original Source:
https://github.com/Cacti/cacti/commit/69983495cd41bf0903fe02baeef84b1fa85f2846

Commit history:

  @@ -91,10 +91,10 @@
   /* Locate user in database */
   $user = db_fetch_row_prepared('SELECT * FROM user_auth WHERE username = ? AND realm = 2', array($username));
  
-  if (!$user && read_config_option('user_template') == '0') {
-  cacti_log("ERROR: User '" . $username . "' authenticated by Web Server, but a Template User is not defined in Cacti.  Exiting.", false, 'AUTH');
+  if (!$user && read_config_option('user_template') == '0' && read_config_option('guest_user') == '0') {
+  cacti_log("ERROR: User '" . $username . "' authenticated by Web Server, but both Template and Guest Users are not defined in Cacti.  Exiting.", false, 'AUTH');
   $username = htmlspecialchars($username);
-  auth_display_custom_error_message( __('%s authenticated by Web Server, but a Template User is not defined in Cacti.', $username) );
+  auth_display_custom_error_message( __('%s authenticated by Web Server, but both Template and Guest Users are not defined in Cacti.', $username) );
  			exit;			
  		}
  
  
