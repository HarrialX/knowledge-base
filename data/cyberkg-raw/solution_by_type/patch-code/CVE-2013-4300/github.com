Original Source:
https://github.com/torvalds/linux/commit/d661684cf6820331feae71146c35da83d794467e

Commit history:

  @@ -54,7 +54,7 @@ static __inline__ int scm_check_creds(struct ucred *creds)
   return -EINVAL;
  
   if ((creds->pid == task_tgid_vnr(current) ||
-  ns_capable(current->nsproxy->pid_ns->user_ns, CAP_SYS_ADMIN)) &&
+  ns_capable(task_active_pid_ns(current)->user_ns, CAP_SYS_ADMIN)) &&
  	    ((uid_eq(uid, cred->uid)   || uid_eq(uid, cred->euid) ||
   uid_eq(uid, cred->suid)) || nsown_capable(CAP_SETUID)) &&
  	    ((gid_eq(gid, cred->gid)   || gid_eq(gid, cred->egid) ||
  
