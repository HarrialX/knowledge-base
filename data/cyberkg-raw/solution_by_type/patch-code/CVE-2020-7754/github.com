Original Source:
https://github.com/npm/npm-user-validate/commit/c8a87dac1a4cc6988b5418f30411a8669bef204e

Commit history:

  @@ -11,6 +11,7 @@ var requirements = exports.requirements = {
   },
   password: {},
   email: {
                This comment has been minimized.

        

Sign in to view
















              Copy link
            

              Quote reply
            









510sss



Oct 23, 2020





{alpinestars36@yahoo.com}
+  length: 'Email length must be less then or equal to 254 characters long',
   valid: 'Email must be an email address'
   }
  }
  @@ -45,7 +46,10 @@ function username (un) {
  }
  
  function email (em) {
-  if (!em.match(/^.+@.+\..+$/)) {
+  if (em.length > 254) {
+  return new Error(requirements.email.length)
+  }
+  if (!em.match(/^[^@]+@.+\..+$/)) {
   return new Error(requirements.email.valid)
   }
  
  
  @@ -7,6 +7,13 @@ test('email misses an @', function (t) {
   t.end()
  })
  
+ test('email is longer then 254 characters', function (t) {
+  var str = '@'.repeat(255)
+  var err = v(str)
+  t.type(err, 'object')
+  t.end()
+ })
+ 
  test('email misses a dot', function (t) {
   var err = v('name@domain')
   t.type(err, 'object')
  
