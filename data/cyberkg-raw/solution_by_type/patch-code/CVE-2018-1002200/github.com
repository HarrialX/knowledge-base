Original Source:
https://github.com/codehaus-plexus/plexus-archiver/commit/f8f4233508193b70df33759ae9dc6154d69c2ea8

Commit history:

  @@ -308,6 +308,15 @@ protected void extractFile( final File srcF, final File dir, final InputStream c
   // Hmm. Symlinks re-evaluate back to the original file here. Unsure if this is a good thing...
   final File f = FileUtils.resolveFile( dir, entryName );
  
+  // Make sure that the resolved path of the extracted file doesn't escape the destination directory
+  String canonicalDirPath = dir.getCanonicalPath();
+  String canonicalDestPath = f.getCanonicalPath();
+ 
+  if ( !canonicalDestPath.startsWith( canonicalDirPath ) )
+         {
+  throw new ArchiverException( "Entry is outside of the target directory (" + entryName + ")" );
+         }
+ 
   try
          {
   if ( !isOverwrite() && f.exists() && ( f.lastModified() >= entryDate.getTime() ) )
  
  @@ -190,6 +190,30 @@ public void testSelectors()
                         } );
      }
  
+  public void testExtractingZipWithEntryOutsideDestDirThrowsException()
+  throws Exception
+     {
+  Exception ex = null;
+  String s = "target/zip-unarchiver-slip-tests";
+  File testZip = new File( getBasedir(), "src/test/zips/zip-slip.zip" );
+  File outputDirectory = new File( getBasedir(), s );
+ 
+  FileUtils.deleteDirectory( outputDirectory );
+ 
+  try
+         {
+  ZipUnArchiver zu = getZipUnArchiver( testZip );
+             zu.extract( "", outputDirectory );
+         }
+  catch ( Exception e )
+         {
+             ex = e;
+         }
+ 
+         assertNotNull( ex );
+         assertTrue( ex.getMessage().startsWith( "Entry is outside of the target directory" ) );
+     }
+ 
   private ZipArchiver getZipArchiver()
      {
   try
  
