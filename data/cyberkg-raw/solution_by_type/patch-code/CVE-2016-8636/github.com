Original Source:
https://github.com/torvalds/linux/commit/647bf3d8a8e5777319da92af672289b2a6c4dc66

Commit history:

  @@ -59,9 +59,11 @@ int mem_check_range(struct rxe_mem *mem, u64 iova, size_t length)
  
   case RXE_MEM_TYPE_MR:
   case RXE_MEM_TYPE_FMR:
-  return ((iova < mem->iova) ||
- 			((iova + length) > (mem->iova + mem->length))) ?
- 			-EFAULT : 0;
+  if (iova < mem->iova ||
+ 		    length > mem->length ||
+ 		    iova > mem->iova + mem->length - length)
+  return -EFAULT;
+  return 0;
  
   default:
   return -EFAULT;
  
