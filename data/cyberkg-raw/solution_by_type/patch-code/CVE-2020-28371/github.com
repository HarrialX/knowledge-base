Original Source:
https://github.com/ReadyTalk/avian/commit/0871979b298add320ca63f65060acb7532c8a0dd

Commit history:

  @@ -52,7 +52,7 @@ public void write(byte[] b, int offset, int length) throws IOException {
   throw new NullPointerException();
      }
  
-  if (offset < 0 || offset + length > b.length) {
+  if (offset < 0 || length < 0 || length > b.length || offset > b.length - length) {
   throw new ArrayIndexOutOfBoundsException();
      }
  
  
