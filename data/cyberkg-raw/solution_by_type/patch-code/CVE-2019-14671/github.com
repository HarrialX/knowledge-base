Original Source:
https://github.com/firefly-iii/firefly-iii/commit/e80d616ef4397e6e764f6b7b7a5b30121244933c

Commit history:

  @@ -60,6 +60,9 @@ public function configureJob(array $data): MessageBag
   $config['fints_password']  = (string)(Crypt::encrypt($data['fints_password']) ?? '');
   $config['apply-rules']     = 1 === (int)$data['apply_rules'];
  
+  // sanitize FinTS URL.
+  $config['fints_url'] = $this->validURI($config['fints_url']) ? $config['fints_url'] : '';
+ 
   $this->repository->setConfiguration($this->importJob, $config);
  
  
  @@ -108,4 +111,21 @@ public function setImportJob(ImportJob $importJob): void
   $this->repository->setUser($importJob->user);
      }
  
+  /**
+      * @param string $fints_url
+      *
+      * @return bool
+      */
+  private function validURI(string $fintsUri): bool
+     {
+  $res = filter_var($fintsUri, FILTER_VALIDATE_URL);
+  if (false === $res) {
+  return false;
+         }
+  $scheme = parse_url($fintsUri, PHP_URL_SCHEME);
+ 
+  return 'https' === $scheme;
+     }
+ 
+ 
  }
