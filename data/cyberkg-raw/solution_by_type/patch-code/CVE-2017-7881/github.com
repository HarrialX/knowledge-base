Original Source:
https://github.com/bigtreecms/BigTree-CMS/commit/7761481ac40d83ac29fef42bc6b3c07c86694b56

Commit history:

  @@ -8374,7 +8374,7 @@ function verifyCSRFToken() {
   $clean_domain = str_replace(array("http://","https://"),"//",DOMAIN);
   $token = isset($_POST[$this->CSRFTokenField]) ? $_POST[$this->CSRFTokenField] : $_GET[$this->CSRFTokenField];
  
-  if (strpos($clean_referer, $clean_domain) === false || $token != $this->CSRFToken) {
+  if (strpos($clean_referer, $clean_domain) !== 0 || $token != $this->CSRFToken) {
   $this->stop("Cross site request forgery detected.");
  			}
  		}
  
