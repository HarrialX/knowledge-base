Original Source:
https://github.com/ImageMagick/ImageMagick/commit/1e6a3ace073c9ec9c71e439c111d23c6e66cb6ae

Commit history:

  @@ -204,6 +204,8 @@ static MagickBooleanType DecodeImage(Image *image,unsigned char *luma,
   if (pcd_table[i] == (PCDTable *) NULL)
        {
          buffer=(unsigned char *) RelinquishMagickMemory(buffer);
+  for (j=0; j < i; j++)
+           pcd_table[j]=(PCDTable *) RelinquishMagickMemory(pcd_table[j]);
   ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
            image->filename);
        }
  @@ -215,6 +217,8 @@ static MagickBooleanType DecodeImage(Image *image,unsigned char *luma,
   if (r->length > 16)
          {
            buffer=(unsigned char *) RelinquishMagickMemory(buffer);
+  for (j=0; j <= i; j++)
+             pcd_table[j]=(PCDTable *) RelinquishMagickMemory(pcd_table[j]);
   return(MagickFalse);
          }
   PCDGetBits(16);
  
