Original Source:
https://github.com/openssl/openssl/commit/068b963bb7afc57f5bdd723de0dd15e7795d5822

Commit history:

  @@ -84,10 +84,12 @@ static int length_from_afi(const unsigned afi)
   */
  unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)
  {
-  return ((f != NULL &&
-              f->addressFamily != NULL && f->addressFamily->data != NULL)
-             ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))
-             : 0);
+  if (f == NULL
+             || f->addressFamily == NULL
+             || f->addressFamily->data == NULL
+             || f->addressFamily->length < 2)
+  return 0;
+  return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];
  }
  
  /*
  
