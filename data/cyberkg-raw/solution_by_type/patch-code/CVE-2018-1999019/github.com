Original Source:
https://github.com/chamilo/chamilo-lms/commit/0de84700648f098c1fbf6b807dee28ec640efe62

Commit history:

  @@ -823,16 +823,9 @@ public function getCourseLearnPaths()
       */
   public static function decodeParams($encoded)
      {
-  $decoded = str_replace(['-', '_', '.'], ['+', '/', '='], $encoded);
-  $mod4 = strlen($decoded) % 4;
+  $decoded = json_decode($encoded);
  
-  if ($mod4) {
-  $decoded .= substr('====', $mod4);
-         }
- 
-  $b64Decoded = base64_decode($decoded);
- 
-  return unserialize($b64Decoded);
+  return $decoded;
      }
  
   /**
  @@ -1319,10 +1312,8 @@ private function encodeParams(array $additionalParams = [])
   'api_key' => $this->apiKey,
   'username' => $this->user->getUsername(),
          ]);
+  $encoded = json_encode($params);
  
-  $strParams = serialize($params);
-  $b64Encoded = base64_encode($strParams);
- 
-  return str_replace(['+', '/', '='], ['-', '_', '.'], $b64Encoded);
+  return $encoded;
      }
  }
  @@ -6,9 +6,10 @@
  
  if ($hash) {
   $hashParams = Rest::decodeParams($hash);
- 
-  foreach ($hashParams as $key => $value) {
-  $_REQUEST[$key] = $value;
+  if (!empty($hashParams)) {
+  foreach ($hashParams as $key => $value) {
+  $_REQUEST[$key] = Security::remove_XSS($value);
+         }
      }
  }
  
  
