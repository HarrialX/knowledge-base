Original Source:
https://github.com/torvalds/linux/commit/b5b515445f4f5a905c5dd27e6e682868ccd6c09d

Commit history:

  @@ -3871,6 +3871,9 @@ static long pmcraid_ioctl_passthrough(
   pmcraid_err("couldn't build passthrough ioadls\n");
   goto out_free_buffer;
  		}
+ 	} else if (request_size < 0) {
+ 		rc = -EINVAL;
+  goto out_free_buffer;
  	}
  
   /* If data is being written into the device, copy the data from user
  
