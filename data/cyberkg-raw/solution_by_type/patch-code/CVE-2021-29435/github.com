Original Source:
https://github.com/TrestleAdmin/trestle-auth/commit/cb95b05cdb2609052207af07b4b8dfe3a23c11dc

Commit history:

  @@ -9,6 +9,9 @@ module Authentication
  
   prepend_before_action :require_authenticated_user
   prepend_before_action :authenticate_user
+ 
+  # Ensure that CSRF protection happens before authentication
+  protect_from_forgery prepend: true
   end
  
   protected
  
