Original Source:
https://github.com/miniupnp/miniupnp/commit/cd506a67e174a45c6a202eff182a712955ed6d6f

Commit history:

  @@ -318,6 +318,7 @@ updateDevice(const struct header * headers, time_t t)
   if(!tmp)	/* allocation error */
  				{
   syslog(LOG_ERR, "updateDevice() : memory allocation error");
+ 					*pp = p->next;	/* remove "p" from the list */
   free(p);
   return 0;
  				}
  
