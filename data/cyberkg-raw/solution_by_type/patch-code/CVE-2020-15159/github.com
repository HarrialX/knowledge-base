Original Source:
https://github.com/baserproject/basercms/commit/16a7b3cd09a0ca355474119c76897eac2034a66d

Commit history:

  @@ -25,7 +25,7 @@
  
  <!-- current -->
  <div class="em-box bca-current-box">
-  <?php echo __d('baser', '現在の位置')?>：<?php echo $currentPath ?>
+  <?php echo __d('baser', '現在の位置')?>：<?php echo h($currentPath) ?>
  </div>
  
  <?php if ($this->request->action == 'admin_add_folder'): ?>
  
  @@ -45,7 +45,7 @@
  <div id="MessageBox" style="display:none"><div id="flashMessage" class="notice-message"></div></div>
  
  <!-- current -->
- <div class="em-box bca-current-box"><?php echo __d('baser', '現在の位置') ?>：<?php echo $currentPath ?>
+ <div class="em-box bca-current-box"><?php echo __d('baser', '現在の位置') ?>：<?php echo h($currentPath) ?>
   <?php if (!$writable): ?>
  		　<span style="color:#FF3300">[<?php echo __d('baser', '書込不可') ?>]</span>
   <?php endif ?>
  
  @@ -46,6 +46,10 @@
  	]
  ];
  $config['Uploader'] = [
+  // システム管理者によるアップロードでいかなる拡張子も許可する
+  'allowedAdmin' => false,
   // システム管理者グループ以外のユーザーがアップロード可能なファイル（拡張子をカンマ区切りで指定する）
-  'allowedExt' => 'gif,jpg,png,pdf,zip,doc,docx,xls,xlsx,ppt,pptx'
+  'allowedExt' => 'gif,jpg,jpeg,png,ico,pdf,zip,doc,docx,xls,xlsx,ppt,pptx,txt',
+  // 'allowedExt' => 'mp4,mp3,mpg,mpeg,avi,wmv' // メディア例
+  // 'allowedExt' => 'fon,ttf,ttc' // フォント例
  ];
  @@ -73,7 +73,7 @@ public function __construct($id = false, $table = null, $ds = null) {
  				]
  			]
  		];
-  if(!BcUtil::isAdminUser()) {
+  if(!BcUtil::isAdminUser() || !Configure::read('Uploader.allowedAdmin')) {
   $this->validate['name'] = [
   'fileExt' => [
   'rule' => ['fileExt', Configure::read('Uploader.allowedExt')],
  
  @@ -24,7 +24,7 @@
  
  
  <div class="em-box align-left">
- <?php echo __d('baser', '現在の位置')?>：<?php echo $currentPath ?>
+ <?php echo __d('baser', '現在の位置')?>：<?php echo h($currentPath) ?>
  </div>
  
  <?php if ($this->request->action == 'admin_add_folder'): ?>
  
  @@ -44,7 +44,7 @@
  <div id="MessageBox" style="display:none"><div id="flashMessage" class="notice-message"></div></div>
  
  <!-- current -->
- <div class="em-box align-left"><?php echo __d('baser', '現在の位置')?>：<?php echo $currentPath ?>
+ <div class="em-box align-left"><?php echo __d('baser', '現在の位置')?>：<?php echo h($currentPath) ?>
   <?php if (!$writable): ?>
  		　<span style="color:#FF3300">[<?php echo __d('baser', '書込不可')?>]</span>
   <?php endif ?>
  
