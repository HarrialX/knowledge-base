Original Source:
https://github.com/mjg59/linux/commit/a4a5ed2835e8ea042868b7401dced3f517cafa76

Commit history:

  @@ -1137,6 +1137,12 @@ void __init setup_arch(char **cmdline_p)
   /* Allocate bigger log buffer */
   setup_log_buf(1);
  
+ #ifdef CONFIG_EFI_SECURE_BOOT_SECURELEVEL
+  if (boot_params.secure_boot) {
+  set_securelevel(1);
+ 	}
+ #endif
+ 
   reserve_initrd();
  
  #if defined(CONFIG_ACPI) && defined(CONFIG_BLK_DEV_INITRD)
  @@ -1147,12 +1153,6 @@ void __init setup_arch(char **cmdline_p)
  
   io_delay_init();
  
- #ifdef CONFIG_EFI_SECURE_BOOT_SECURELEVEL
-  if (boot_params.secure_boot) {
-  set_securelevel(1);
- 	}
- #endif
- 
   /*
  	 * Parse the ACPI tables for possible boot-time SMP configuration.
   */
  
  @@ -707,6 +707,12 @@ void __init acpi_initrd_override(void *data, size_t size)
   if (table_nr == 0)
   return;
  
+  if (get_securelevel() > 0) {
+  pr_notice(PREFIX
+  "securelevel enabled, ignoring table override\n");
+  return;
+ 	}
+ 
  	acpi_tables_addr =
   memblock_find_in_range(0, max_low_pfn_mapped << PAGE_SHIFT,
  				       all_tables_size, PAGE_SIZE);
  
