Original Source:
https://github.com/chamilo/chamilo-lms/commit/d939402d83bf68af5377b629883d8e5437d843ec

Commit history:

  @@ -12,7 +12,8 @@
  ];
  Event::registerLog($logInfo);
  
- $type = isset($_REQUEST['type']) ? $_REQUEST['type'] : null;
+ $typeList = ['personal', 'course', 'admin', 'platform'];
+ $type = isset($_REQUEST['type']) && in_array($_REQUEST['type'], $typeList, true) ? $_REQUEST['type'] : null;
  
  $interbreadcrumb[] = [
   'url' => api_get_path(WEB_CODE_PATH).'calendar/agenda_js.php?type='.Security::remove_XSS($type),
  
