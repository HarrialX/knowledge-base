Original Source:
https://github.com/znc/znc/commit/d22fef8620cdd87490754f607e7153979731c69d

Commit history:

  @@ -103,7 +103,8 @@ void CClient::ReadLine(const CString& sData) {
      CLanguageScope user_lang(GetUser() ? GetUser()->GetLanguage() : "");
      CString sLine = sData;
  
-  sLine.TrimRight("\n\r");
+  sLine.Replace("\n", "");
+  sLine.Replace("\r", "");
  
   DEBUG("(" << GetFullName() << ") CLI -> ZNC ["
          << CDebug::Filter(sLine) << "]");
  
  @@ -156,7 +156,8 @@ void CIRCSock::Quit(const CString& sQuitMsg) {
  void CIRCSock::ReadLine(const CString& sData) {
      CString sLine = sData;
  
-  sLine.TrimRight("\n\r");
+  sLine.Replace("\n", "");
+  sLine.Replace("\r", "");
  
   DEBUG("(" << m_pNetwork->GetUser()->GetUserName() << "/"
                << m_pNetwork->GetName() << ") IRC -> ZNC [" << sLine << "]");
  
