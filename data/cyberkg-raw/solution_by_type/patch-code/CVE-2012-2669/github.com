Original Source:
https://github.com/torvalds/linux/commit/bcc2c9c3fff859e0eb019fe6fec26f9b8eba795c

Commit history:

  @@ -701,14 +701,18 @@ int main(void)
  	pfd.fd = fd;
  
   while (1) {
+  struct sockaddr *addr_p = (struct sockaddr *) &addr;
+  socklen_t addr_l = sizeof(addr);
  		pfd.events = POLLIN;
  		pfd.revents = 0;
   poll(&pfd, 1, -1);
  
- 		len = recv(fd, kvp_recv_buffer, sizeof(kvp_recv_buffer), 0);
+ 		len = recvfrom(fd, kvp_recv_buffer, sizeof(kvp_recv_buffer), 0,
+ 				addr_p, &addr_l);
  
-  if (len < 0) {
-  syslog(LOG_ERR, "recv failed; error:%d", len);
+  if (len < 0 || addr.nl_pid) {
+  syslog(LOG_ERR, "recvfrom failed; pid:%u error:%d %s",
+ 					addr.nl_pid, errno, strerror(errno));
   close(fd);
   return -1;
  		}
  
