Original Source:
https://github.com/mz-automation/libiec61850/commit/033ab5b6488250c8c3b838f25a7cbc3e099230bb

Commit history:

  @@ -720,6 +720,9 @@ CotpConnection_readToTpktBuffer(CotpConnection* self)
   goto exit_waiting;
      }
  
+  if (self->packetSize <= bufPos)
+  goto exit_error;
+ 
      readBytes = readFromSocket(self, buffer + bufPos, self->packetSize - bufPos);
  
   if (readBytes < 0)
  
