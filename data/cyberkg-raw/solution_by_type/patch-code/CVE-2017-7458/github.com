Original Source:
https://github.com/ntop/ntopng/commit/01f47e04fd7c8d54399c9e465f823f0017069f8f

Commit history:

  @@ -6018,7 +6018,8 @@ void Lua::setParamsTable(lua_State* vm, const char* table_name,
   char *_equal;
  
   if(strncmp(tok, "csrf", strlen("csrf")) /* Do not put csrf into the params table */
- 	 && (_equal = strchr(tok, '='))) {
+ 	 && (_equal = strchr(tok, '='))
+ 	 && (strlen(_equal) > 1)) {
                This comment has been minimized.

        

Sign in to view
















              Copy link
            

              Quote reply
            









emanuele-f



Feb 14, 2017




      Contributor
    


@simonemainardi this cuts off some valid empty parameters, like "custom_name"














              This comment has been minimized.

        

Sign in to view
















              Copy link
            

              Quote reply
            









simonemainardi



Feb 14, 2017




  Author


      Member
    


with this I am no longer allowing empty-string parameters. If you want to release this extra check, please double check for other possible NULL pointer dereferencing as in line 2203 below
   char *decoded_buf;
   int len;
  
  
  @@ -2200,6 +2200,8 @@ Host* NetworkInterface::getHost(char *host_ip, u_int16_t vlan_id) {
   struct in6_addr a6;
    Host *h = NULL;
  
+  if(!host_ip) return(NULL);
+ 
   /* Check if address is invalid */
   if((inet_pton(AF_INET, (const char*)host_ip, &a4) == 0)
       && (inet_pton(AF_INET6, (const char*)host_ip, &a6) == 0)) {
  
