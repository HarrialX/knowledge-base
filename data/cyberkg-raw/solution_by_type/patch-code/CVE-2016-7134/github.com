Original Source:
https://github.com/php/php-src/commit/72dbb7f416160f490c4e9987040989a10ad431c7?w=1

Commit history:

  @@ -3529,6 +3529,10 @@ PHP_FUNCTION(curl_escape)
  		RETURN_FALSE;
  	}
  
+  if (ZEND_SIZE_T_INT_OVFL(str_len)) {
+ 		RETURN_FALSE;
+ 	}
+ 
   if ((res = curl_easy_escape(ch->cp, str, str_len))) {
   RETVAL_STRING(res);
   curl_free(res);
  @@ -3556,7 +3560,7 @@ PHP_FUNCTION(curl_unescape)
  		RETURN_FALSE;
  	}
  
-  if (str_len > INT_MAX) {
+  if (ZEND_SIZE_T_INT_OVFL(str_len)) {
  		RETURN_FALSE;
  	}
  
  
