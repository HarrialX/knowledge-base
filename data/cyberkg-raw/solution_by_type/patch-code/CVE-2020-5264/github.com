Original Source:
https://github.com/PrestaShop/PrestaShop/commit/06b7765c91c58e09ab4f8ddafbde02070fcb6f3a

Commit history:

  @@ -28,6 +28,7 @@
  
  use PrestaShopBundle\Service\Routing\Router as PrestaShopRouter;
  use Symfony\Component\HttpFoundation\Request;
+ use Symfony\Component\Validator\Constraints as Assert;
  
  /**
   * Admin controller to manage security pages.
  @@ -37,6 +38,11 @@ class SecurityController extends FrameworkBundleAdminController
   public function compromisedAccessAction(Request $request)
      {
   $requestUri = urldecode($request->query->get('uri'));
+  $url = new Assert\Url();
+  $violations = $this->get('validator')->validate($requestUri, [$url]);
+  if ($violations->count()) {
+  return $this->redirect('dashboard');
+         }
  
   // getToken() actually generate a new token
   $username = $this->get('prestashop.user_provider')->getUsername();
  @@ -47,8 +53,11 @@ public function compromisedAccessAction(Request $request)
  
   $newUri = PrestaShopRouter::generateTokenizedUrl($requestUri, $newToken);
  
-  return $this->render('@PrestaShop/Admin/Security/compromised.html.twig', array(
-  'requestUri' => $newUri,
-         ));
+  return $this->render(
+  '@PrestaShop/Admin/Security/compromised.html.twig',
+  array(
+  'requestUri' => $newUri,
+             )
+         );
      }
  }
