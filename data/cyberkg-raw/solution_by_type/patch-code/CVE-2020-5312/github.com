Original Source:
https://github.com/python-pillow/Pillow/commit/93b22b846e0269ee9594ff71a72bec02d2bea8fd

Commit history:

  @@ -590,7 +590,12 @@ def act(fp):
   self.assertFalse(fp.closed)
  
   def test_overrun(self):
-  for file in ["fli_overrun.bin", "sgi_overrun.bin", "pcx_overrun.bin"]:
+  for file in [
+  "fli_overrun.bin",
+  "sgi_overrun.bin",
+  "pcx_overrun.bin",
+  "pcx_overrun2.bin",
+         ]:
   im = Image.open(os.path.join("Tests/images", file))
   try:
   im.load()
  
  @@ -25,6 +25,9 @@ ImagingPcxDecode(Imaging im, ImagingCodecState state, UINT8* buf, Py_ssize_t byt
   if (strcmp(im->mode, "1") == 0 && state->xsize > state->bytes * 8) {
          state->errcode = IMAGING_CODEC_OVERRUN;
   return -1;
+     } else if (strcmp(im->mode, "P") == 0 && state->xsize > state->bytes) {
+         state->errcode = IMAGING_CODEC_OVERRUN;
+  return -1;
      }
  
      ptr = buf;
  
