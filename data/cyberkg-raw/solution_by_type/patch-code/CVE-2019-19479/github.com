Original Source:
https://github.com/OpenSC/OpenSC/commit/c3f23b836e5a1766c36617fe1da30d22f7b63de2

Commit history:

  @@ -868,7 +868,7 @@ static void parse_sec_attr_44(sc_file_t *file, const u8 *buf, size_t len)
  			}
  
   /* Encryption key present ? */
- 			iPinCount = iACLen - 1;		
+ 			iPinCount = iACLen > 0 ? iACLen - 1 : 0;
  
   if (buf[iOffset] & 0x20) {
   int iSC;
  
