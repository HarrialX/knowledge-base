Original Source:
https://github.com/torvalds/linux/commit/338c7dbadd2671189cec7faf64c84d01071b3f96

Commit history:

  @@ -1898,6 +1898,9 @@ static int kvm_vm_ioctl_create_vcpu(struct kvm *kvm, u32 id)
   int r;
   struct kvm_vcpu *vcpu, *v;
  
+  if (id >= KVM_MAX_VCPUS)
+  return -EINVAL;
+ 
  	vcpu = kvm_arch_vcpu_create(kvm, id);
   if (IS_ERR(vcpu))
   return PTR_ERR(vcpu);
  
