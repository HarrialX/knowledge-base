Original Source:
https://github.com/e107inc/e107/commit/f80e417bb3e7ab5c1a89ea9ddd2cd060f54464e1

Commit history:

  @@ -35,6 +35,16 @@
  $frm = e107::getForm();
  $mes = e107::getMessage();
  
+ if(isset($_GET['mode']))
+ {
+  $_GET['mode'] = preg_match('/[^\w-]/', '', $_GET['mode']);
+ }
+ 
+ if(isset($_GET['type']))
+ {
+  $_GET['type'] = preg_replace('/[^\w-]/', '', $_GET['type']);
+ }
+ 
  /*
   * Execute trigger
   */
  
