Original Source:
https://github.com/spip/SPIP/commit/824d17f424bf77d17af89c18c3dc807a3199567e

Commit history:

  @@ -547,7 +547,10 @@
   if (!function_exists('session_set')) {
   include_spip('inc/session');
  	}
-  session_set($t, _request($t));
+  $t = preg_replace(",\W,","_", $t);
+  if ($v = _request($t)) {
+  session_set($t, $v);
+ 	}
  }
  
  /**
  
