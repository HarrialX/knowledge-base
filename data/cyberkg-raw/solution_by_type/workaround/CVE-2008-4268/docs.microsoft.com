Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-075

#### Workarounds for Windows Saved Search Vulnerability - CVE-2008-4268
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   Temporarily change the file type associated with the “.search-ms” file extension. Enter the following command at an elevated command prompt:
  
    assoc .search-ms=xmlfile
  
    **Impact of workaround.** Saved-search files will open as XML files in Internet Explorer.
  
    **How to undo the workaround.** Enter the following command at an elevated command prompt:
  
    assoc .search-ms=SearchFolder
  
-   Modify the registry to deny users the ability to open saved-search files or to access the saved search folder.
  
    To modify the registry key, follow these steps:
  
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then expand the following registry subkey:  
        HKEY\_CLASSES\_ROOT\\SearchFolder  
        Click **Edit**, and then click **Permissions**  
        **Note** Make a note of the permissions that are listed in this dialog box so that you can restore them to their original values at a later time.  
    3.  Click **Advanced.**  
    4.  Click to clear the **Include inheritable permissions from this object's parent** check box. You are prompted to click **Copy**, **Remove**, or **Cancel**. Click **Remove**, and then click **OK.**  
    5.  You receive a message that states that no one will be able to access this registry key. Click **Yes**, and then click **OK** to close the **Permissions for SearchFolder** dialog box.
  
    **Impact of workaround.** Users will be unable to open saved search files or access the saved search folder.
  
    **How to undo the workaround.** Restore the previously configured permissions on the registry key by clicking to check **Include inheritable permissions from this object's parent** and then clicking **OK** two times.
  
-   Unregister the SearchFolder file type.
  
    To modify the registry key, follow these steps:
  
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    **Using the Interactive Method**
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_CLASSES\_ROOT\\SearchFolder  
    3.  Click the **File** menu and select **Export**.  
    4.  In the **Export Registry File** dialog box, enter **SearchFolder\_file\_association\_registry\_backup.reg** and click **Save**.  
        **Note** This will create a backup of this registry key in the **My Documents**folder by default.  
    5.  Press the **Delete** key on the keyboard to delete the registry key. When prompted to delete the registry key via the **Confirm Key Delete** dialog box, click **Yes**.
  
    **Using a Managed Deployment Script**
  
    1.  Create a backup copy of the registry keys by using a managed deployment script that contains the following commands:  
        Regedit.exe /e SearchFolder\_registry\_backup.reg  
        HKEY\_CLASSES\_ROOT\\SearchFolder  
    2.  Next, save the following to a file with a .REG extension, such as Delete\_SearchFolder\_file\_association.reg:  
        Windows Registry Editor Version 5.00  
        \[-HKEY\_CLASSES\_ROOT\\SearchFolder\]  
    3.  Run the above registry script on the target machine with the following command from an elevated command prompt:  
        Regedit.exe /s Delete\_SearchFolder\_file\_association.reg
  
    **Impact of workaround.** Double-clicking on a saved search folder will no longer open a window displaying the search results.
  
    **How to undo the workaround:**
  
    **Using the Interactive Method**
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Click the **File** menu and select **Import**.  
    3.  In the Import Registry File dialog box, select **SearchFolder\_file\_association\_registry\_backup.reg** and click **Open**.
  
    **Using a Managed Deployment Script**
  
    Restore the original state by running the following command:  
    Regedit.exe /s SearchFolder\_registry\_backup.reg
  
#### Workarounds for Windows Search Parsing Vulnerability - CVE-2008-4269
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Disable search-ms protocol handler within Windows Explorer**
  
    **Note** Repairing Office or installing an Office security update may undo this workaround.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    **Note** We recommend backing up the registry before you edit it.
  
    To modify the registry key, follow these steps:
  
    **Using the Interactive Method**
  
    1.  Click **Start**, click **Run**, type "regedit" (without the quotation marks) in the Open box, and then click **OK**.  
    2.  Locate and then expand the following registry subkey:  
    3.  **HKEY\_CLASSES\_ROOT\\search-ms\\shell\\open**.  
    4.  Click on **Command**.  
    5.  Click the **File** menu and select **Export**.  
    6.  In the Export Registry File dialog box, enter "Search-ms\_pluggable\_protocol\_registry\_backup.reg" and click **Save**.  
    7.  Edit the (Default) registry value by double-clicking it. Clear all data from the Value data: field.  
    8.  Click **OK**.
  
    **Using a Managed Deployment Script**
  
    1.  Create a backup copy of the registry keys by using a managed deployment script that contains the following command:  
        regedit /e Search-ms\_pluggable\_protocol\_registry\_backup.reg HKEY\_CLASSES\_ROOT\\search-ms\\shell\\open\\command.  
    2.  Next, save the following to a file with a .REG extension, such as  
        "Disable\_search-ms\_pluggable\_protocol.reg":  
        Windows Registry Editor Version 5.00  
        \[HKEY\_CLASSES\_ROOT\\search-ms\\shell\\open\\command\]  
        @=""  
    3.  Run the above registry script on the target machine with the following command from an elevated command prompt:  
        Regedit.exe /s Disable\_ search-ms\_pluggable\_protocol.reg
  
    **Impact of workaround.**
  
    Web pages will not be able to launch Windows searches.
  
    **How to undo the workaround.**
  
    Using the Interactive Method
  
    1.  Click **Start**, click **Run**, type **Regedit** in the Open box, and then click **OK**.  
    2.  Click the File menu and select Import.  
    3.  In the Import Registry File dialog box, select "Search-ms\_pluggable\_protocol\_registry\_backup.reg" and click **Open**.
  
    Using a Managed Deployment Script
  
-   Restore the original state by running the following command:  
    Regedit.exe /s Search-ms\_pluggable\_protocol\_registry\_backup.reg
  
-   V1.1 (December 10, 2008): Corrected registry key in **Workarounds for Windows Search Parsing Vulnerability - CVE-2008-4269** section.
  
*Built at 2014-04-18T13:49:36Z-07:00*

							






Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 


















Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021









Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 
In this article
























Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021
