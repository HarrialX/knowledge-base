Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-037

Workarounds for JView Profiler Vulnerability - CAN-2005-2087:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. The workarounds are mutually exclusive so users need only apply one to be secure. When a workaround reduces functionality, it is identified in the following section.

Set Internet and Local intranet security zone settings to “High” to prompt before running ActiveX controls in these zones
You can help protect against this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls. You can do this by setting your browser security to High.
To raise the browsing security level in Microsoft Internet Explorer, follow these steps:

On the Internet Explorer Tools menu, click Internet Options.
In the Internet Options dialog box, click the Security tab, and then click the Internet icon.
Under Security level for this zone, move the slider to High. This sets the security level for all Web sites you visit to High.

Note If no slider is visible, click Default Level, and then move the slider to High.
Repeat steps 1 through 3 for the Local intranet security zone by clicking on the Local intranet icon.
Note Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.
Impact of Workaround: User will be prompted prior to running ActiveX controls unless the Web site is in the user’s list of trusted sites.

Configure Internet Explorer to prompt before running ActiveX controls or disable ActiveX controls in the Internet and Local intranet security zone
You can help protect against this vulnerability by changing your settings to prompt before running ActiveX controls or disable ActiveX controls in the Internet and Local intranet security zone. To do this, follow these steps:

On the Internet Explorer Tools menu, click Internet Options.
In the Internet Options dialog box, click the Security tab, and then click the Internet icon.
Click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Run ActiveX controls and plug-ins, click Prompt or Disable, and then click OK.
Click Local intranet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Run ActiveX controls and plug-ins, click Prompt or Disable, and then click OK.
Click OK two times to return to Internet Explorer.

Impact of Workaround: There are side effects to prompting before running ActiveX controls. Many Web sites that are on the Internet or on an intranet use ActiveX to provide additional functionality. For example, an online e-commerce site or banking site may use ActiveX controls to provide menus, ordering forms, or even account statements. Prompting before running ActiveX controls is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click Yes to run ActiveX controls.

Un-register the Javaprxy.dll COM Object
To un-register Javaprxy.dll, follow these steps:

Click Start, click Run, type "regsvr32 /u javaprxy.dll" (without the quotation marks), and then click OK.
A dialog box appears to confirm that the un-registration process has succeeded. Click OK to close the dialog box.
Close Internet Explorer, and reopen it for the changes to take effect.

Impact of Workaround: Applications that require the Microsoft Java Virtual Machine may no longer function correctly.
To undo this change, re-register Javaprxy.dll by following the above steps. Replace the text in Step 1 with “regsvr32 %windir%\system32\javaprxy.dll” (without the quotation marks).

Modify the Access Control List on Javaprxy.dll to be more restrictive
To modify the Access Control List (ACL) on Javaprxy.dll to be more restrictive, follow these steps:

Click Start, click Run, type "cmd" (without the quotation marks), and then click OK.

Type the following command at a command prompt. Make a note of the current ACLs that are on the file (including inheritance settings) for future reference in case you have to undo this modification:
cacls %windir%\system32\javaprxy.dll

Type the following command at a command prompt to deny the ‘everyone’ group access to this file:
cacls %windir%\system32\javaprxy.dll /d everyone

Close Internet Explorer, and reopen it for the changes to take effect.


Impact of Workaround: Applications that require the Microsoft Java Virtual Machine may no longer function correctly.

Restrict access to Javaprxy.dll in Internet Explorer by using a Software Restriction Policy
To restrict access to Javaprxy.dll in Internet Explorer on Windows XP and later versions you can create a Software Restriction Policy. To create this policy, use a registry script or create a Group Policy setting to block the loading of the Javaprxy.dll.
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
We recommend that you back up the registry before you edit it.
Use the following text to create a .reg file to un-register Javaprxy.dll in Internet Explorer. You can copy the following text, paste it into a text editor such as Notepad, and then save the file with the .reg file name extension. Run the .reg file on the vulnerable client.
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Safer\CodeIdentifiers]
"TransparentEnabled"=dword:00000002
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Safer\CodeIdentifiers\0\Paths\{09687f8a-0ca9-4639-b295-a3f5b5be8fc5}]
"LastModified"=hex(b):50,09,1f,b1,04,4a,c5,01
"Description"="Block javaprxy.dll"
"SaferFlags"=dword:00000000
"ItemData"=hex(2):25,00,77,00,69,00,6e,00,64,00,69,00,72,00,25,00,5c,00,73,00,\
79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,6a,00,61,00,76,00,61,00,70,\
00,72,00,78,00,79,00,2e,00,64,00,6c,00,6c,00,00,00
Impact of Workaround: Applications that require the Microsoft Java Virtual Machine may no longer function correctly.

Remove the Microsoft Java Virtual Machine from your system using the Java Removal Tool
Customers can use the MSJVM Diagnostic Tool, available from the Microsoft Java Virtual Machine Support page, to perform remote and local scans to detect for the presence of MSJVM and MSJVM-related software.
Customers can then use the Java Removal Tool to permanently remove the Microsoft Java Virtual Machine from their system. For more information about how to qualify for access to the Java Removal Tool from Microsoft Product Support Services, see Microsoft Knowledge Base Article 826878.
Warning: Removing the Microsoft Java Virtual Machine from your system is permanent. Microsoft cannot provide Windows operating system recovery media to you that includes the MSJVM for reinstallation. Microsoft no longer includes the MSJVM in Windows operating system products.
Impact of Workaround: Applications that require the Microsoft Java Virtual Machine will no longer function correctly.


