Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-071

Workarounds for Microsoft XML Core Services Vulnerability - CVE-2006-5745:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Prevent the XMLHTTP 4.0 and XMLHTTP 6.0 ActiveX Controls from running in Internet Explorer.
You can disable attempts to instantiate these ActiveX controls in Internet Explorer by setting the kill bit for the controls in the registry.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.
For detailed steps that you can use to prevent a control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797. Follow these steps in this article to create a Compatibility Flags value in the registry to prevent a COM object from being instantiated in Internet Explorer:

To set the kill bit for a CLSID with a value of {88d969c5-f192-11d4-a65f-0040963251e5} (XMLHTTP 4.0 contained within Microsoft XML Core Services 4.0) and {88d96a0a-f192-11d4-a65f-0040963251e5} (XMLHTTP 6.0 contained within Microsoft XML Core Services 6.0) paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension:
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{88d969c5-f192-11d4-a65f-0040963251e5}] "Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{88d96a0a-f192-11d4-a65f-0040963251e5}] "Compatibility Flags"=dword:00000400

You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:
Group Policy collection
What is Group Policy Object Editor?
Core Group Policy tools and settings


Note You must restart Internet Explorer for your changes to take effect.
Impact of Workaround: Web sites that use the XMLHTTP 4.0 or XMLHTTP 6.0 ActiveX controls may no longer display or function correctly.
This security update does not automatically rollback the kill bit for these ActiveX controls. To rollback the kill bit follow these steps:

To rollback the kill bit paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension:
Windows Registry Editor Version 5.00
[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{88d969c5-f192-11d4-a65f-0040963251e5}]
[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{88d96a0a-f192-11d4-a65f-0040963251e5}]

You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:
Group Policy collection
What is Group Policy Object Editor?
Core Group Policy tools and settings


Note You must restart Internet Explorer for your changes to take effect.

Deny Access to the affected CLSID's for Microsoft XML Core Services 4.0 ({88D969C5-F192-11D4-A65F-0040963251E5}) and Microsoft XML Core Services 6.0 ({88D96A0A-F192-11D4-A65F-0040963251E5}) in the registry
To modify access to the affected CLSIDs for Windows 2000, follow these steps:

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.

Expand HKEY_CLASSES_ROOT, and expand CLSID.

For Microsoft XML Core Services 4.0 click: {88D969C5-F192-11D4-A65F-0040963251E5}
For Microsoft XML Core Services 6.0 click: {88D96A0A-F192-11D4-A65F-0040963251E5}

Click Security, and then click Permissions.
Note Make a note of the permissions that are listed in this dialog box so that you can restore them to their original values at a later time.

Click to clear the Allow Inheritable Permissions form the parent to propagate to this object check box. You are prompted to click Copy, Remove, or Cancel. Click Remove, and then click OK.

A message will display stating that no one will be able to access this registry key. Click Yes when prompted to do so.


To modify access to the affected CLSIDs for Windows XP Service Pack 2 and later operating systems, follow these steps:

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.

Expand HKEY_CLASSES_ROOT, and expand CLSID.

For Microsoft XML Core Services 4.0 click: {88D969C5-F192-11D4-A65F-0040963251E5}
For Microsoft XML Core Services 6.0 click: {88D96A0A-F192-11D4-A65F-0040963251E5}

Click Edit, and then click Permissions.
Note Make a note of the permissions that are listed in this dialog box so that you can restore them to their original values at a later time.

Click Advanced.

Click to clear the Inherit from parent the permission entries that apply to child objects. Include these with entries explicitly defined here check box. You are prompted to click Copy, Remove, or Cancel. Click Remove, and then check OK.

A message will display stating that no one will be able to access this registry key. Click Yes when prompted to do so and then click OK to close the Permissions for {88D969C5-F192-11D4-A65F-0040963251E5} or Permissions for {88D96A0A-F192-11D4-A65F-0040963251E5} (depending on which CLSID was chosen) dialog box.


Impact of Workaround: Web sites that use the XMLHTTP 4.0 or XMLHTTP 6.0 ActiveX controls may no longer display or function correctly.

Configure Internet Explorer to prompt before running Active Scripting or disable Active Scripting in the Internet and Local intranet security zone.
You can help protect against this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

In Internet Explorer, click Internet Options on the Tools menu.
Click the Security tab.
Click Internet, and then click Custom Level.
Under Settings, in the Scripting section, under Active Scripting, click Prompt or Disable, and then click OK.
Click Local intranet, and then click Custom Level.
Under Settings, in the Scripting section, under Active Scripting, click Prompt or Disable, and then click OK.
Click OK two times to return to Internet Explorer.

Note Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.
Note After you set Internet Explorer to require a prompt before it runs ActiveX controls and/or Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.
To do this, follow these steps:

In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.
In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.
If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.
In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.
Repeat these steps for each site that you want to add to the zone.
Click OK two times to accept the changes and return to Internet Explorer.

Note Add any sites that you trust not to take malicious action on your computer. Two in particular that you may want to add are "*.windowsupdate.microsoft.com" and “*.update.microsoft.com” (without the quotation marks). These are the sites that will host the update, and it requires an ActiveX control to install the update.
Impact of Workaround: There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click Yes to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone”.

Configure Internet Explorer to prompt before running ActiveX Controls or disable ActiveX Controls in the Internet and Local intranet security zone.
You can help protect against this vulnerability by changing your Internet Explorer settings to prompt before running ActiveX controls. To do this, follow these steps:

In Internet Explorer, click Internet Options on the Tools menu.
Click the Security tab.
Click Internet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Run ActiveX controls and plug-ins, click Prompt or Disable, and then click OK.
Click Local intranet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Run ActiveX controls and plug-ins, click Prompt or Disable, and then click OK.
Click OK two times to return to Internet Explorer.

Note After you set Internet Explorer to require a prompt before it runs ActiveX controls and/or Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.
To do this, follow these steps:

In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.
In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.
If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.
In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.
Repeat these steps for each site that you want to add to the zone.
Click OK two times to accept the changes and return to Internet Explorer.

Note Add any sites that you trust not to take malicious action on your computer. Two in particular that you may want to add are "*.windowsupdate.microsoft.com" and “*.update.microsoft.com” (without the quotation marks). These are the sites that will host the update, and it requires an ActiveX control to install the update.
Impact of Workaround: There are side effects to prompting before running ActiveX controls. Many Web sites that are on the Internet or on an intranet use ActiveX to provide additional functionality. For example, an online e-commerce site or banking site may use ActiveX controls to provide menus, ordering forms, or even account statements. Prompting before running ActiveX controls is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click Yes to run ActiveX controls. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone”.

Set Internet and Local intranet security zone settings to “High” to prompt before running ActiveX controls and active scripting in the Internet zone and in the Local intranet zone.
You can help protect against this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and active scripting. You can do this by setting your browser security to High.
To raise the browsing security level in Microsoft Internet Explorer:

On the Internet Explorer Tools menu, click Internet Options.
In the Internet Options dialog box, click the Security tab, and then click the Internet icon.
Under Security level for this zone, move the slider to High. This sets the security level for all Web sites you visit to High.

Note If no slider is visible, click Default Level, and then move the slider to High.
Note Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the high security setting.
Alternatively, you can change you settings to prompt before running ActiveX controls only by following these steps:

In Internet Explorer, click Internet Options on the Tools menu.
Click the Security tab.
Click Internet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Run ActiveX controls and plug-ins, click Prompt.
In the Scripting section, under Active Scripting, click Prompt, and then click OK.
Click Local intranet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Run ActiveX controls and plug-ins, click Prompt.
In the Scripting section, under Active Scripting, click Prompt.
Click OK two times to return to Internet Explorer.

Impact of Workaround: There are side effects to prompting before running ActiveX controls. Many Web sites that are on the Internet or on an intranet use ActiveX to provide additional functionality. For example, an online e-commerce site or banking site may use ActiveX controls to provide menus, ordering forms, or even account statements. Prompting before running ActiveX controls is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click Yes to run ActiveX controls. If you do not want to be prompted for all these sites, use the "Restrict Web sites to only your trusted Web sites" workaround.


