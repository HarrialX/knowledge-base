Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-031

Workarounds for VBE6.dll Stack Memory Corruption Vulnerability - CVE-2010-0815
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable ActiveX controls in the 2007 Microsoft Office System
You can disable ActiveX controls in the 2007 Microsoft Office System using the TrustCenter. Refer to the instructions for how to "Disable all controls without notification" in the Microsoft Office Online article, Enable or disable ActiveX controls in Office documents.
Impact of workaround. Embedded ActiveX controls (such as macros) will not run in Office documents.

Restrict access to VBE6.dll
For Microsoft Windows 2000, Windows XP, and Windows Server 2003, enter the following at a command prompt:
cacls "C:\Program Files\Common Files\Microsoft Shared\VBA\VBA6\vbe6.dll" /E /P everyone:N
For Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, enter the following at an elevated command prompt:
takeown /f "C:\Program Files\Common Files\Microsoft Shared\VBA\VBA6\vbe6.dll"
icacls "C:\Program Files\Common Files\Microsoft Shared\VBA\VBA6\vbe6.dll" /save %TEMP%\VBE6_ACL.TXT
icacls "C:\Program Files\Common Files\Microsoft Shared\VBA\VBA6\vbe6.dll" /deny everyone:(F)

Impact of workaround. Embedded ActiveX controls (such as macros) will not run in Office documents. For instance, users will be unable to insert objects into Office documents.
How to undo the workaround.
For Microsoft Windows 2000, Windows XP, and Windows Server 2003, enter the following at a command prompt:
cacls "C:\Program Files\Common Files\Microsoft Shared\VBA\VBA6\vbe6.dll" /E /R everyone
For Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, enter the following at a command prompt:
icacls "C:\Program Files\Common Files\Microsoft Shared\VBA\VBA6\" /restore %TEMP%\VBE6_ACL.TXT

Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or 2007 Office system installed.
To install MOICE, you must have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center:
Download the FileFormatConverters.exe package now
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates:
http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=en-us
To enable MOICE, change the registered handler for the office file formats. The following table describes the command to enable or to disable MOICE for the Office file formats:





Command to enable MOICE to be the registered handler
Command to disable MOICE as the registered handler




ASSOC .XLS=oice.excel.sheet
ASSOC .xls=Excel.Sheet.8


ASSOC .XLT=oice.excel.template
ASSOC .xlt=Excel.Template


ASSOC .XLA=oice.excel.addin
ASSOC .xla=Excel.Addin


ASSOC .doc=oice.word.document
ASSOC .doc=Word.Document.8


ASSOC .PPT=oice.powerpoint.show
ASSOC .ppt=PowerPoint.Show.8


ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow


ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, the commands above will need to be run from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the 2007 Microsoft Office System Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
**How to undo the workaround. **For information on how to undo this workaround, see Microsoft Knowledge Base Article 935865.

Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.

