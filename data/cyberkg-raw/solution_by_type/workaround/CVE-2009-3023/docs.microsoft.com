Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-053

Workarounds for IIS FTP Service DoS Vulnerability - CVE-2009-2521
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable the FTP service
Disable the FTP service using one of the following procedures:

From the command prompt, enter the following command:
net stop msftpsvc
In the Internet Information Services panel, perform the following steps:

Expand your server and right click on the FTP site.
Click Stop.



Impact of workaround. You will not be able to transfer files using the FTP service.
How to undo the workaround.
Re-enable the FTP service using one of the following procedures:

From the command prompt, enter the following command:
net start msftpsvc
In the Internet Information Services panel, perform the following steps:

Expand your server and right click on the FTP site.
Click Start.




Deny FTP write access to anonymous users
This workaround blocks denial of service attacks from anonymous users.
This workaround blocks known exploits and minimizes the impact of any variations of this attack vector. However, this workaround does not render the vulnerability completely inaccessible to exploitation.
Anonymous users are not granted FTP write access by default. If anonymous write access has been granted on an FTP server, the administrator can modify IIS permissions to prevent anonymous write access. Anonymous users will not be able to cause a remote code execution with this workaround.
To modify IIS permissions to prevent FTP write access to anonymous users, perform the following steps:

Launch IIS Manager.
Right-click Default FTP Site and point to Properties.
Click the Home Directory tab.
Ensure that Write is deselected.

Impact of workaround: Anonymous users will not have the ability to publish content on the server using the FTP Service.
How to undo the workaround.

Launch IIS Manager.
Right-click Default FTP Site and point to Properties.
Click the Home Directory tab.
Ensure that Write is selected.


Deny FTP access to anonymous users
This workaround blocks denial of service attacks from unauthenticated users without a valid user account.
This workaround blocks known exploits and minimizes the impact of any variations of this attack vector. However, this workaround does not render the vulnerability completely inaccessible to exploitation.
Anonymous users are not granted FTP write access by default. If anonymous write access has been granted on an FTP server, the administrator can modify IIS permissions to prevent anonymous write access. Anonymous users will not be able to exploit the vulnerability with this workaround.
To modify IIS permissions to prevent FTP write access to anonymous users, perform the following steps:

Launch IIS Manager.
Right click Default FTP Site and point to Properties.
Click the SecurityAccounts tab.
Ensure that Allow anonymous connections is deselected.

Impact of Workaround: Anonymous users will not have access to the FTP Service.
How to undo the workaround.

Launch IIS Manager.
Right click Default FTP Site and point to Properties.
Click the SecurityAccounts tab.
Ensure that Allow anonymous connections is selected.


Modify NTFS file system permissions to disallow directory creation by FTP users
This workaround blocks denial of service attacks from authenticated users.
This workaround blocks known exploits and minimizes the impact of any variations of this attack vector. However, this workaround does not render the vulnerability completely inaccessible to exploitation.
An administrator can modify NTFS file system permissions on the root directories of FTP sites hosted on a server to disallow creation of directories by FTP users. This modification still allows FTP users to upload files to existing directories. Authenticated and unauthenticated users will not be able to cause a remote code execution with this workaround.
As administrator, perform the following steps to remove directory creation privileges from the Users group. If you have a configured FTP user or custom group to manage your FTP users, replace the Users group in Step 5 below with these custom identities.

Browse to the root directory of your FTP site. By default this is in %systemroot%\inetpub\ftproot.
Right-click the directory and select Properties.
Click the Security tab and click Advanced.
Click Change Permissions.
Select the Users group and click Edit.
Deselect Create Folders/Append Data.

Impact of Workaround: FTP users will not be able to create directories through the FTP Service. FTP users will still be able to upload files to existing directories through the FTP Service.

Upgrade to FTP Service 7.5
FTP Service 7.5 is available for Internet Information Services 7.0. This version of FTP Service is not affected by the vulnerabilities described in this bulletin. See the following sites on Download Center:

Microsoft FTP Service 7.5 for IIS 7.0 (x86)
Microsoft FTP Service 7.5 for IIS 7.0 (x64)

Impact of workaround: FTP sites will need to be migrated from FTP Service 6.0 to FTP Service 7.5.


Workarounds for IIS FTP Service RCE and DoS Vulnerability - CVE-2009-3023
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable the FTP service
Disable the FTP service using one of the following procedures:

From the command prompt, enter the following command:
net stop msftpsvc
In the Internet Information Services panel, perform the following steps:

Expand your server and right click on the FTP site.
Click Stop.



Impact of workaround. You will not be able to transfer files using the FTP service.
How to undo the workaround.
Re-enable the FTP service using one of the following procedures:

From the command prompt, enter the following command:
net start msftpsvc
In the Internet Information Services panel, perform the following steps:

Expand your server and right click on the FTP site.
Click Start.




Deny FTP write access to anonymous users
This workaround blocks remote code execution attacks from anonymous users. With this workaround, all affected versions of IIS are still vulnerable to denial of service attacks from anonymous users.
This workaround blocks known exploits and minimizes the impact of any variations of this attack vector. However, this workaround does not render the vulnerability completely inaccessible to exploitation.
Anonymous users are not granted FTP write access by default. If anonymous write access has been granted on an FTP server, the administrator can modify IIS permissions to prevent anonymous write access. Anonymous users will not be able to cause a remote code execution with this workaround.
To modify IIS permissions to prevent FTP write access to anonymous users, perform the following steps:

Launch IIS Manager.
Right-click Default FTP Site and point to Properties.
Click the Home Directory tab.
Ensure that Write is deselected.

Impact of workaround: Anonymous users will not have the ability to publish content on the server using the FTP Service.
How to undo the workaround.

Launch IIS Manager.
Right-click Default FTP Site and point to Properties.
Click the Home Directory tab.
Ensure that Write is selected.


Deny FTP access to anonymous users
This workaround blocks denial of service attacks from unauthenticated users without a valid user account.
This workaround blocks known exploits and minimizes the impact of any variations of this attack vector. However, this workaround does not render the vulnerability completely inaccessible to exploitation.
Anonymous users are not granted FTP write access by default. If anonymous write access has been granted on an FTP server, the administrator can modify IIS permissions to prevent anonymous write access. Anonymous users will not be able to exploit the vulnerability with this workaround.
To modify IIS permissions to prevent FTP write access to anonymous users, perform the following steps:

Launch IIS Manager.
Right click Default FTP Site and point to Properties.
Click the SecurityAccounts tab.
Ensure that Allow anonymous connections is deselected.

Impact of Workaround: Anonymous users will not have access to the FTP Service.
How to undo the workaround.

Launch IIS Manager.
Right click Default FTP Site and point to Properties.
Click the SecurityAccounts tab.
Ensure that Allow anonymous connections is selected.


Modify NTFS file system permissions to disallow directory creation by FTP users
This workaround blocks remote code execution attacks from authenticated users. With this workaround, all affected versions of IIS server are still vulnerable to denial of service attacks from authenticated users.
This workaround blocks known exploits and minimizes the impact of any variations of this attack vector. However, this workaround does not render the vulnerability completely inaccessible to exploitation.
An administrator can modify NTFS file system permissions on the root directories of FTP sites hosted on a server to disallow creation of directories by FTP users. This modification still allows FTP users to upload files to existing directories. Authenticated and unauthenticated users will not be able to cause a remote code execution with this workaround.
As administrator, perform the following steps to remove directory creation privileges from the Users group. If you have a configured FTP user or custom group to manage your FTP users, replace the Users group in Step 5 below with these custom identities.

Browse to the root directory of your FTP site. By default this is in %systemroot%\inetpub\ftproot.
Right-click the directory and select Properties.
Click the Security tab and click Advanced.
Click Change Permissions.
Select the Users group and click Edit.
Deselect Create Folders/Append Data.

Impact of Workaround: FTP users will not be able to create directories through the FTP Service. FTP users will still be able to upload files to existing directories through the FTP Service.
How to undo the workaround.

Browse to the root directory of your FTP site. By default this is in %systemroot%\inetpub\ftproot.
Right-click the directory and select Properties.
Click the Security tab and click Advanced.
Click Change Permissions.
Select the Users group and click Edit.
Select Create Folders/Append Data.


Upgrade to FTP Service 7.5
FTP Service 7.5 is available for Internet Information Services 7.0. This version of FTP Service is not affected by the vulnerabilities described in this bulletin. See the following sites on Download Center:

Microsoft FTP Service 7.5 for IIS 7.0 (x86)
Microsoft FTP Service 7.5 for IIS 7.0 (x64)

Impact of workaround: FTP sites will need to be migrated from FTP Service 6.0 to FTP Service 7.5.


