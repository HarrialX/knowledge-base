Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-055

If the workaround “Modify the Access Control List on Vgx.dll to be more restrictive” has been applied to systems, the security updates provided with this security bulletin may not install correctly. See the Workarounds for VML Buffer Overrun Vulnerability – CVE-2006-4868 section in this security bulletin for instructions on how to revert this workaround before applying this security update.
Are there any additional issues related to the workarounds provided in Microsoft Security Advisory 925568 and this Bulletin?
If the “Modify the Access Control List on VGX.DLL to be more restrictive” workaround is applied, software that redistributes vgx.dll may fail to install. An example of this is Internet Explorer 7 Release Candidate 1 and subsequent versions of Internet Explorer 7. Before this software can be installed, the workaround must be reverted to the previous ACL configuration for vgx.dll.
What updates does this release replace?
This security update replaces a prior security update. The security bulletin ID and affected operating systems are listed in the following table.



Bulletin ID
Windows 2000 Service Pack 4
Windows 2000 Service Pack 4 with Internet Explorer 6 Service Pack 1 Installed
Windows XP Service Pack 1
Windows XP Service Pack 2
Windows Server 2003
Windows Server 2003 Service Pack 1




MS04-028
Not Replaced
Replaced
Not Replaced
Not Replaced
Not Replaced
Not Replaced



Why are the security updates for Windows XP Service Pack 1 and Windows 2000 Service Pack 4 labeled as Internet Explorer Updates?
While this is a security update for Windows, the files are serviced from the Internet Explorer code base on these platforms. As such, it follows Internet Explorer standards for packaging as well as detection and deployment.
What is the Internet Explorer Enhanced Security Configuration?
Internet Explorer Enhanced Security Configuration is a group of preconfigured Internet Explorer settings that reduce the likelihood of a user or of an administrator downloading and running specially crafted Web content on a server. Internet Explorer Enhanced Security Configuration reduces this risk by modifying many security-related settings. This includes the settings on the Security tab and the Advanced tab in the Internet Options dialog box. Some of the important modifications include the following:

Security level for the Internet zone is set to High. This setting disables scripts, ActiveX controls, Microsoft Java Virtual Machine (MSJVM), and file downloads.
Automatic detection of intranet sites is disabled. This setting assigns all intranet Web sites and all Universal Naming Convention (UNC) paths that are not explicitly listed in the Local intranet zone to the Internet zone.
Install On Demand and non-Microsoft browser extensions are disabled. This setting prevents Web pages from automatically installing components and prevents non-Microsoft extensions from running.
Multimedia content is disabled. This setting prevents music, animations, and video clips from running.

The Internet Explorer Enhanced Security Configuration does not provide mitigation for applications like Microsoft Outlook which can be installed on Windows Server 2003.
Extended security update support for Microsoft Windows 98, Windows 98 Second Edition, or Windows Millennium Edition ended on July 11, 2006. I am still using one of these operating systems; what should I do?
Windows 98, Windows 98 Second Edition, and Windows Millennium Edition have reached the end of their support life cycles. It should be a priority for customers who have these operating system versions to migrate to supported versions to prevent potential exposure to vulnerabilities. For more information about the Windows Product Lifecycle, visit the following Microsoft Support Lifecycle Web site. For more information about the extended security update support period for these operating system versions, visit the Microsoft Product Support Services Web site.
Extended security update support for Microsoft Windows NT Workstation 4.0 Service Pack 6a and Windows 2000 Service Pack 2 ended on June 30, 2004. Extended security update support for Microsoft Windows NT Server 4.0 Service Pack 6a ended on December 31, 2004. Extended security update support for Microsoft Windows 2000 Service Pack 3 ended on June 30, 2005. I am still using one of these operating systems; what should I do?
Windows NT Workstation 4.0 Service Pack 6a, Windows NT Server 4.0 Service Pack 6a, Windows 2000 Service Pack 2, and Windows 2000 Service Pack 3 have reached the end of their support life cycles. It should be a priority for customers who have these operating system versions to migrate to supported versions to prevent potential exposure to vulnerabilities. For more information about the Windows Product Lifecycle, visit the following Microsoft Support Lifecycle Web site. For more information about the extended security update support period for these operating system versions, visit the Microsoft Product Support Services Web site.
Customers who require custom support for these products must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Windows Operating System Product Support Lifecycle FAQ.
Can I use the Microsoft Baseline Security Analyzer (MBSA) to determine whether this update is required?
The following table provides the MBSA detection summary for this security update.



Product
MBSA 1.2.1
Enterprise Scanning Tool (EST)
MBSA 2.0




Microsoft Windows 2000 Service Pack 4
No
Yes
Yes


Microsoft Windows XP Service Pack 1 and Microsoft Windows XP Service Pack 2
No
Yes
Yes


Microsoft Windows XP Professional x64 Edition
No
No
Yes


Microsoft Windows Server 2003 and Microsoft Windows Server 2003 Service Pack 1
No
Yes
Yes


Microsoft Windows Server 2003 for Itanium-based Systems and Microsoft Windows Server 2003 with Service Pack 1 for Itanium-based Systems
No
No
Yes


Microsoft Windows Server 2003 x64 Edition family
No
No
Yes



For more information about MBSA, visit the MBSA Web site. For more information about the programs that Microsoft Update and MBSA 2.0 currently do not detect, see Microsoft Knowledge Base Article 895660.
For more detailed information, see Microsoft Knowledge Base Article 910723.
What is the Enterprise Update Scan Tool (EST)?
As part of an ongoing commitment to provide detection tools for bulletin-class security updates, Microsoft delivers a stand-alone detection tool whenever the Microsoft Baseline Security Analyzer (MBSA) and the Office Detection Tool (ODT) cannot detect whether the update is required for an MSRC release cycle. This stand-alone tool is called the Enterprise Update Scan Tool (EST) and is designed for enterprise administrators. When a version of the Enterprise Update Scan Tool is created for a specific bulletin, customers can run the tool from a command line interface (CLI) and view the results of the XML output file. To help customers better utilize the tool, detailed documentation will be provided with the tool. There is also a version of the tool that offers an integrated experience for SMS administrators.
Can I use a version of the Enterprise Update Scan Tool (EST) to determine whether this update is required?
Workarounds for VML Buffer Overrun Vulnerability - CVE-2006-4868:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Unregister VGX.DLL

Click Start, click Run, type "%SystemRoot%\System32\regsvr32.exe" -u "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll", and then click OK.
A dialog box appears to confirm that the un-registration process has succeeded. Click OK to close the dialog box.

Impact of Workaround: Applications that render VML will no longer do so once vgx.dll has been unregistered.
This security update does not automatically re-register vgx.dll so any applications that render VML will no longer do so until vgx.dll has been re-registered. To re-register vgx.dll follow these steps:

Click Start, click Run, type "%SystemRoot%\System32\regsvr32.exe" "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll", and then click OK.
A dialog box appears to confirm that the registration process has succeeded. Click OK to close the dialog box.


Modify the Access Control List on VGX.DLL to be more restrictive
Applying this workaround may cause the installation of security updates provided with this security bulletin to fail:
To modify the Access Control List (ACL) on vgx.dll to be more restrictive, follow these steps:

Click Start, click Run, type "cmd" (without the quotation marks), and then click OK.

Type the following command at a command prompt make a note of the current ACL’s that are on the file (including inheritance settings) for future reference to undo this modification:
cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll"

Type the following command at a command prompt to deny the ‘everyone’ group access to this file:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /d everyone

Close Internet Explorer, and reopen it for the changes to take effect.


Impact of Workaround: Applications and Web sites that render VML may no longer display or function correctly.
Before this security update can be installed, this workaround must be reverted to the previous ACL configuration for vgx.dll. To revert to the previous vgx.dll ACL’s follow these steps:

Click Start, click Run, type "cmd" (without the quotation marks), and then click OK.

To revert to the previous ACL configuration for vgx.dll, type the following command and replace the ACL on vgx.dll with the ACL’s it previously had, which were recorded in step 2 of this workaround The command line to do so will vary depending on your environment:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /g original ACL’s

Close Internet Explorer, and reopen it for the changes to take effect.


Note If this workaround is applied, software that redistributes vgx.dll may fail to install. An example of this is Internet Explorer 7 Release Candidate 1 and subsequent versions of Internet Explorer 7. Before this software can be installed, this workaround must be reverted to the previous ACL configuration for vgx.dll.
Note Customers wishing to revert to the default installed ACL configuration for vgx.dll, type the following:

For Windows 2000 Service Pack 4:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /P BUILTIN\Users:R "BUILTIN\Power Users:C" BUILTIN\Administrators:F "NT AUTHORITY\SYSTEM:F"
For Windows XP Service Pack 1 and Windows XP Service Pack 2:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /P BUILTIN\Users:R "BUILTIN\Power Users:C" BUILTIN\Administrators:F "NT AUTHORITY\SYSTEM:F"
For Windows 2003 and Windows 2003 Service Pack 1:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /P BUILTIN\Users:R "BUILTIN\Power Users:C" BUILTIN\Administrators:F "NT AUTHORITY\SYSTEM:F" “NT AUTHORITY\TERMINAL SERVER USER:C”


Configure Internet Explorer 6 for Microsoft Windows XP Service Pack 2 to disable Binary and Script Behaviors in the Internet and Local Intranet security zone
You can help protect against this vulnerability by changing your settings to disable binary and script behaviors in the Internet and Local intranet security zone. To do this, follow these steps:

In Internet Explorer, click Internet Options on the Tools menu.
Click the Security tab.
Click Internet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Binary and Script Behaviors, click Disable, and then click OK.
Click Local intranet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Binary and Script Behaviors, click Disable, and then click OK.
Click OK two times to return to Internet Explorer.

Impact of Workaround: Disabling binary and script behaviors in the Internet and Local intranet security zones may cause some Web sites that rely on VML to not function correctly.

Read e-mail messages in plain text format if you are using Outlook 2002 or a later version, or Outlook Express 6 SP1 or a later version, to help protect yourself from the HTML e-mail attack vector
Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or a later version and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 or a later version can enable this setting and view e-mail messages that are not digitally signed or e-mail messages that are not encrypted in plain text only.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about how to enable this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
For information about this setting in Outlook Express 6, see Microsoft Knowledge Base Article 291387.
Impact of Workaround: E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. Additionally:

The changes are applied to the preview pane and to open messages.
Pictures become attachments so that they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.


Block VML Vulnerability Traffic with ISA Server
Customers with Microsoft Internet Security and Acceleration (ISA) Server 2004 or 2006 may also block malicious traffic intended to exploit this vulnerability. For more information about how to enable this setting in ISA Server, see Learn How Your ISA Server Helps Block VML Vulnerability Traffic.


