Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-076

#### Workarounds for Embedded OpenType Font Integer Overflow Vulnerability - CVE-2010-1883
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality
  
-   **Disable support for parsing embedded fonts in Internet Explorer**
  
    Disabling the support for the parsing of embedded fonts in Internet Explorer prevents this application from being used as an attack vector. However, additional attack vectors, such as embedded fonts within a Microsoft Office document, could still succeed.
  
    **Using the Interactive Method:**
  
    1.  In Internet Explorer, click the **Tools** menu, then click **Internet Options**.  
    2.  In **Internet Options**, click the **Security** tab, select the **Internet** zone, and then click **Custom level…**  
    3.  In **Security Settings - Internet Zone**, scroll down to **Downloads** in the **Settings** pane, and select a **Font download** setting of **Prompt** or **Disable**.  
    4.  Click **OK** to save your selection, then click **OK** again to return to Internet Explorer.
  
    **Using Group Policy:**
  
    **Note** The Group Policy MMC snap-in can be used to set policy for a system, for an organizational unit, or for an entire domain. For more information about Group Policy, visit the following Microsoft Web sites:
  
    -   [Group Policy Collection](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)  
    -   [What Is Group Policy Object Editor?](http://technet2.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a31033.mspx?mfr=true)  
    -   [Core Group Policy Tools and Settings](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)
  
    To use Group Policy, perform the following steps:
  
    1.  Open the Group Policy Management Console and configure it to work with the appropriate group policy object (such as local machine, OU, or domain GPO).  
    2.  Click **User Configuration**, click **Windows Settings**, click **Internet ExplorerMaintenance**, and then click **Security**.  
    3.  Double-click **Security Zones and Content Ratings**, select **Import the current security zones and privacy settings**, and then click **Modify Settings**.
  
    **Note** This creates a group policy for Internet Explorer based on the settings of the currently logged-on user and opens Internet Properties.
  
    1.  In Internet Properties, click the **Security** tab, ensure that the **Internet** zone is selected, and then click **Custom Level…**  
    2.  In **Security Settings - Internet Zone**, scroll down to **Downloads** in the **Settings** pane, and select a **Font download** setting of **Prompt** or **Disable**.  
    3.  Click **OK** to return to **Internet Properties**.  
    4.  Repeat steps 4-6 for the **Local Intranet** zone.  
    5.  Click **OK** three times to return to the Group Policy Management Console.  
    6.  Refresh the group policy on all systems, or wait for the next scheduled group policy refresh interval for the new settings to take effect.
  
    **Using a Managed Script:**
  
    This security setting can be manually entered into the registry by creating a registry script and importing it either by double-clicking it or running regedit.exe as part of a logon or machine startup script. For managed deployments regedit.exe can be used to import a registry script silently with the "-s" switch. For more information on regedit command line switches, see [Microsoft Knowledge Base Article 82821](http://support.microsoft.com/kb/82821), Registration Info Editor (REGEDIT) Command-Line Switches.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.
  
    We recommend that you back up the registry before you edit it.
  
    To set this setting to "Prompt" for the Internet and Local Intranet zones, paste the following text into a .REG file, and then import the .REG file on managed systems as part of your organization's managed deployment process:
```
; Zone 1 is the local intranet zone
; 1604 is the Font download policy
; dword:00000001 sets the policy to prompt
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1]
"1604"=dword:00000001
; Zone 3 is the internet zone
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3]
"1604"=dword:00000001
```

To set this setting to "Disable" for the Internet and Local Intranet zones, paste the following text into a .REG file, and then import the .REG file on managed systems as part of your organization's managed deployment process:

```
Windows Registry Editor Version 5.00
; Zone 1 is the local intranet zone
; 1604 is the Font download policy
; dword:00000003 sets the policy to disable
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1]
"1604"=dword:00000003
; Zone 3 is the internet zone
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3]
"1604"=dword:00000003
```

**Impact of workaround.** Web sites making use of embedded font technology will fail to display properly.


Deny Access to T2EMBED.DLL
For Windows XP and Windows Server 2003:
For 32-bit systems, enter the following command at an administrative command prompt:
Echo y| cacls "%windir%\system32\t2embed.dll" /E /P everyone:N
For 64-bit systems, enter the following command from an administrative command prompt:
Echo y| cacls "%windir%\syswow64\t2embed.dll" /E /P everyone:N
For Windows Vista and Windows Server 2008:
For 32-bit systems, enter the following command at an administrative command prompt:
Takeown.exe /f "%windir%\system32\t2embed.dll"
cacls.exe "%windir%\system32\t2embed.dll" /E /P everyone:N

For 64-bit systems, enter the following command from an administrative command prompt:
Takeown.exe /f "%windir%\syswow64\t2embed.dll"
cacls.exe "%windir%\syswow64\t2embed.dll" /E /P everyone:N

Impact of workaround. Applications that rely on embedded font technology will fail to display properly.
How to undo the workaround.
For 32-bit systems, enter the following command at an administrative command prompt:
cacls "%windir%\system32\t2embed.dll" /E /R everyone
For 64-bit systems, enter the following command from an administrative command prompt:
cacls "%windir%\syswow64\t2embed.dll" /E /R everyone


