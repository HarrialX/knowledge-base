Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-074

Workarounds for SNMP Memory Corruption Vulnerability - CVE-2006-5583:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Restrict the IP addresses that are allowed to manage the computer.

Click Start, and then click Run.
In the Open box, type services.msc and then click OK.
Click SNMP Service and select Properties.
Click the Security tab and select Accept SNMP packets from these hosts.
Add the approved management station's IP address by clicking Add, typing in the IP address or host name, and clicking Add.


Block the following at the firewall:

UDP port 161

This port is used to initiate a connection with the affected component. Blocking it at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured SNMP port on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.

To help protect from network-based attempts to exploit this vulnerability, use a personal firewall, such as the Windows Firewall, which is included with Windows XP.
By default, the Windows Firewall feature in Windows XP helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet.
To enable the Windows Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
Double-click Network Connections and then click Change Windows Firewall settings.
On the General tab, ensure that the On (recommended) value is selected. This will enable the Windows Firewall.
Once the Windows Firewall is enabled, select Don’t allow exceptions to prohibit all incoming traffic.

If you want to enable certain programs and services to communicate through the firewall, de-select Don’t allow exceptions and click the Exceptions tab. On the Exceptions tab, select the programs, protocols, and services you want to enable.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.

Disable the SNMP service
Disabling the SNMP service will help protect the affected system from attempts to exploit this vulnerability. To disable the SNMP service, follow these steps:

Click Start, and then click Control Panel. Alternatively, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Services.
Double-click SNMP Service.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the SNMP service by using the following command at the command prompt:
sc stop SNMP & sc config SNMP start= disabled

Impact of Workaround: If you disable the SNMP service, you may not be able to monitor systems via SNMP.


