Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-049

#### Workarounds for Event System Vulnerability - CVE-2008-1457
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Unregister es.dll**
  
    Perform the following steps:
  
    1.  Log on as a user with administrative privileges.  
    2.  Click **Start**, click **Run**, type **cmd**, and then click **OK**.  
    3.  Type the following command at the command prompt:  
        regsvr32 /-u %WINDIR%\\SYSTEM32\\es.dll
  
    **Impact of workaround:** Event System will not run.
  
    **How to undo the workaround.** Re-register es.dll. Type the following command at the command prompt:
  
    regsvr 32 %WINDIR%\\SYSTEM32\\es.dll
  
-   **Stop and disable the System Event Notification and COM+ Event System services**
  
    Disabling these services helps protect affected systems from attempts to exploit this vulnerability.
  
    -   Interactively
  
        Perform the following steps:
  
        1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel**.  
        2.  Double-click **Administrative Tools**. Alternatively, click **Switch to Classic View** and then double-click **Administrative Tools**.  
        3.  Double-click **Services**.  
        4.  Double-click **System Event Notification**.  
        5.  In the **Startup type** list, click **Disabled**.  
        6.  Click **Stop**, and then click **OK**.
  
        You can also stop and disable the **System Event Notification** service by using the following command at the command prompt (available in Windows XP and in the Microsoft Windows 2000 Resource Kit):
  
        sc stop sens & sc config sens start= disabled
  
        Then repeat the above steps for **COM+ Event System.**
  
        You can also stop and disable the **COM+ Event System** service by using the following command at the command prompt (available in Windows XP and in the Microsoft Windows 2000 Resource Kit):
  
        sc stop eventsystem & sc config eventsystem start= disabled
  
    -   By Group Policy:
  
        Disable these services by using the Group Policy settings. You can disable the startup of this service at either the local, site, domain, or organizational-unit level by using Group Policy object functionality in Microsoft Windows 2000 domain environments or in Windows Server 2003 domain environments.
  
        **Note:** You may also review the Windows Server 2003 Security Guide. This guide includes information about how to disable services.
  
        For more information about Group Policy, visit the following Microsoft Web sites:
  
        -   [Group Policy Collection](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)  
        -   [What is Group Policy Object Editor?](http://technet2.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a31033.mspx?mfr=true)  
        -   [Core Group Policy Tools and Settings](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)
  
    **Impact of workaround.** Programs that require these services will not run.
  
    **How to undo the workaround:** Use the steps above to set the **Startup Type** to **Automatic** and start the service.
  
-   **Modify the Access Control List on es.dll**
  
    To modify the Access Control List (ACL) on es.dll to be more restrictive, follow these steps:
  
    1.  Log on as a user with administrator privileges.  
    2.  Click **Start**, click **Run**, type **cmd**, and then click **OK**.  
    3.  Document the current ACLs that are on the file (including inheritance settings) for future reference in case you have to undo this modification. To view the ACLs, type the following:  
        cacls %WINDIR%\\SYSTEM32\\es.DLL  
    4.  To deny the "everyone" group access to the file, type the following command at the command prompt:  
        echo y| cacls %WINDIR%\\SYSTEM32\\es.DLL /E /P everyone:N
  
    **Impact of workaround:** Programs that require Event System will not run.
  
    **How to undo the workaround:** Type the following command at the command prompt:
  
    echo y| cacls %WINDIR%\\SYSTEM32\\es.DLL /E /R everyone  
    To modify the Access Control List (ACL) on es.dll to be less restrictive, follow these steps:
  
    1.  Log on as a user with administrator privileges.  
    2.  Click **Start**, click **Run**, type **cmd**, and then click **OK**.  
    3.  Document the current ACLs that are on the file (including inheritance settings) for future reference in case you have to undo this modification. To view the ACLs, type the following:  
        cacls %WINDIR%\\SYSTEM32\\es.DLL  
    4.  To allow the "everyone" group access to the file, type the following command at a command prompt:  
        takeown.exe /f %WINDIR%\\SYSTEM32\\es.DLL  
        icacls.exe %WINDIR%\\SYSTEM32\\es.DLL /save %TEMP%\\es\_ACL.TXT  
        icacls.exe %WINDIR%\\SYSTEM32\\es.DLL /allow everyone:(F)
  
#### Workarounds for Event System Vulnerability - CVE-2008-1456
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Unregister es.dll**
  
    Perform the following steps:
  
    1.  Log on as a user with administrative privileges.  
    2.  Click **Start**, click **Run**, type **cmd**, and then click **OK**.  
    3.  Type the following command at the command prompt:  
        regsvr32 /-u %WINDIR%\\SYSTEM32\\es.dll
  
    **Impact of workaround:** Event System will not run.
  
    **How to undo the workaround.** Re-register es.dll. Type the following command at the command prompt:
  
    regsvr 32 %WINDIR%\\SYSTEM32\\es.dll
  
-   **Stop and disable the System Event Notification and COM+ Event System services**
  
    Disabling these services helps protect affected systems from attempts to exploit this vulnerability.
  
    -   Interactively
  
        Perform the following steps:
  
        1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel**.  
        2.  Double-click **Administrative Tools**. Alternatively, click **Switch to Classic View** and then double-click **Administrative Tools**.  
        3.  Double-click **Services**.  
        4.  Double-click **System Event Notification**.  
        5.  In the **Startup type** list, click **Disabled**.  
        6.  Click **Stop**, and then click **OK**.
  
        You can also stop and disable the **System Event Notification** service by using the following command at the command prompt (available in Windows XP and in the Microsoft Windows 2000 Resource Kit):
  
        sc stop sens & sc config sens start= disabled
  
        Then repeat the above steps for **COM+ Event System.**
  
        You can also stop and disable the **COM+ Event System** service by using the following command at the command prompt (available in Windows XP and in the Microsoft Windows 2000 Resource Kit):
  
        sc stop eventsystem & sc config eventsystem start= disabled
  
    -   By Group Policy:
  
        Disable these services by using the Group Policy settings. You can disable the startup of this service at either the local, site, domain, or organizational-unit level by using Group Policy object functionality in Microsoft Windows 2000 domain environments or in Windows Server 2003 domain environments.
  
        **Note:** You may also review the Windows Server 2003 Security Guide. This guide includes information about how to disable services.
  
        For more information about Group Policy, visit the following Microsoft Web sites:
  
        -   [Group Policy Collection](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)  
        -   [What is Group Policy Object Editor?](http://technet2.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a31033.mspx?mfr=true)  
        -   [Core Group Policy Tools and Settings](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)
  
    **Impact of workaround.** Programs that require these services will not run.
  
    **How to undo the workaround:** Use the steps above to set the **Startup Type** to **Automatic** and start the service.
  
-   **Modify the Access Control List on es.dll**
  
    To modify the Access Control List (ACL) on es.dll to be more restrictive, follow these steps:
  
    1.  Log on as a user with administrator privileges.  
    2.  Click **Start**, click **Run**, type **cmd**, and then click **OK**.  
    3.  Document the current ACLs that are on the file (including inheritance settings) for future reference in case you have to undo this modification. To view the ACLs, type the following:  
        cacls %WINDIR%\\SYSTEM32\\es.DLL  
    4.  To deny the "everyone" group access to the file, type the following command at the command prompt:  
        echo y| cacls %WINDIR%\\SYSTEM32\\es.DLL /E /P everyone:N
  
    **Impact of workaround:** Programs that require Event System will not run.
  
    **How to undo the workaround:** Type the following command at the command prompt:
  
    echo y| cacls %WINDIR%\\SYSTEM32\\es.DLL /E /R everyone  
    
    To modify the Access Control List (ACL) on es.dll to be less restrictive, follow these steps:
  
    1.  Log on as a user with administrator privileges.  
    2.  Click **Start**, click **Run**, type **cmd**, and then click **OK**.  
    3.  Document the current ACLs that are on the file (including inheritance settings) for future reference in case you have to undo this modification. To view the ACLs, type the following:  
        cacls %WINDIR%\\SYSTEM32\\es.DLL  
    4.  To allow the "everyone" group access to the file, type the following command at a command prompt:  
        takeown.exe /f %WINDIR%\\SYSTEM32\\es.DLL  
        icacls.exe %WINDIR%\\SYSTEM32\\es.DLL /save %TEMP%\\es\_ACL.TXT  
        icacls.exe %WINDIR%\\SYSTEM32\\es.DLL /allow everyone:(F)
  
