Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-055

Workarounds for Uniform Resource Locator Validation Error Vulnerability - CVE-2008-3007
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable OneNote protocol handler
Note Repairing Office or installing an Office security update may undo this workaround.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.
To disable the protocol handler, follow these steps:
Interactive Method

Click Start, click Run, type "regedit" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT, click on OneNote and then click the Registry menu and select Export.
In the Export Registry File dialog, type “OneNote registry backup.reg” and press Save. This will create a backup of this registry key in the ‘My Documents’ folder by default.
Expand the OneNote key, click on the URL Protocol registry value in the right pane and press the Delete key. When prompted to delete the registry value via the Confirm Value Delete dialog box select Yes.

Managed Deployment Script

First a backup copy of the registry keys can be made from a managed deployment script with the following commands:
Regedit.exe /e OneNote_registry_backup.reg HKEY_CLASSES_ROOT\OneNote
Next save the following to a file with a .REG extension (i.e. Delete_OneNote_URL_Protocol.reg):
Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOT\OneNote]
"URL Protocol"=-
Run the above registry script created in step 2 on the target machine with the following command:
Regedit.exe /s Delete_OneNote_URL_Protocol.reg

Impact of workaround.
This workaround disables the OneNote protocol handler.
How to undo the workaround.
Restore the registry key by using Regedit to restore the settings saved in the .REG file.

Redirect OneNote protocol handler to the About protocol handler
Note Repairing Office or installing an Office security update may undo this workaround.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.
Interactive Method

Click Start, click Run, type "regedit" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT\PROTOCOLS and then click on Handler.
On the Edit menu click New and then click Key.
In the new key dialog type "onenote" (without the quotation marks) and press Enter.
Expand the new HKEY_CLASSES_ROOT\PROTOCOLS\Handler\onenote registry key and on the Edit menu, click New and then click StringValue.
In the new string value dialog type "CLSID" (without the quotation marks).
In the right pane of the registry editor double click on the new "CLSID" registry value and type or paste the following into the "Value Data" dialog box: {3050F406-98B5-11CF-BB82-00AA00BDCE0B} and then press the OK button.

Managed Deployment Script

Save the following to a file with a .REG extension (i.e. OneNote_Handler.reg):
Windows Registry Editor Version 5.00
[HKEY_CLASSES_ROOT\PROTOCOLS\Handler\onenote]
"CLSID"="{3050F406-98B5-11CF-BB82-00AA00BDCE0B}"
Run the above registry script created in step 1 on the target machine with the following command:
Regedit.exe /s OneNote_Handler.reg

Impact of workaround.
This workaround redirects the OneNote protocol handler to the About protocol handler.
How to undo the workaround.

Interactive

Click Start, click Run, type "regedit" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT\PROTOCOLS\Handler
Click on the onenote registry key and then press the Delete key.
When prompted to delete the registry value via the Confirm Key Delete dialog box, select Yes.


Managed Deployment Script

Save the following to a file with a .REG extension (i.e. Delete_OneNote_Handler.reg):
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\PROTOCOLS\Handler\onenote]
Run the above registry script created in step 2 on the target machine with the following command:
Regedit.exe /s Delete_OneNote_Handler.reg



