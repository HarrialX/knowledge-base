Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-004

Workarounds for VML Buffer Overrun Vulnerability - CVE-2007-0024:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Unregister VGX.DLL

Click Start, click Run, type "%SystemRoot%\System32\regsvr32.exe" -u "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll", and then click OK.
A dialog box appears to confirm that the un-registration process has succeeded. Click OK to close the dialog box.

Impact of Workaround: Applications that render VML will no longer do so once vgx.dll has been unregistered.
This security update does not automatically re-register vgx.dll so any applications that render VML will no longer do so until vgx.dll has been re-registered. To re-register vgx.dll follow these steps:

Click Start, click Run, type "%SystemRoot%\System32\regsvr32.exe" "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll", and then click OK.
A dialog box appears to confirm that the registration process has succeeded. Click OK to close the dialog box.


Modify the Access Control List on VGX.DLL to be more restrictive
Applying this workaround may cause the installation of security updates provided with this security bulletin to fail:
To modify the Access Control List (ACL) on vgx.dll to be more restrictive, follow these steps:

Click Start, click Run, type "cmd" (without the quotation marks), and then click OK.
Type the following command at a command prompt make a note of the current ACL’s that are on the file (including inheritance settings) for future reference to undo this modification:
cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll"
Type the following command at a command prompt to deny the ‘everyone’ group access to this file:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /d everyone
Close Internet Explorer, and reopen it for the changes to take effect.

Impact of Workaround: Applications and Web sites that render VML may no longer display or function correctly.
Before this security update can be installed, this workaround must be reverted to the previous ACL configuration for vgx.dll. To revert to the previous vgx.dll ACL’s follow these steps:

Click Start, click Run, type "cmd" (without the quotation marks), and then click OK.
To revert to the previous ACL configuration for vgx.dll, type the following command and replace the ACL on vgx.dll with the ACL’s it previously had, which were recorded in step 2 of this workaround The command line to do so will vary depending on your environment:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /g original ACL’s
Close Internet Explorer, and reopen it for the changes to take effect.

Note If this workaround is applied, software that redistributes vgx.dll may fail to install. An example of this is Internet Explorer 7 Release Candidate 1 and subsequent versions of Windows Internet Explorer 7. Before this software can be installed, this workaround must be reverted to the previous ACL configuration for vgx.dll.
Note Customers wishing to revert to the default installed ACL configuration for vgx.dll, type the following:

For Windows 2000 Service Pack 4:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /P BUILTIN\Users:R "BUILTIN\Power Users:C" BUILTIN\Administrators:F "NT AUTHORITY\SYSTEM:F"

For Windows XP Service Pack 2:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /P BUILTIN\Users:R "BUILTIN\Power Users:C" BUILTIN\Administrators:F "NT AUTHORITY\SYSTEM:F"

For Windows 2003 and Windows 2003 Service Pack 1:
echo y| cacls "%CommonProgramFiles%\Microsoft Shared\VGX\vgx.dll" /P BUILTIN\Users:R "BUILTIN\Power Users:C" BUILTIN\Administrators:F "NT AUTHORITY\SYSTEM:F" “NT AUTHORITY\TERMINAL SERVER USER:C”

Configure Internet Explorer 6 for Microsoft Windows XP Service Pack 2 to disable Binary and Script Behaviors in the Internet and Local Intranet security zone
You can help protect against this vulnerability by changing your settings to disable binary and script behaviors in the Internet and Local intranet security zone. To do this, follow these steps:

In Internet Explorer, click Internet Options on the Tools menu.
Click the Security tab.
Click Internet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Binary and Script Behaviors, click Disable, and then click OK.
Click Local intranet, and then click Custom Level.
Under Settings, in the ActiveX controls and plug-ins section, under Binary and Script Behaviors, click Disable, and then click OK.
Click OK two times to return to Internet Explorer.

Impact of Workaround: Disabling binary and script behaviors in the Internet and Local intranet security zones may cause some Web sites that rely on VML to not function correctly.

Read e-mail messages in plain text format if you are using Outlook 2002 or a later version, or Outlook Express 6 SP1 or a later version, to help protect yourself from the HTML e-mail attack vector
Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or a later version and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 or a later version can enable this setting and view e-mail messages that are not digitally signed or e-mail messages that are not encrypted in plain text only.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about how to enable this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
For information about this setting in Outlook Express 6, see Microsoft Knowledge Base Article 291387.
Impact of Workaround: E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. Additionally:

The changes are applied to the preview pane and to open messages.
Pictures become attachments so that they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.


Block VML Vulnerability Traffic with ISA Server
Customers with Microsoft Internet Security and Acceleration (ISA) Server 2004 or 2006 may also block malicious traffic intended to exploit this vulnerability. For more information about how to enable this setting in ISA Server, see Learn How Your ISA Server Helps Block VML Vulnerability Traffic.


