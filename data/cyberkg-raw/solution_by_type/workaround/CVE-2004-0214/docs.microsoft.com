Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-037

Workarounds for Shell Vulnerability - CAN-2004-0214:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Install the Outlook E-mail Security Update if you are using Outlook 2000 SP1 or earlier to help protect yourself from the HTML e-mail attack vector.
By default, Outlook Express 6, Outlook 2002 and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 98 and Outlook 2000 open HTML e-mail messages in the Restricted sites zone if the Outlook E-mail Security Update has been installed. Outlook Express 5.5 Service Pack 2 opens HTML e-mail in the Restricted sites zone if Microsoft Security Bulletin MS04-018 has been installed. The Restricted sites zone helps reduce attacks that could attempt to exploit this vulnerability.
Customers who use any of these products could be at a reduced risk from an e-mail-borne attack that tries to exploit this vulnerability unless the user clicks a malicious link in the e-mail message.

Read e-mail messages in plain text format if you are using Outlook 2002 or later, or Outlook Express 6 SP1 or later, to help protect yourself from the HTML e-mail attack vector.
Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or later and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 can enable this setting and view e-mail messages that are not digitally signed or e-mail messages that are not encrypted in plain text only.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about enabling this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
For information about this setting in Outlook Express 6, see Microsoft Knowledge Base Article 291387.
Impact of Workaround: E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. In addition:

The changes are applied to the preview pane and to open messages.
Pictures become attachments so that they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.



Workarounds for Program Group Converter - CAN-2004-0572:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Install the Outlook E-mail Security Update if you are using Outlook 2000 SP1 or earlier to help protect yourself from the HTML e-mail attack vector.
By default, Outlook Express 6, Outlook 2002 and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 98 and Outlook 2000 open HTML e-mail messages in the Restricted sites zone if the Outlook E-mail Security Update has been installed. Outlook Express 5.5 Service Pack 2 opens HTML e-mail messages in the Restricted sites zone if Microsoft Security Bulletin MS04-018 has been installed. The Restricted sites zone helps reduce attacks that could attempt to exploit this vulnerability.
Customers who use any of these products could be at a reduced risk from an e-mail-borne attack that tries to exploit this vulnerability unless the user clicks a malicious link in the e-mail message.

Read e-mail messages in plain text format if you are using Outlook 2002 or later, or Outlook Express 6 SP1 or later, to help protect yourself from the HTML e-mail attack vector.
Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or later and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 can enable this setting and view e-mail messages that are not digitally signed or e-mail messages that are not encrypted in plain text only.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about enabling this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
For information about this setting in Outlook Express 6, see Microsoft Knowledge Base Article 291387.
Impact of Workaround: E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. In addition:

The changes are applied to the preview pane and to open messages.
Pictures become attachments so that they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.


Do not open or save .grp files that you receive from untrusted sources.
This vulnerability could be exploited when a user views a .grp file. Do not open files that use this file name extension.

Remove the association between .grp files and the grpconv.exe application on Windows XP, Windows XP Service Pack 1, and Windows Server 2003.
To enable the workaround, follow these steps the following steps as a local administrator:

Put the following code in a file named Un-grpconv.inf:
[Version]
Signature="$CHICAGO$"
[DefaultInstall]
DelReg=DisableGrpAssociation.DelReg
AddReg=DisableGrpAssociation.AddReg
[DisableGrpAssociation.DelReg]
HKCR,"MSProgramGroup"
[DisableGrpAssociation.AddReg]
HKCR,".grp",,,""
HKCR,"MSProgramGroup",,,""
[DisableGrpAssociation.AddReg.Security]
"D:(D;CI;6;;;WD)(A;ID;KR;;;BU)(A;CIIOID;GR;;;BU)(A;ID;0x3001F;;;PU)(A;CIIOID;SDGWGR;;;PU)(A;ID;KA;;;BA)(A;CIIOID;GA;;;BA)(A;ID;KA;;;SY)(A;CIIOID;GA;;;SY)(A;CIIOID;GA;;;CO)"

Right-click on Un-grpconv.inf and then click Install.


To disable the workaround and revert to default behavior, follow these steps as a local administrator:

Put the following code in a file named Grpconv.inf.
[Version]
Signature="$CHICAGO$"
[DefaultInstall]
DelReg=EnableGrpAssociation.DelReg
[EnableGrpAssociation.DelReg]
HKCR,"MSProgramGroup"
HKCR,".grp"

Right-click on Grpconv.inf and then click Install.


Note: This workaround is only designed for Windows XP, Windows XP Service Pack 1, and Windows Server 2003. This workaround does function correctly on other affected operating systems


