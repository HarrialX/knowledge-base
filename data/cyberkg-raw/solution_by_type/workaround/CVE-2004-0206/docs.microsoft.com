Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-031

Workarounds for NetDDE Vulnerability - CAN-2004-0206:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Disable the NetDDE services
Disabling the NetDDE services will help protect from remote attempts to exploit this vulnerability. You can disable the NetDDE services by following these steps:

Click Start, and then click Control Panel (or point to Settings, and then click Control Panel).
Double-click Administrative Tools.
Double-click Services.
Double-click Network DDE.
In the Startup type list, click Disabled.
Click Stop, and then click OK.
Double-click Network DDE DSDM.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

Impact of Workaround: If the NetDDE services are disabled, messages from NetDDE applications are not transmitted. If the NetDDE services are disabled, any services that explicitly depend on the NetDDE services will not start, and an error message is logged in the system event log.

Use the Group Policy settings to disable NetDDE services on all affected systems that do not require this feature.
Because NetDDE is a possible attack vector, disable it by using the Group Policy settings. You can disable the startup of this service at either the local, site, domain or organizational unit level using Group Policy object functionality in Windows 2000 or Windows Server 2003 domain environments.
Note You may also review the Windows 2000 Hardening Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If the NetDDE services are disabled, messages from NetDDE applications are not transmitted. If the NetDDE services are disabled, any services that explicitly depend on the NetDDE services will not start, and an error message is logged in the system event log.

Block the following at the firewall:

UDP ports 135, 137, 138, and 445, and TCP ports 135, 139, 445, and 593
All unsolicited inbound traffic on ports greater than 1024
Any other specifically configured RPC port

These ports can be used to initiate a connection to an affected system. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports that RPC uses, visit the following Web site.

Use a personal firewall such as the Internet Connection Firewall, which is included with Windows XP and Windows Server 2003.
If you use the Internet Connection Firewall feature in Windows XP or in Windows Server 2003 to help protect your Internet connection, it blocks unsolicited inbound traffic by default. We recommend blocking all unsolicited inbound communication from the Internet.
Note This procedure does not apply to Windows XP Service Pack 2. Windows XP Server Pack 2 is not affected by this vulnerability.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections.
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click the Advanced tab.
Click to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.

Note If you want to enable the use of some programs and services through the firewall, click Settings on the Advanced tab, and then select the programs, protocols, and services that are required.

Enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

Block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Articles 313190 and 813878.


