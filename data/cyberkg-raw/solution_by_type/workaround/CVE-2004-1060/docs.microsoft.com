Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-019

Workarounds for IP Validation Vulnerability - CAN-2005-0048:

ISA Server 2000 and ISA Server 2004 can be used to block the affected types of traffic. Please review the ISA Server Preventative Measures Documentation for more information on how to use ISA Server to help mitigate this vulnerability.

Use a personal firewall, such as the Internet Connection Firewall, which is included with Windows XP Service Pack 1.
By default, the Internet Connection Firewall feature in Windows XP Service Pack 1 helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections.
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click the Advanced tab.
Click to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.

Note If you want to enable certain programs and services to communicate through the firewall, click Settings on the Advanced tab, and then select the programs, the protocols, and the services that are required.


Workarounds for ICMP Connection Reset Vulnerability - CAN-2004-0790:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Block all ICMP network packets at the firewall or at the router:
ICMP network packets are used to initiate a connection with the affected components. Blocking them at the firewall or at the router will help protect systems that are behind that firewall or router from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet. ISA Server 2000 and ISA Server 2004 can be used to block the affected types of traffic.
Impact of Workaround: This workaround can also negatively impact performance by preventing TCP from optimizing network communication. ICMP network packets can eliminate fragmentation at routers connecting networks with different MTUs. Fragmentation reduces TCP throughput and increases network congestion.

Block ICMP traffic by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.
Impact of Workaround: This workaround can also negatively impact performance by preventing TCP from optimizing network communication. ICMP network packets can eliminate fragmentation at routers connecting networks with different MTUs. Fragmentation reduces TCP throughput and increases network congestion.


Workarounds for ICMP Path MTU Vulnerability - CAN-2004-1060:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable Path MTU Discovery.
Disabling Path MTU Discovery will prevent an attacker from specifying a low MTU value that could degrade network performance by following these steps:
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.
In Registry Editor, locate the following registry key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
Add the DWORD Value: EnablePMTUDiscovery. Set the value to 0. This value disables Path MTU Discovery. By default, this key does not exist.
You must restart your system for this change to take effect.

Impact of Workaround: These changes will help prevent attacks restricting the ability of an attacker to reduce the Path MTU value to a low value. This setting can also negatively impact performance by preventing TCP from optimizing network communication. This optimization can eliminate fragmentation at routers connecting networks with different MTUs. Fragmentation reduces TCP throughput and increases network congestion. For more information about EnablePMTUDiscovery, see the following Web site.

Block all ICMP network packets at the firewall or at the router:
ICMP network packets are used to initiate a connection with the affected components. Blocking them at the firewall or at the router will help protect systems that are behind that firewall or router from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet. ISA Server 2000 and ISA Server 2004 can be used to block the affected types of traffic.
Impact of Workaround: This workaround can also negatively impact performance by preventing TCP from optimizing network communication. ICMP network packets can eliminate fragmentation at routers connecting networks with different MTUs. Fragmentation reduces TCP throughput and increases network congestion.

Block ICMP traffic by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.
Impact of Workaround: This workaround can also negatively impact performance by preventing TCP from optimizing network communication. ICMP network packets can eliminate fragmentation at routers connecting networks with different MTUs. Fragmentation reduces TCP throughput and increases network congestion.


Workarounds for TCP Connection Reset Vulnerability - CAN-2004-0230:
We have not identified any workarounds for this vulnerability.
Workarounds for Spoofed Connection Request Vulnerability - CAN-2005-0688:

ISA Server 2000 and ISA Server 2004 can be used to block the affected types of traffic. Please review the ISA Server Preventative Measures Documentation for more information on how to use ISA Server to help mitigate this vulnerability.
Enabling the SynAttackProtect registry value on Windows Sever 2003 will mitigate this vulnerability. Windows Server 2003 systems that have enabled this registry value are not vulnerable to this issue. Microsoft recommends that customers enable this registry value. For information on how to enable this registry value, see the following Microsoft Web site. This registry value does not protect other affected operating systems.

