Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-016

#### Workarounds for Movie Maker Buffer Overflow Vulnerability - CVE-2010-0265
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Remove the Movie Maker .MSWMM file association**    
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys and Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    **Note** We recommend backing up the registry before you edit it.
  
    To remove the Movie Maker .MSWMM file association, follow these steps:
  
    **Interactive Method**
  
    1.  Click **Start**, click **Run**, type **regedit**, and then click **OK**.  
    2.  Expand **HKEY\_CLASSES\_ROOT**, click on **.MSWMM**, and then click the **File** menu and select **Export**.  
    3.  In the **Export Registry File** dialog box, type **MSWMM file association registry backup.reg** and click **Save**. This will create a backup of this registry key in the 'My Documents' folder by default.  
    4.  Press the **Delete** key on the keyboard to delete the registry key. When prompted to delete the registry value, click **Yes**.
  
    **Managed Deployment Script**
  
    1.  Make a backup copy of the registry key using the following command:  
        `Regedit.exe /e MSWMM_registry_backup.reg HKEY_CLASSES_ROOT\.MSWMM`  
    2.  Save the following to a file with a .REG extension (i.e., Delete\_MSWMM\_file\_association.reg):  
        ```
		Windows Registry Editor Version 5.00  
        [-HKEY_CLASSES_ROOT\.MSWMM]
		```
    3.  Run the registry script created in step 2 on the target machine with the following command:  
        `Regedit.exe /s Delete_MSWMM_file_association.reg`
  
    **Impact of workaround.** This workaround removes the .MSWMM file association. Double-clicking an MSWMM file will no longer launch Windows Movie Maker.
  
    **How to undo the workaround.** Restore the registry key by using Regedit to restore the settings saved in the .REG file.
  
-   **Remove the Microsoft Producer 2003 .MSProducer, .MSProducerZ, and .MSProducerBF file associations**    
    **Note** See [Microsoft Knowledge Base Article 975561](http://support.microsoft.com/kb/975561) to use the automated **Microsoft Fix it** solution to enable or disable this workaround.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys and Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    **Note** We recommend backing up the registry before you edit it.
  
    To remove the .MSProducer, .MSProducerZ, and .MSProducerBF file associations, follow these steps:
  
    **Interactive Method**
  
    1.  Click **Start**, click **Run**, type **regedit**, and then click **OK**.  
    2.  Expand **HKEY\_CLASSES\_ROOT**, click on **.MSProducer**, and then click the **File** menu and select **Export**.  
    3.  In the **Export Registry File** dialog box, type **MSProducerHKCR file association registry backup.reg** and click **Save**. This will create a backup of this registry key in the 'My Documents' folder by default.  
    4.  Press the **Delete** key on the keyboard to delete the registry key. When prompted to delete the registry value, click **Yes**.  
    5.  Repeat steps 2-4 for the .MSProducerZ and .MSProducerBF file associations.  
    6.  Expand **HKEY\_CURRENT\_USER**, then **Software**, then **Microsoft**, then **Windows**, then **CurrentVersion**, then **Explorer**, and then **FileExts**.  
    7.  Click **.MSProducer**, click **File**, and then click **Export**.  
    8.  In the **Export Registry File** dialog box, type **MSProducer HKCU file association registry backup.reg**, and then click **Save**. This will create a backup of this registry key in the 'My Documents' folder by default.  
    9.  Press the **Delete** key on the keyboard to delete the registry key. When prompted to delete the registry value, click **Yes**.  
    10. Repeat steps 6-9 for the .MSProducerZ and .MSProducerBF file associations.
  
    **Managed Deployment Script**
  
    1.  Make a backup copy of the registry keys using the following commands:  
         ```
		 Regedit.exe /e MSProducer_HKCR_registry_backup.reg HKEY_CLASSES_ROOT\.MSProducer
         Regedit.exe /e MSProducerZ_HKCR_registry_backup.reg HKEY_CLASSES_ROOT\.MSProducerZ
         Regedit.exe /e MSProducerBF_HKCR_registry_backup.reg HKEY_CLASSES_ROOT\.MSProducerBF
         Regedit.exe /e MSProducer_HKCU_registry_backup.reg HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.MSProducer
         Regedit.exe /e MSProducerZ_HKCU_registry_backup.reg HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.MSProducerZ
         Regedit.exe /e MSProducerBF_HKCU_registry_backup.reg HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.MSProducerBF
		 ```  
    2.  Save the following to a file with a .REG extension (i.e., Delete\_MSProducer\_file\_associations.reg):  
         ```
		 Windows Registry Editor Version 5.00
         [-HKEY_CLASSES_ROOT\.MSProducer]
         [-HKEY_CLASSES_ROOT\.MSProducerZ]
         [-HKEY_CLASSES_ROOT\.MSProducerBF]
         [-HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.MSProducer]
         [-HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.MSProducerZ]
         [-HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.MSProducerBF]
		 ```  
    3.  Run the registry script created in step 2 on the target machine with the following command:  
        `Regedit.exe /s Delete_MSProducer_file_associations.reg`
  
    **Impact of workaround.** This workaround removes the .MSProducer, .MSProducerZ, and .MSProducerBF file associations. Double-clicking Microsoft Producer 2003 files will no longer launch Microsoft Producer 2003.
  
    **How to undo the workaround.** Restore the registry keys by using Regedit to restore the settings saved in the .REG files.
  
-   **Disable Microsoft Producer 2003 by restricting access**    
    An administrator can apply an access control list to Microsoft Producer to ensure that the add-in can no longer be loaded. This effectively prevents exploitation of the vulnerability using this attack vector.
  
    **For Windows XP for 32-bit Systems**
  
    Run the following command from a command prompt:
  
    `cacls "%programfiles%\microsoft producer 2\producer.exe" /E /P everyone:N`
  
    **For Windows XP for x64-based Systems**
  
    Run the following command from a command prompt:
  
    `cacls "%programfiles(x86)%\microsoft producer 2\producer.exe" /E /P everyone:N`
  
    **Impact of workaround.**Upon implementing the workaround, the user will no longer be able to run Microsoft Producer 2003.
  
    **How to undo the workaround.** An administrator can run the following commands to allow the Microsoft Producer 2003 add-in to be loaded.
  
    **For Windows XP for 32-bit Systems**
  
    Run the following command from a command prompt:
  
    `cacls "%programfiles%\microsoft producer 2\producer.exe" /E /R everyone`
  
    **For Windows XP for x64-based Systems**
  
    Run the following command from a command prompt:
  
    `cacls "%programfiles(x86)%\microsoft producer 2\producer.exe" /E /R everyone`
  
-   **Prevent Microsoft Producer 2003 from being installed**    
    An administrator can apply an access control list for Microsoft Producer 2003 to ensure that the Microsoft Producer 2003 add-in cannot be installed. This effectively prevents exploitation of the vulnerability using this attack vector.
  
    **For Windows XP for 32-bit Systems**
  
    Run the following commands from a command prompt:
  
     ```
	 md "%programfiles%\microsoft producer 2"
     echo Placeholder > "%programfiles%\microsoft producer 2\producer.exe"
     cacls "%programfiles%\microsoft producer 2\producer.exe" /E /P everyone:N
	 ```
  
    **For Windows XP for x64-based Systems**
  
    Run the following commands from a command prompt:
  
     ```
	 md "%programfiles(x86)%\microsoft producer 2"
     echo Placeholder > "%programfiles(x86)%\microsoft producer 2\producer.exe"
     cacls "%programfiles(x86)%\microsoft producer 2\producer.exe" /E /P everyone:N
	 ```
  
    **Impact of workaround.** Upon implementing the workaround, users will no longer be able to install the Microsoft Producer 2003 add-in.
  
    **How to undo the workaround.** An administrator can run the following commands to allow the Microsoft Producer 2003 add-in to be installed.
  
    **For Windows XP for 32-bit Systems**
  
    Run the following commands from a command prompt:
  
     ```
	 cacls "%programfiles%\microsoft producer 2\producer.exe" /E /R everyone
     echo y| del "%programfiles%\microsoft producer 2\producer.exe"
	 ```
  
    **For Windows XP for x64-based Systems**
  
    Run the following commands from a command prompt:
  
     ```
	 cacls "%programfiles(x86)%\microsoft producer 2\producer.exe" /E /R everyone
     echo y| del "%programfiles(x86)%\microsoft producer 2\producer.exe"
	 ```
  
-   **Uninstall Microsoft Producer 2003**    
    Use **Add/Remove Programs** to uninstall Microsoft Producer 2003.
  
    **Impact of workaround.** Upon implementing the workaround, users will no longer be able to run Microsoft Producer 2003.
  
