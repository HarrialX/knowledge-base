Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-092

#### Workarounds for Windows Media Player DVR-MS Memory Corruption Vulnerability - CVE-2011-3401
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Restrict access to ENCDEC.DLL, which is owned by the Administrators group**
  
    For Windows XP (32-bit editions), run the following command from a command prompt:
  
    ```
    cacls %WINDIR%\SYSTEM32\ENCDEC.DLL /E /P everyone:N
    ```
  
    For Windows XP (x64-based editions), run the following command from a command prompt:
  
    ```
    cacls %WINDIR%\SYSWOW64\ENCDEC.DLL E /P everyone:N
    ```
  
    For Windows Vista (32-bit editions) and Windows 7 (32-bit editions), run the following commands from a command prompt as an administrator:
  
    ```
    takeown /f %WINDIR%\SYSTEM32\ENCDEC.DLL 
    icacls %WINDIR%\SYSTEM32\ENCDEC.DLL /save %TEMP%\ENCDECDLL_ACL.TXT
    icacls %WINDIR%\SYSTEM32\ENCDEC.DLL /deny everyone:(F)
    ```
  
    For Windows Vista (x64-based editions) and Windows 7 (x64-based editions), run the following commands from a command prompt as an administrator:
  
    ```
    takeown /f %WINDIR%\SYSWOW64\ENCDEC.DLL 
    ```
  
    ```
    icacls %WINDIR%\SYSWOW64\ENCDEC.DLL /save %TEMP%\ENCDECDLL_ACL.TXT
    ```
  
    ```
    icacls %WINDIR%\SYSWOW64\ENCDEC.DLL /deny everyone:(F)
    ```
  
    **Impact of workaround.** Play back of .dvr-ms files is disabled..
  
    **How to undo the workaround.** 
  
    For Windows XP (32-bit editions), run the following command from a command prompt:
  
    ```
    cacls %WINDIR%\SYSTEM32\ENCDEC.DLL /E /R everyone
    ```
  
    For Windows XP (x64-based editions), run the following command from a command prompt:
  
    ```
    cacls %WINDIR%\SYSWOW64\ENCDEC.DLL /E /R everyone
    ```
  
    For Windows Vista (32-bit editions) and Windows 7 (32-bit editions), run the following command from a command prompt as an administrator:
  
    ```
    icacls %WINDIR%\SYSTEM32 /restore %TEMP%\ENCDECDLL_ACL.TXT
    ```
  
    For Windows Vista (x64-based editions) and Windows 7 (x64-based editions), run the following command from a command prompt as an administrator:
  
    ```
    icacls %WINDIR%\SYSWOW64 /restore %TEMP%\ENCDECDLL_ACL.TXT
 



Inclusion in Future Service Packs
The update for this issue will be included in a future service pack or update rollup


Deployment
 


Installing without user intervention
For Windows XP Media Center Edition 2005 Service Pack 3:
WindowsXPMediaCenter2005-KB2619340-ENU.exe /quiet



For Windows XP Service Pack 3:
WindowsXP-KB2619339-x86-enu.exe /quiet



For Windows XP Professional x64 Edition Service Pack 2:
WindowsServer2003.WindowsXP-KB2619339-x64-enu.exe /quiet


Installing without restarting
For Windows XP Media Center Edition 2005 Service Pack 3:
WindowsXPMediaCenter2005-KB2619340-ENU.exe /norestart



For Windows XP Service Pack 3:
WindowsXP-KB2619339-x86-enu.exe /norestart



For Windows XP Professional x64 Edition Service Pack 2:
WindowsServer2003.WindowsXP-KB2619339-x64-enu.exe /norestart


Update log file
For Windows XP Media Center Edition 2005 Service Pack 3:
KB2619340.log



For Windows XP Service Pack 3:
KB2619339.log



For Windows XP Professional x64 Edition Service Pack 2:
KB2619339.log


Further information
See the subsection, Detection and Deployment Tools and Guidance


Restart Requirement
 


Restart required?
In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.


HotPatching
Not applicable


Removal Information
For Windows XP Media Center Edition 2005 Service Pack 3:
Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\$NTUninstallKB2619340$\Spuninst folder



For Windows XP Service Pack 3:
Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\$NTUninstallKB2619339$\Spuninst folder



For Windows XP Professional x64 Edition Service Pack 2:
Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\$NTUninstallKB2619339$\Spuninst folder


File Information
For Windows XP Media Center Edition 2005 Service Pack 3:
See Microsoft Knowledge Base Article 2619340



For Windows XP Service Pack 3:
See Microsoft Knowledge Base Article 2619339



For Windows XP Professional x64 Edition Service Pack 2:
See Microsoft Knowledge Base Article 2619339


Registry Key Verification
For Windows XP Media Center Edition 2005 Service Pack 3:
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB2619340\Filelist



For Windows XP Service Pack 3:
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB2619339\Filelist



For Windows XP Professional x64 Edition Service Pack 2:
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB2619339\Filelist



Deployment Information
Installing the Update
When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.
If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994.
For more information about the installer, see Microsoft Knowledge Base Article 832475.
For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684.
This security update supports the following setup switches.


Supported Security Update Installation Switches



Switch


Description




**/help**


Displays the command-line options.




**Setup Modes**




**/passive**


Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.




**/quiet**


Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.




**Restart Options**




**/norestart**


Does not restart when installation has completed.




**/forcerestart**


Restarts the computer after installation and force other applications to close at shutdown without saving open files first.




**/warnrestart\[:x\]**


Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.




**/promptrestart**


Displays a dialog box prompting the local user to allow a restart.




**Special Options**




**/overwriteoem**


Overwrites OEM files without prompting.




**/nobackup**


Does not back up files needed for uninstall.




**/forceappsclose**


Forces other programs to close when the computer shuts down.




**/log:path**


Allows the redirection of installation log files.




**/integrate:path**


Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.




**/extract\[:path\]**


Extracts files without starting the Setup program.




**/ER**


Enables extended error reporting.




**/verbose**


Enables verbose logging. During installation, creates %Windir%\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly.



 
**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841).
Removing the Update
This security update supports the following setup switches.


Supported Spuninst.exe Switches



Switch


Description




**/help**


Displays the command-line options.




Setup Modes




**/passive**


Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.




**/quiet**


Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.




Restart Options




**/norestart**


Does not restart when installation has completed




**/forcerestart**


Restarts the computer after installation and force other applications to close at shutdown without saving open files first.




**/warnrestart\[:x\]**


Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.




**/promptrestart**


Displays a dialog box prompting the local user to allow a restart.




Special Options




**/forceappsclose**


Forces other programs to close when the computer shuts down.




**/log:path**


Allows the redirection of installation log files.



 
**Verifying That the Update Has Been Applied**

Microsoft Baseline Security Analyzer
To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.

File Version Verification
Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

Click Start, and then click Search.
In the Search Results pane, click All files and folders under Search Companion.
In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.
In the list of files, right-click a file name from the appropriate file information table, and then click Properties.
Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.


Registry Key Verification
You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.
These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.


Windows Vista (all editions)
Reference Table
The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section.
 



Inclusion in Future Service Packs
The update for this issue will be included in a future service pack or update rollup


Deployment
 


Installing without user intervention
For all supported 32-bit editions of Windows Vista:
Windows6.0-KB2619339-x86.msu /quiet



For all supported x64-based editions of Windows Vista:
Windows6.0-KB2619339-x64.msu /quiet


Installing without restarting
For all supported 32-bit editions of Windows Vista:
Windows6.0-KB2619339-x86.msu /quiet /norestart



For all supported x64-based editions of Windows Vista:
Windows6.0-KB2619339-x64.msu /quiet /norestart


Further information
See the subsection, Detection and Deployment Tools and Guidance


Restart Requirement
 


Restart required?
In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.


HotPatching
Not applicable.


Removal Information
WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.


File Information
See Microsoft Knowledge Base Article 2619339


Registry Key Verification
Note A registry key does not exist to validate the presence of this update.



  
#### Deployment Information
  
**Installing the Update**
  
When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.
  
For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684).
  
This security update supports the following setup switches.
Supported Security Update Installation Switches



Switch
Description




/?, /h, /help
Displays help on supported switches.


/quiet
Suppresses the display of status or error messages.


/norestart
When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation.



Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307.
Verifying That the Update Has Been Applied

Microsoft Baseline Security Analyzer
To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.

File Version Verification
Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

Click Start and then enter an update file name in the Start Search box.
When the file appears under Programs, right-click the file name and click Properties.
On the General tab, compare the file size with the file information tables provided in the bulletin KB article.
Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.
Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.



Windows 7 (all editions)
Reference Table
The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section.
 



Inclusion in Future Service Packs
The update for this issue will be included in a future service pack or update rollup


Deployment
 


Installing without user intervention
For all supported 32-bit editions of Windows 7:
Windows6.1-KB2619339-x86.msu /quiet



For all supported x64-based editions of Windows 7:
Windows6.1-KB2619339-x64.msu /quiet


Installing without restarting
For all supported 32-bit editions of Windows 7:
Windows6.1-KB2619339-x86.msu /quiet /norestart



For all supported x64-based editions of Windows 7:
Windows6.1-KB2619339-x64.msu /quiet /norestart


Further information
See the subsection, Detection and Deployment Tools and Guidance


Restart Requirement
 


Restart required?
In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.


HotPatching
Not applicable.


Removal Information
To uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.


File Information
See Microsoft Knowledge Base Article 2619339


Registry Key Verification
Note A registry key does not exist to validate the presence of this update.



  
#### Deployment Information
  
**Installing the Update**
  
When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.
  
For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684).
  
This security update supports the following setup switches.
Supported Security Update Installation Switches



Switch
Description




/?, /h, /help
Displays help on supported switches.


/quiet
Suppresses the display of status or error messages.


/norestart
When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation.


/warnrestart:<seconds>
When combined with /quiet, the installer will warn the user before initiating restart.


/promptrestart
When combined with /quiet, the installer will prompt before initiating restart.


/forcerestart
When combined with /quiet, the installer will forcefully close applications and initiate restart.


/log:<file name>
Enables logging to specified file.


/extract:<destination>
Extracts the package contents to the destination folder.


/uninstall /kb:<KB Number>
Uninstalls the security update.



Note For more information about the wusa.exe installer, see "Windows Update Stand-alone Installer" in the TechNet article, Miscellaneous Changes in Windows 7.
Verifying That the Update Has Been Applied

Microsoft Baseline Security Analyzer
To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.

File Version Verification
Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

Click Start and then enter an update file name in the Search box.
When the file appears under Programs, right-click the file name and click Properties.
On the General tab, compare the file size with the file information tables provided in the bulletin KB article.
Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.
Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.



Other Information
Acknowledgments
Microsoft thanks the following for working with us to help protect customers:

An anonymous researcher, working with VeriSign iDefense Labs, for reporting the Windows Media Player DVR-MS Memory Corruption Vulnerability (CVE-2011-3401)

Microsoft Active Protections Program (MAPP)
To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners.
Support

Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.
International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site.

Disclaimer
The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.
Revisions

V1.0 (December 13, 2011): Bulletin published.
V1.1 (July 31, 2012): Bulletin revised to announce a detection change in the Windows Vista packages for KB2619339 to correct a Windows Update reoffering issue. This is a detection change only. Customers who have already successfully updated their systems do not need to take any action.

Built at 2014-04-18T13:49:36Z-07:00







Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 


















Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021









Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 
In this article
























Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021
