Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-009

Workarounds for PNG Processing Vulnerability in Windows Media Player - CAN-2004-1244:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.
There are several different attack vectors that Microsoft has identified for this vulnerability. Each attack vector has a different workaround.

Static WMP File Extension Attack workaround
Disassociate the WMP file extensions.
Disassociate the file extensions (.ASX, .WAX, .WVX, .WPL, .WMX, .WMS, .WMZ) in Windows to avoid previewing or opening files that point to malformed PNG files.
Manual Steps – Windows Media Player method:

Launch Windows Explorer
On the Tools Menu select ‘Folder Options’
Select the ‘File Types’ tab
Scroll to find the .ASX file extension and then press the ‘Delete’ button
Repeat step 4 for each of the file extensions listed above.

In addition, enterprise customers can configure Outlook to block the dangerous files listed using the steps documented in Microsoft Knowledgebase Article 837388. Use these instructions to add the documented file extensions to the Level1 block list.
Home users can configure Outlook Express to block the dangerous files listed using the steps documented in Microsoft Knowledge Base Article 291387. Use this information to configure each of the file extensions as ‘confirm open after download’ in the Windows file types dialog.
Impact of Workaround: Deleting the file associations with Media Player has a high potential for breaking corporate users who may be using Windows Media Server / Player to deliver web casts, training etc.
Home users trying to watch streaming content on various Web sites may also be impacted by implementing this workaround.

Internet Explorer workaround for WMP ActiveX attack
Disable the Windows Media Player ActiveX Control. To prevent against an attack within a webpage follow these steps to disable the Windows Media Player ActiveX Control:
Follow the instructions documented in Microsoft Knowledge Base Article 240797 to killbit the following CLSIDs in Internet Explorer:
CLSID:{6BF52A52-394A-11D3-B153-00C04F79FAA6}PROGID:WMPlayer.OCX.7
CLSID:{22D6F312-B0F6-11D0-94AB-0080C74C7E95}PROGID:MediaPlayer.MediaPlayer.1
CLSID:{05589FA1-C356-11CE-BF01-00AA0055595A}PROGID:AMOVIE.ActiveMovieControl.2

Impact of Workaround:
When you disable the Windows Media Player ActiveX control, pages using this control will no longer function as designed. This prevents any content from being played though the control, including audio and video.

Content-Type HTTP Header Attack
The only way to prevent this attack is to remove all of the possible MIME type entries from the registry that associate Windows Media Player with the MIME type listed in the Content-Type header being returned by the server since they all can be abused to exploit the vulnerability. Below is a list of MIME types that are associated with the WMP CLSID.
HKEY_CLASSES_ROOT\MIME\Database\Content Type\application/vnd.ms-wpl
HKEY_CLASSES_ROOT\MIME\Database\Content Type\application/x-mplayer2
HKEY_CLASSES_ROOT\MIME\Database\Content Type\application/x-ms-wmd
HKEY_CLASSES_ROOT\MIME\Database\Content Type\application/x-ms-wmz
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/aiff
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/basic
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/mid
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/midi
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/mp3
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/mpeg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/mpegurl
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/mpg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/wav
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-aiff
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-mid
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-midi
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-mp3
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-mpeg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-mpegurl
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-mpg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-ms-wax
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-ms-wma
HKEY_CLASSES_ROOT\MIME\Database\Content Type\audio/x-wav
HKEY_CLASSES_ROOT\MIME\Database\Content Type\midi/mid
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/avi
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/mpeg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/mpg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/msvideo
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ivf
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-mpeg
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-mpeg2a
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-asf
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-asf-plugin
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-msvideo
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-wm
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-wmp
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-wmv
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-wmx
HKEY_CLASSES_ROOT\MIME\Database\Content Type\video/x-ms-wvx


Impact of Workaround:

These MIME type registry keys all have a CLSID value which points to the following CLSID:
HKEY_CLASSES_ROOT\CLSID\{CD3AFA8F-B84F-48F0-9393-7EDC34128127}\InprocServer32
This CLSID is associated with WMP.DLL which is responsible for launching Windows Media Player when these MIME types are used. Un-registering WMP.DLL will break Windows Media Player.
The MIME types listed in this workaround are specific to Windows XP. There may be additional MIME types available on other platforms.

Additional information about Windows Media Player File Name Extensions if available at the following MSDN Web site.


Workarounds for PNG Processing Vulnerability in Windows Messenger - CAN-2004-0597 :
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.
Turn off the .NET Alerts feature in Windows Messenger.

Open Windows Messenger
Go to the Tools menu and select “Options”
In the Options Dialog go to the “Privacy” tab.
Check the option that says “Don’t download any tabs to my computer”

Note this setting will take effect the next time you sign into Windows Messenger.
.Net Alerts are only available on Passport accounts that have signed up to receive them. Users who have never configured their account to receive these alerts will not have this setting available.
Workarounds for PNG Processing Vulnerability in MSN Messenger - CAN-2004-0597:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Review all of the contacts currently in your contact list and remove or block any that you do not know, do not trust or no longer need.

Do not agree to accept file transfers from contacts you do not know or trust.

Block access to MSN Messenger and Web Messenger in a corporate environment.

Block access to outgoing port 1863 in your corporate environment.
Note MSN Messenger Service is connected through port 1863 when a direct connection is established. When a direct connection cannot be established, the MSN Messenger Service is connected through port 80.
Block HTTP access to messenger.hotmail.com. If you would like to block access to MSN Web Messenger you will also need to block HTTP access to webmessenger.msn.com.

Impact of Workaround: MSN Messenger clients will not be able to connect to the MSN Messenger network


V1.1 (February 11, 2005): Bulletin updated with information on the mandatory upgrade of vulnerable MSN Messenger clients in the caveat section, as well as changes to the Workarounds for PNG Processing Vulnerability in MSN Messenger – CAN-2004-0597
V1.2 (February 15, 2005): Bulletin updated with correct file version information for Windows Messenger 5.0 update, as well as added Windows Messenger 5.1 to “Non-Affected Software” list.
V2.0 (April 12, 2005): Bulletin updated to announce the availability of an updated package for Microsoft Windows Messenger version 4.7.0.2009 (when running on Windows XP Service Pack 1)
V2.1 (May 11, 2005): Bulletin updated to update the “Security Update Information” section for the MSN Messenger 6.1 or 6.2 file version.
V2.2 (May 18, 2005): Updated the “Security Update Information” section for Microsoft Windows Messenger version 4.7.0.2009 with the correct command line example options.
V2.3 (May 25, 2005): Updated the “Security Update Information” section for Microsoft Windows Messenger version 4.7.0.2009 with the correct setup switches.
V2.4 (July 6, 2005): Updated the “Security Update Information” section for Microsoft Windows Messenger version 4.7.0.2009 with the package name in the setup switches.

Built at 2014-04-18T13:49:36Z-07:00







Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 


















Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021









Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 
In this article
























Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021
