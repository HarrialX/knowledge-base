Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-043

Workarounds for HyperTerminal Vulnerability - CAN-2004-0568:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Do not open or save HyperTerminal Session files (.ht files) that you receive from untrusted sources.
This vulnerability could be exploited when a user views an .ht file. Do not open files that use this file name extension. Also, these steps do not prevent attacks that occur by using Telnet URLs if HyperTerminal has been set as the default Telnet client.

Help prevent e-mail attacks by blocking HyperTerminal session files (.ht files).
This vulnerability could be exploited when a user views an .ht file. To help block these files by using Outlook and Outlook Express, see Microsoft Knowledge Base Article 837388 and Microsoft Knowledge Base Article 291387. Enterprise customers should consider adding HyperTerminal Session files (.ht files) to the list of unsafe files that are blocked by enterprise gateway e-mail filters.
Note When you block HyperTerminal session files (.ht files) through e-mail, you are not preventing attacks that use Telnet URLs if HyperTerminal has been set as the default Telnet client.

Disable the handler for HyperTerminal session files (.ht files) by removing the following key: HKEY_CLASSES_ROOT\htfile
If HyperTerminal cannot be removed, delete this key to help reduce attacks. This workaround helps reduce attacks by preventing HyperTerminal from automatically opening HyperTerminal session files (.ht files).
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.
In Registry Editor, locate the following registry key: HKEY_CLASSES_ROOT\htfile
Click on htfile, and then press the Delete key on the keyboard.
In the Confirm Key Delete dialog box, click OK. For Windows NT 4.0 Server: In the Warning dialog box, click Yes.

Impact of Workaround: HyperTerminal session files (.ht files) must be opened manually from within HyperTerminal. Also, these steps do not prevent attacks that occur by using Telnet URLs if HyperTerminal has been set as the default Telnet client.

Un-register the HyperTerminal client as the default Telnet client.
If HyperTerminal cannot be removed, to help prevent attacks that use Telnet URLs, make sure that HyperTerminal has not be set as the default Telnet client. The following steps can help you determine whether HyperTerminal has been set as the default Telnet client. These steps also describe how to un-register HyperTerminal.
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.
In Registry Editor, locate the following registry key: HKEY_CLASSES_ROOT\telnet\shell\open\command
If the value C:\Program Files\Windows NT\hypertrm.exe /t %1 exists, change it back to the following default value: rundll32.exe url.dll,TelnetProtocolHandler %l
In Registry Editor, locate the following registry key: HKEY_CURRENT_USER\Software\Netscape\NetscapeNavigator\Viewers\telnet
If the value C:\Program Files\Windows NT\hypertrm.exe /t %1 exists, delete this key. By default, this key does not exist. When you delete this key, you help prevent HyperTerminal from being used by Web browsers other than Internet Explorer as the default Telnet client.

Impact of Workaround: These changes will help prevent attacks by blocking HyperTerminal from being used to process Telnet URLs. This does not prevent attacks that occur by using HyperTerminal session files (.ht files).

Remove HyperTerminal.
Removing HyperTerminal will help prevent attacks from HyperTerminal session files (.ht files) and from Telnet URLs.
To remove HyperTerminal, follow these steps:

Click Start, click Run, type "%SystemRoot%\System32\rundll32.exe setupapi,InstallHinfSection HypertrmUninstall 132 %SystemRoot%\inf\communic.inf" (without the quotation marks), and then click OK.
Impact of Workaround: After you remove the HyperTerminal application, any applications that depend on HyperTerminal may fail.


To reinstall HyperTerminal, follow these steps: Â 

Click Start, click Run, type "%SystemRoot%\System32\rundll32.exe setupapi,InstallHinfSection Hypertrm 132 %SystemRoot%\inf\communic.inf" (without the quotation marks), and then click OK.
Note To reinstall HyperTerminal after it has been removed, you must have access to your original installation source media.



On Windows NT 4.0 Server, on Windows 2000 Server, and on Windows Server 2003, remove HyperTerminal by using the Add/Remove Programs tool in Control Panel.
To manually remove HyperTerminal from a system, follow these steps. These steps apply only to Windows 2000 Server and Windows Server 2003 and later. For Windows NT 4.0 Server, follow the procedure that is included in the product documentation.

Click Start, point to Settings, and then click Control Panel.
Double-click Add/Remove Programs.
On the left, click Add/Remove Windows Components.
In the Windows Components Wizard, double-click Accessories and Utilities, and then double-click Communications
Make sure that the check box for HyperTerminal is cleared.
Follow the instructions to complete the Windows Components Wizard.

Impact of Workaround: After you remove the HyperTerminal application, any applications that depend on HyperTerminal may fail.

Delete or rename the HyperTerminal program file.
If HyperTerminal cannot be removed by using the methods that are documented in this section of the security bulletin, you may be able to help prevent attacks by deleting or renaming the physical file.
Delete or rename the C:\Program Files\Windows NT\hypertrm.exe file.
Impact of Workaround: After you remove the HyperTerminal application, any applications that depend on HyperTerminal may fail.


