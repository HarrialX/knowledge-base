Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-004

Workarounds for SQL Server sp_replwritetovarbin Limited Memory Overwrite Vulnerability - CVE-2008-5416
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Deny permissions on the sp_replwritetovarbin extended stored procedure
Use one of the following procedures:
To deny access to the stored procedure, connect to SQL Server as a sysadmin using osql.exe or sqlcmd.exe or through SQL Server Management Studio and execute the following T-SQL script:
use masterdeny execute on sp_replwritetovarbin to public
To deny access to the stored procedure using SQL Server administration:
For SQL Server 2000:

Connect to SQL Server using Enterprise Manager as a sysadmin
From the SQL Server Enterprise Manager window, select the desired server
Expand the databases
Expand Master
Click Extended Stored Procedures. A list of stored procedures appears.
From the list of stored procedures, right-click sp_replwritetovarbin and select Properties
In the Properties window, click Permissions
Under Users/Database Roles/Public, find Public, then click the box in the EXEC column. The box turns into a red X.
Click OK twice

For SQL Server 2005:

Connect to SQL Server using SQL Server Management Studio as a sysadmin
From the Object Explorer window, select the desired server
Expand the databases and the system databases
Expand Master
Expand Programmability
Click Extended Stored Procedures. A list of stored procedures appears.
From the list of stored procedures, right-click sp_replwritetovarbin and select Properties
In the Properties window, click Permissions
Click Deny execution beside the desired user IDs and click OK

To apply the workaround to all running instances of SQL Server on a local computer, a VB script is available and has been previously provided in Microsoft Knowledge Base Article 961040.
Impact of Workaround: Disabling the sp_replwritetovarbin extended stored procedure prevents updates to subscription tables by all users. The impact of this workaround only affects customers that use transactional replication with updatable subscriptions. Customers using transactional replication with read-only subscriptions, bi-directional transactional replication, or peer-to-peer transactional replication are not impacted. For more information on transactional replication with updatable subscriptions, see MSDN.
How to undo the workaround
Connect to SQL Server as a sysadmin using osql.exe or sqlcmd.exe or through SQL Server Management Studio and execute the following T-SQL script:
use mastergrant execute on sp_replwritetovarbin to public
To restore access to the stored procedure via SQL Server administration:
For SQL Server 2000:

Connect to SQL Server using Enterprise Manager as a sysadmin
From the SQL Server Enterprise Manager window, select the desired server
Expand the databases
Expand Master
Click Extended Stored Procedures. A list of stored procedures appears.
From the list of stored procedures, right-click sp_replwritetovarbin and select Properties
In the Properties window, click Permissions
Under Users/Database Roles/Public, find Public, then click the box in the EXEC column. The box turns into a green checkmark.
Click OK twice

For SQL Server 2005:

Connect to SQL Server using SQL Server Management Studio as a sysadmin
From the Object Explorer window, select the desired server
Expand the databases and the system databases
Expand Master
Expand Programmability
Click Extended Stored Procedures. A list of stored procedures appears.
From the list of stored procedures, right-click sp_replwritetovarbin and select Properties
In the Properties window, click Permissions
Click Grant execution beside the desired user IDs and click OK



