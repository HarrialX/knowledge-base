Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-036

Workarounds for NNTP Vulnerability - CAN-2004-0574:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block the following at the firewall:

UDP ports 119 and 563
TCP ports 119 and 563

These ports are used to initiate a connection with a NNTP server. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured NNTP ports on the system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports that NNTP uses, visit the following Web site. Port 563 is the default port that NNTP uses to perform Secure Sockets Layer (SSL) connections.

Enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block the affected ports and to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

Block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Articles 313190 and 813878.

Remove or disable NNTP if you do not need it:
In many organizations, NNTP only provides services for legacy systems. If you no longer need NNTP, you could remove it by following these steps. These steps apply only to Windows 2000 and later versions. For Windows NT 4.0, follow the procedure that is included in the product documentation. NNTP is a required component for Exchange 2000 Server and Exchange Server 2003. However, while NNTP may not be removed on Exchange servers, it can be disabled. NNTP is disabled by default on Exchange 2003. To help secure Exchange 2000 systems, follow the Securing Exchange 2000 Server best practice recommendations instead of these instructions.
To remove NNTP components and services:

In Control Panel, click Add or Remove Programs.
Click Add/Remove Windows Components.
On the Windows Components Wizard page, under Components, click Internet Information Services (IIS), and then click Details.
Click to clear the Network News Transfer Protocol Service (NNTP) check box to remove NNTP.
Complete the Windows Components Wizard by following the instructions on the screen.

Impact of Workaround: NNTP services will no longer function. Any applications or services that require NNTP may fail. Administrators should not remove NNTP unless they fully understand the affect that doing so will have on their network. For more information about NNTP, see the NNTP product documentation.


