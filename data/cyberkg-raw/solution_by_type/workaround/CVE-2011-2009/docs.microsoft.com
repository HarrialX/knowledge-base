Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-076

#### Workarounds for Media Center Insecure Library Loading Vulnerability - CVE-2011-2009
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Disable loading of libraries from WebDAV and remote network shares**
    
    **Note** See [Microsoft Knowledge Base Article 2264107](http://support.microsoft.com/kb/2264107) to deploy a workaround tool that allows customers to disable the loading of libraries from remote network or WebDAV shares. This tool can be configured to disallow insecure loading on a per-application or a global system basis.
  
    Customers who are informed by their vendor of an application being vulnerable can use this tool to help protect against attempts to exploit this issue.
    
    **Note** See [Microsoft Knowledge Base Article 2264107](http://support.microsoft.com/kb/2264107) to use the automated **Microsoft Fix it** solution to deploy the registry key to block the loading of libraries for SMB and WebDAV shares. Note that this Fix it solution does require you to install the workaround tool also described in [Microsoft Knowledge Base Article 2264107](http://support.microsoft.com/kb/2264107) first. This Fix it solution only deploys the registry key and requires the workaround tool in order to be effective. We recommend that administrators review the KB article closely prior to deploying this Fix it solution.
  
-   **Disable the WebClient service**
  
    Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet.
  
    To disable the WebClient Service, follow these steps:
  
    1.  Click **Start**, click **Run**, type **Services.msc** and then click **OK**.  
    2.  Right-click **WebClient** service and select **Properties**.  
    3.  Change the Startup type to **Disabled**. If the service is running, click **Stop**.  
    4.  Click **OK** and exit the management application.
  
    **Impact of workaround.**Â When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the Web Client service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer.
  
    **How to undo the workaround.**
  
    To re-enable the WebClient Service, follow these steps:
  
    1.  Click **Start**, click **Run**, type **Services.msc** and then click **OK**.  
    2.  Right-click **WebClient** service and select **Properties**.  
    3.  Change the Startup type to **Automatic**. If the service is not running, click **Start**.  
    4.  Click **OK** and exit the management application.
  
-   **Block TCP ports 139 and 445 at the firewall**
  
    These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
    **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:
  
    -   Applications that use SMB (CIFS)  
    -   Applications that use mailslots or named pipes (RPC over SMB)  
    -   Server (File and Print Sharing)  
    -   Group Policy  
    -   Net Logon  
    -   Distributed File System (DFS)  
    -   Terminal Server Licensing  
    -   Print Spooler  
    -   Computer Browser  
    -   Remote Procedure Call Locator  
    -   Fax Service  
    -   Indexing Service  
    -   Performance Logs and Alerts  
    -   Systems Management Server  
    -   License Logging Service
  
    **How to undo the workaround.** Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
