Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-017

Workarounds for Legacy File Format Vulnerability - CVE-2009-0220
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 4.0 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Integer Overflow Vulnerability - CVE-2009-0221
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) will protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or 2007 Office system installed.
To install MOICE, you must have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center:
Download the FileFormatConverters.exe package now
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates:
http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=en-us
To enable MOICE, change the registered handler for the .ppt, .pot, and .pps file formats. The following table describes the command to enable or to disable MOICE for the .ppt, .pot, and .pps file formats:





Command to use to enable MOICE to be the registered handler
Command to use to disable MOICE as the registered handler




ASSOC .PPT=oice.powerpoint.show
ASSOC .ppt=PowerPoint.Show.8


ASSOC .POT=oice.powerpoint.template
ASSOC .pot=PowerPoint.Template.8


ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista and Windows Server 2008, the commands above will need to be run from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of Workaround: Office 2003 and earlier formatted documents that are converted to the 2007 Microsoft Office System Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001
Note In order to use 'FileOpenBlock' with Office 2003, all of the latest Office 2003 security updates must be applied.


Impact of Workaround: Users who have configured the File Block policy and have not configured a special “exempt directory” as discussed in Microsoft Knowledge Base Article 970980 will be unable to open Office 2003 files or earlier versions in Office 2003 or 2007 Microsoft Office System.
How to Undo the Workaround:

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000000



Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Legacy File Format Vulnerability - CVE-2009-0222
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 4.0 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Legacy File Format Vulnerability - CVE-2009-0223
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 4.0 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Memory Corruption Vulnerability - CVE-2009-0224
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) will protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or 2007 Office system installed.
To install MOICE, you must have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center:
Download the FileFormatConverters.exe package now
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates:
http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=en-us
To enable MOICE, change the registered handler for the .ppt, .pot, and .pps file formats. The following table describes the command to enable or to disable MOICE for the .ppt, .pot, and .pps file formats:





Command to use to enable MOICE to be the registered handler
Command to use to disable MOICE as the registered handler




ASSOC .PPT=oice.powerpoint.show
ASSOC .ppt=PowerPoint.Show.8


ASSOC .POT=oice.powerpoint.template
ASSOC .pot=PowerPoint.Template.8


ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista and Windows Server 2008, the commands above will need to be run from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of Workaround: Office 2003 and earlier formatted documents that are converted to the 2007 Microsoft Office System Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001
Note In order to use 'FileOpenBlock' with Office 2003, all of the latest Office 2003 security updates must be applied.


Impact of Workaround: Users who have configured the File Block policy and have not configured a special “exempt directory” as discussed in Microsoft Knowledge Base Article 970980 will be unable to open Office 2003 files or earlier versions in Office 2003 or 2007 Microsoft Office System.
How to Undo the Workaround:

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000000



Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for PP7 Memory Corruption Vulnerability - CVE-2009-0225
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp7x32.dll in Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 95 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Legacy File Format Vulnerability - CVE-2009-0226
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 4.0 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Legacy File Format Vulnerability - CVE-2009-0227
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 4.0 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Memory Corruption Vulnerability - CVE-2009-0556
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) will protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or 2007 Office system installed.
To install MOICE, you must have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center:
Download the FileFormatConverters.exe package now
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates:
http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=en-us
To enable MOICE, change the registered handler for the .ppt, .pot, and .pps file formats. The following table describes the command to enable or to disable MOICE for the .ppt, .pot, and .pps file formats:





Command to use to enable MOICE to be the registered handler
Command to use to disable MOICE as the registered handler




ASSOC .PPT=oice.powerpoint.show
ASSOC .ppt=PowerPoint.Show.8


ASSOC .POT=oice.powerpoint.template
ASSOC .pot=PowerPoint.Template.8


ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista and Windows Server 2008, the commands above will need to be run from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of Workaround: Office 2003 and earlier formatted documents that are converted to the 2007 Microsoft Office System Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001
Note In order to use 'FileOpenBlock' with Office 2003, all of the latest Office 2003 security updates must be applied.


Impact of Workaround: Users who have configured the File Block policy and have not configured a special “exempt directory” as discussed in Microsoft Knowledge Base Article 970980 will be unable to open Office 2003 files or earlier versions in Office 2003 or 2007 Microsoft Office System.
How to Undo the Workaround:

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000000



Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for PP7 Memory Corruption Vulnerability - CVE-2009-1128
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp7x32.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 95 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone




Workarounds for PP7 Memory Corruption Vulnerability - CVE-2009-1129
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp7x32.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 95 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp7x32.dll^"') DO cacls "%G" /E /R everyone




Workarounds for Heap Corruption Vulnerability - CVE-2009-1130
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) will protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or 2007 Office system installed.
To install MOICE, you must have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center:
Download the FileFormatConverters.exe package now
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates:
http://update.microsoft.com/microsoftupdate/v6/default.aspx?ln=en-us
To enable MOICE, change the registered handler for the .ppt, .pot, and .pps file formats. The following table describes the command to enable or to disable MOICE for the .ppt, .pot, and .pps file formats:





Command to use to enable MOICE to be the registered handler
Command to use to disable MOICE as the registered handler




ASSOC .PPT=oice.powerpoint.show
ASSOC .ppt=PowerPoint.Show.8


ASSOC .POT=oice.powerpoint.template
ASSOC .pot=PowerPoint.Template.8


ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista and Windows Server 2008, the commands above will need to be run from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of Workaround: Office 2003 and earlier formatted documents that are converted to the 2007 Microsoft Office System Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001
Note In order to use 'FileOpenBlock' with Office 2003, all of the latest Office 2003 security updates must be applied.


Impact of Workaround: Users who have configured the File Block policy and have not configured a special “exempt directory” as discussed in Microsoft Knowledge Base Article 970980 will be unable to open Office 2003 files or earlier versions in Office 2003 or 2007 Microsoft Office System.
How to Undo the Workaround:

For Office 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000000



Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Data Out of Bounds Vulnerability - CVE-2009-1131
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.

Workarounds for Legacy File Format Vulnerability - CVE-2009-1137
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002
Note You will need administrator privileges to set these file restrictions.

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /P everyone:N


Impact of Workaround. You will not be able to open PowerPoint 4.0 files.
How to Undo the Workaround:

On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone

On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:
for /F "tokens=*" %G IN ('dir /b /s ^"%programfiles(x86)%\Microsoft Office\pp4x322.dll^"') DO cacls "%G" /E /R everyone




