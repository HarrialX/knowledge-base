Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-005

Workarounds for Windows Media Player Vulnerability - CVE-2006-0006:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.
Note The following steps require Administrator privileges. We recommend that you restart the computer after you apply this workaround. Alternatively, you can log out and log back in after you apply the workaround. However, we do recommend that you restart the computer.

Back up and remove the WMZ registry key
Removing the WMZ registry key helps protect the affected system from attempts to exploit this vulnerability. To backup and remove the WMZ registry key, follow these steps:
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.

Click Start, click Run, type “regedit" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT, and then click .WMZ.
Click File, and then click Export.
In the Export Registry File dialog box, type a file name in the File Name box, and then click Save.
Click Edit, then click Delete to remove the registry key.
In the Confirm Key Delete dialog box, you receive a “Are you sure you want to delete this key and all of its subkeys” message. Click Yes.



Note Removing the skin file association needs to be done in addition to at least one of the workarounds listed below.
Impact of Workaround: This workaround disables the Media Player skin file association but does not prevent users from applying alternate skins that are already present in their default skins directory (%Programfiles%\Windows Media Player\skins).

Modify the Access Control List on the DirectX “Filter Graph no thread” registry key
Modifying the Access Control List on the “Filter Graph no thread” registry key helps protect the affected system from attempts to exploit this vulnerability. To modify the Filter Graph no Thread Splitter registry key, follow these steps.
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.
For Windows 2000
Note Make a note of the permissions that are listed in the dialog box so that you can restore them to their original values at a later time

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT, expand CLSID, and then click { E436EBB8-524F-11CE-9F53-0020AF0BA770}.
Click Security, and then click Permissions.
Click to clear the Allow Inheritable Permissions from the parent to propagate to this object check box. You are prompted to click Copy, Remove, or Cancel. Click Remove, and then click OK.
You receive a message that states that no one will be able to access this registry key. Click Yes when you are prompted to do so.

For Windows XP Service Pack 1 or later operating systems
Note Make a note of the permissions that are listed in the dialog box so that you can restore them to their original values at a later time

Click Start, click Run, type "regedit" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT, expand CLSID, and then click**{ E436EBB8-524F-11CE-9F53-0020AF0BA770}**.
Click Edit, and then click Permissions.
Click Advanced.
Click to clear the Inherit from parent the permission entries that apply to child objects. Include these with entries explicitly defined here. check box. You are prompted to click Copy, Remove, or Cancel. Click Remove, and then check OK.
You receive a message that states that no one will be able to access this registry key. Click Yes, and then click OK to close the Permissions for { E436EBB8-524F-11CE-9F53-0020AF0BA770} dialog box.



Note If you have backed up and removed the DirectX “Filter Graph no thread” registry key, you do not need to modify the Access Control List on the DirectX “Filter Graph no thread” registry key.
Impact of Workaround: This workaround disables image rendering and audio and video playback in any number of DirectX-enabled applications.

Backup and remove the DirectX “Filter Graph no thread” registry key
Removing the “Filter Graph no thread” registry key helps protect the affected system from attempts to exploit this vulnerability. To backup and remove the “Filter Graph no thread” registry key, follow these steps:
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.

Click Start, click Run, type “regedit" (without the quotation marks), and then click OK.
Expand HKEY_CLASSES_ROOT, expand CLSID, and then click {E436EBB8-524F-11CE-9F53-0020AF0BA770}.
Click File, and then click Export.
In the Export Registry File dialog box, type a file name in the File Name box, and then click Save.
Click Edit, and then click Delete to remove the registry key.
In the Confirm Key Delete dialog box, you receive a “Are you sure you want to delete this key and all of its subkeys” message. Click Yes.



Note If you have backed up and remove the “DirectX “Filter Graph no thread” registry key, you do not need to modify the Access Control List on the DirectX “Filter Graph no thread” registry key
Impact of Workaround: This workaround disables image rendering and audio and video playback in any number of DirectX-enabled applications.

Un-register Quartz.dll
Un-registering the Quartz.dll registry key helps protect the affected system from attempts to exploit this vulnerability. To modify the Quartz.dll registry key, follow these steps.

Click Start, click Run, type "regsvr32 -u %windir%\system32\ quartz.dll" (without the quotation marks), and then click OK.
When a dialog box appears that confirms that the process has been successful, click OK.



Impact of Workaround: This workaround disables image rendering and audio and video playback in any number of DirectX-enabled applications.
V1.1 (February 17, 2006): Bulletin updated for the following: “What updates does this release replace?” and “Are Windows 98, Windows 98 Second Edition, or Windows Millennium Edition critically affected by this vulnerability?” within the “Frequently asked questions (FAQ) related to this security update” section. Updated operating systems within “Severity Ratings and Vulnerability Identifiers” in the “Executive Summary” section; Revised malicious file name (.wmp to .bmp) under the “Vulnerability Details” section; Revised finder details in the “Acknowledgments” section; and additional clarity around the workaround “Un-register Quartz.dll“ in the “Workarounds for Windows Media Player” section.
V1.2 (March 8, 2006): Bulletin revised: “Caveats” section updated due to new issues discovered with the security update. Users may experience issues when they try to seek, fast rewind, or fast forward in Windows Media Player 10.
