Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-047

Workarounds for Windows Media Header Parsing Invalid Free Vulnerability - CVE-2009-2498
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
Restrict access to wmvcore.dll
For all supported 32-bit editions of Windows XP:
Run the following command from a command prompt:
cacls %SystemRoot%\System32\wmvcore.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player.
How to undo the workaround.
Run the following command from a command prompt:
cacls %SystemRoot%\System32\wmvcore.dll /E /R everyone
For all supported x64-based editions of Windows XP:
Run the following command from a command prompt:
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player.
How to undo the workaround.
Run the following command from a command prompt:
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /R everyone
For all supported 32-bit editions of Windows Vista and Windows Server 2008:
Run the following command from an elevated administrator command prompt:
takeown /f %SystemRoot%\System32\wmvcore.dll
cacls %SystemRoot%\System32\wmvcore.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player. Windows Media Player exits with an error.
How to undo the workaround.
Run the following command from an elevated administrator command prompt:
cacls %SystemRoot%\System32\wmvcore.dll /E /R everyone
For all supported x64-based editions of Windows Vista and Windows Server 2008:
Run the following command from an elevated administrator command prompt:
takeown /f %SystemRoot%\SysWOW64\wmvcore.dll
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /P everyone:N
**Impact of workaround.**You will not be able to play media files in Windows Explorer or in Windows Media Player. Windows Media Player exits with an error.
How to undo the workaround.
Run the following command from an elevated administrator command prompt:
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /R everyone
Workarounds for Windows Media Playback Memory Corruption Vulnerability - CVE-2009-2499
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
Restrict access to wmvcore.dll and mf.dll
For all supported 32-bit editions of Windows XP:
Run the following command from a command prompt:
cacls %SystemRoot%\System32\wmvcore.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player.
How to undo the workaround.
Run the following command from a command prompt:
cacls %SystemRoot%\System32\wmvcore.dll /E /R everyone
For all supported x64-based editions of Windows XP:
Run the following command from a command prompt:
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player.
How to undo the workaround.
Run the following command from a command prompt:
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /Reveryone
For all supported 32-bit editions of Windows Vista and Windows Server 2008:
Run the following command from an elevated administrator command prompt:
takeown /f %SystemRoot%\System32\wmvcore.dll
cacls %SystemRoot%\System32\wmvcore.dll /E /P everyone:N
takeown /f %SystemRoot%\System32\mf.dll
cacls %SystemRoot%\System32\mf.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player. Windows Media Player exits with an error.
How to undo the workaround.
Run the following command from an elevated administrator command prompt:
cacls %SystemRoot%\System32\wmvcore.dll /E /R everyone
cacls %SystemRoot%\System32\mf.dll /E /R everyone
For all supported x64-based editions of Windows Vista and Windows Server 2008:
Run the following command from an elevated administrator command prompt:
takeown /f %SystemRoot%\SysWOW64\wmvcore.dll
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /R everyone:N
takeown /f %SystemRoot%\SysWOW64\mf.dll
cacls %SystemRoot%\SysWOW64\mf.dll /E /P everyone:N
Impact of workaround. You will not be able to play media files in Windows Explorer or in Windows Media Player. Windows Media Player exits with an error.
How to undo the workaround.
Run the following command from an elevated administrator command prompt:
cacls %SystemRoot%\SysWOW64\wmvcore.dll /E /R everyone
cacls %SystemRoot%\SysWOW64\mf.dll /E /R everyone
