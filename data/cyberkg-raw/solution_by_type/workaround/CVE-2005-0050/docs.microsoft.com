Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-010

Workarounds for License Logging Service Vulnerability - CAN-2005-0050:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the License Logging service
Disabling the License Logging service will help protect from remote attempts to exploit this vulnerability.
Note Do not perform this procedure on Small Business Server 2000 or Windows Small Business Server 2003. These operating system versions require the License Logging service. These operating system versions may fail to function correctly if the License Logging service is disabled.
You can disable the License Logging service services by following these steps:

Click Start, and then click Control Panel (or point to Settings, and then click Control Panel).
Double-click Administrative Tools.
Double-click Services.
Double-click License Logging Service.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

Impact of Workaround: If the License Logging service is disabled, any services that explicitly depend on the License Logging services may log an error message in the system event log. For more information, see Microsoft Knowledge Base Article 316631.

Use the Group Policy settings to disable License Logging Service on all affected systems that do not require this feature.
Because the License Logging serviceis a possible attack vector, disable it by using the Group Policy settings. You can disable the startup of this service at the local, site, domain, or organizational unit level by using Group Policy object functionality in Windows 2000 domain environments or in Windows Server 2003 domain environments.
Note Do not perform this procedure on Small Business Server 2000 or Windows Small Business Server 2003. These operating system versions require the License Logging service. These operating system versions may fail to function correctly if the License Logging service is disabled.
Note You may also review the Windows 2000 Security Hardening Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If the License Logging service is disabled, any services that explicitly depend on the License Logging service may log an error message in the system event log. For more information, see Microsoft Knowledge Base Article 316631.

On Windows NT Server 4.0 Service Pack 6a, Windows NT Server 4.0 Terminal Server Edition Service Pack 6, and Windows 2000 Server Service Pack 3 remove the License Logging service from the NullSessionPipes registry key:
Affected operating systems that are earlier than Windows 2000 Server Service Pack 4 allowed anonymous connections to the License Logging service. Removing the License Logging service from the NullSessionPipes subkey registry key will help prevent attempts to exploit this vulnerability by an anonymous attacker. This workaround will not prevent attacks from authenticated users and should only be used if the License Logging service cannot be disabled. For more information about this change, see Microsoft Knowledge Base Article 815458.
Note Using Registry Editor incorrectly can cause serious problems that may require that you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to modify the registry, view the "Change Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you modify it.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.

In Registry Editor, locate the following registry key:
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\NullSessionPipes

Edit the registry key and remove the Llsrpc value.

Restart the affected system after performing these actions.


Impact of Workaround: Anonymous connections to the License Logging service will not be allowed. There is no known impact of this change. This is the default configuration of Windows 2000 Server Service Pack 4.

Use a personal firewall, such as the Internet Connection Firewall, which is included with Windows Server 2003.
By default, the Internet Connection Firewall feature in Windows Server 2003 helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet.
Note Do not perform this procedure on Small Business Server 2000 or Windows Small Business Server 2003. Use the instructions provided in the “Run the Configure E-mail and Internet Connection Wizard” workaround instead of this procedure.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections.
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click the Advanced tab.
Click to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.

Note If you want to enable certain programs and services to communicate through the firewall, click Settings on the Advanced tab, and then select the programs, the protocols, and the services that are required.

Block TCP ports 139 and 445 at the firewall:
These ports are used to initiate a connection with the License Logging service using named pipe connections. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit the following Web site.

Run the Configure E-mail and Internet Connection Wizard
Small Business Server 2000 and Windows Small Business Server 2003 include firewall technology that helps protect your Internet connection by blocking unsolicited incoming traffic. The firewall technology in Small Business Server 2000 and Windows Small Business Server 2003 is configured automatically when you run the Configure E-mail and Internet Connection Wizard.
To configure the firewall technology using the Configure E-mail and Internet Connection Wizard, follow these steps:

Click Start, and then click Server Management.
In the console tree, click Internet and E-mail

In the details pane, click Connect to the Internet.

Accept the default values in the wizard.


Enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

Block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.


