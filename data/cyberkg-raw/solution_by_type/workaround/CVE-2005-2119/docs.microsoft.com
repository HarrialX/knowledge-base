Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-051

Workarounds for MSDTC Vulnerability - CAN-2005-2119:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the Distributed Transaction Coordinator
Disabling the Distributed Transaction Coordinator helps protect the affected system from attempts to exploit this vulnerability. To disable the Distributed Transaction Coordinator, follow these steps:

Click Start, and then click Control Panel. Alternatively, click Start, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Component Services.
Click Services.
Double-click Distributed Transaction Coordinator.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the Distributed Transaction Coordinator by using the following command at the command prompt:
sc stop MSDTC & sc config MSDTC start= disabled
Impact of Workaround: If you disable the Distributed Transaction Coordinator, you cannot use any service or application that is dependant on the Distributed Transaction Coordinator. This could include other applications such as SQL Server, BizTalk Server, Exchange Server, or Message Queuing. Also, this service is required in most clustering configurations. Therefore, we recommend this workaround only on systems that cannot install the security update.

Use the Group Policy settings to disable the Distributed Transaction Coordinator on all affected systems that do not require this feature.
Because the Distributed Transaction Coordinator is a possible attack vector, disable it by using the Group Policy settings. You can disable the startup of this service at the local, site, domain, or organizational unit level by using Group Policy object functionality in Windows 2000 domain environments or in Windows Server 2003 domain environments. For more information about how to disable this service through logon scripts, see Microsoft Knowledge Base Article 297789
Note You may also review the Windows 2000 Security Hardening Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If you disable the Distributed Transaction Coordinator, you cannot use any service or application that is dependant on the Distributed Transaction Coordinator. This could include other applications such as SQL Server, BizTalk Server, Exchange Server, or Message Queuing. Also, this service is required in most clustering configurations. Therefore, we recommend this workaround only on systems that cannot install the security update.

Disable Network DTC Access
If you cannot install the security update, and you cannot disable the Distributed Transaction Coordinator, you may want to disable Network DTC Access. This option is only available on Windows XP and later operating system versions. This still allows local transactions to complete, but it helps protect from network based attacks that try to exploit this issue. For information about how to configure Network DTC Access, visit the following Microsoft Web site. To disable Network DTC Access, follow these steps:
Warning Performing this procedure causes the affected service to start if it was not started previously. Stop the MSDTC service on the MSDTC tab before you close the configuration dialog boxes.

Click Start, and then click Control Panel. Alternatively, click Start, point to Settings, and then click Control Panel.

Double-click Administrative Tools.

Double-Click Component Services, expand Component Services, expand Computers, right-click My Computer and then click Properties,

Click the MSDTC tab, and then click Security Configuration.

In the Security Configuration dialog box, click to clear the Network DTC Access check box.
Note This sets the following DWORD registry entry to 0 on non-clustering environments. Clustering environments do not read the following registry key. For Clustering environments, follow the steps that are listed in the “Disable the Distributed Transaction Coordinator” bullet point.
HKLM\Software\Microsoft\MSDTC\Security\NetworkDtcAccess
Note You can also apply this setting to multiple systems by using Group Policy. For more information about Group Policy, visit the following Microsoft Web site.

Click OK, close the Component Services dialog box, and then close the Administrative Tools dialog box.


Impact of Workaround: If you disable Network DTC Access, distributed transaction could fail. This could impact other applications such as SQL Server, BizTalk Server, or Message Queuing. Therefore, we recommend this workaround only on systems that cannot install the security update.

Block the following at the firewall:

All unsolicited inbound traffic on ports greater than 1024
Any other specifically configured RPC port

These ports can be used to initiate a connection with MSDTC. Blocking them at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically-configured RPC port on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. While RPC can use UDP ports 135, 137, 138, 445, and TCP ports 135, 139, 445, and 593, the MSDTC service is not vulnerable over those ports.
Note Other protocols, such as Sequenced Packet Exchange (SPX) or NetBEUI, could be used to communicate with the MSDTC service. If you are using these protocols, you should block the appropriate ports for those protocols. For more information about IPX and SPX, visit the following Microsoft Web site.

To help protect from network-based attempts to exploit this vulnerability, use a personal firewall, such as the Internet Connection Firewall, which is included with Windows XP and with Windows Server 2003.
By default, the Internet Connection Firewall feature in Windows XP and in Windows Server 2003 helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections. (Windows Sever 2003 displays this as Network Connections)
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click the Advanced tab.
Under Windows Firewall, click Settings.
Click On, and then click OK.
Click the Exceptions tab. You may need to click Settings to display the exceptions tab.
Verify that MSDTC.exe is not in the list of firewall exceptions, and then click OK.

Note If you want to enable certain programs and services to communicate through the firewall, click Settings on the Advanced tab, and then select the programs, the protocols, and the services that are required.

To help protect from network-based attempts to exploit this vulnerability, enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPsec on the affected systems.
Use Internet Protocol security (IPsec) to help protect network communications. Detailed information about IPsec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878. RPC uses a broad range of ports, which may make it difficult to try to secure them all by using IPsec. Microsoft Knowledge Base Article 908472 documents how to restrict RPC communication to a set of fixed ports and how to secure those ports by using IPsec.


Workarounds for COM+ Vulnerability - CAN-2005-1978:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable COM+
Disabling COM+ helps protect the affected system from attempts to exploit this vulnerability. There are different ways to disable COM+, depending on which platform you are using.
Important This bulletin contains information about how to modify the registry. Make sure to back up the registry before you modify it. Make sure that you know how to restore the registry if a problem occurs. For more information about how to back up, restore, and modify the registry, see Microsoft Knowledge Base Article 256986.
Warning Serious problems might occur if you modify the registry incorrectly by using Registry Editor or by using another method. These problems might require that you reinstall your operating system. Microsoft cannot guarantee that these problems can be solved. Modify the registry at your own risk.

On Windows 2000, create a file that is named ~clbcatq.dll in the %windir%\system32 folder. These steps create a similar environment as the issue that is discussed in Microsoft Knowledge Based Article 246499. To disable COM+ on Windows 2000, follow these steps:

Logon as an administrator.

Click Start, and then click Run and then type:
echo “Workaround for KB902400” >%windir%\system32\~clbcatq.dll

Restart the system.
Note To re-enable COM+, delete the ~clbcatq.dll file and restart the system.



To disable COM+ on Windows XP and Windows Server 2003, create a registry key and restart the computer to disable COM+:
On these operating system versions you can create a registry key and restart the machine to disable COM+.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.

In Registry Editor, locate the following registry key:
HKEY_LOCAL_MACHINE\Software\Microsoft\COM3

Double-click the COM+Enabled registry entry, and then change the value to 0.
Note Make a note of the current value so that you can reverse this procedure if required.

Quit Registry Editor and restart the system.



Alternatively, you can paste the following text into a .reg file. Then, double-click the .reg file while you are logged on locally as an administrator:
Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\COM3]"Com+Enabled"=dword:00000000
Note You can also apply this setting to multiple systems by using Group Policy. For more information about Group Policy, visit the following Microsoft Web Site.




Impact of Workaround: If you disable COM+, you cannot use any COM+ dependant applications. Customers should evaluate whether any business-critical applications rely on COM+ services before they deploy these workarounds. We recommend these workaround only on systems that cannot install the security update. For information about COM+, visit the following Microsoft Web site.

Block the following at the firewall:

UDP ports 135, 137, 138, and 445, and TCP ports 135, 139, 445, and 593
If installed, COM Internet Services (CIS) or RPC over HTTP, which listen on ports 80 and 443

These ports are used to initiate a connection with RPC. Blocking them at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports that RPC uses, visit the following Web site. For more information about how to disable CIS, see Microsoft Knowledge Base Article 825819.
Note Other protocols, such as Sequenced Packet Exchange (SPX) or NetBEUI, could be used to communicate with the MSDTC service. If you are using these protocols, you should block the appropriate ports for those protocols. For more information about IPX and SPX, visit the following Microsoft Web site.

Disable DCOM
Disabling DCOM helps protect the affected system from remote attempts to exploit this vulnerability. However, the affected system could still be vulnerable to local elevation of privilege attacks that try to exploit this vulnerability. For instructions on how to disable DCOM, see Microsoft Knowledge Base Article 825750.
As an alternative to the steps that are documented In Microsoft Knowledge Base Article 825750, alternately you can paste the following text into a .reg file. Then, double-click the .reg file while you are logged on locally as an administrator:
Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole]"EnableDCOM"="N"
Note You can also apply this setting to multiple systems by using Group Policy. For more information about Group Policy, visit the following Microsoft Web Site.
Impact of Workaround: If you disable DCOM, you cannot use any DCOM dependant applications. Customers should evaluate whether any business critical applications rely on DCOM services before you deploy this workaround. There are potentially many built-in components and third-party applications that are affected if you disable DCOM. We do not recommend that you disable DCOM in your environment until you have tested to discover what applications are affected. Disabling DCOM may not be possible in all environments. Therefore, we recommend this workaround only on systems that cannot install the security update. For information about disabling DCOM, see Microsoft Knowledge Base Article 825750.


Workarounds for TIP Vulnerability - CAN-2005-1979:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the Distributed Transaction Coordinator
Disabling the Distributed Transaction Coordinator helps protect the affected system from attempts to exploit this vulnerability. To disable the Distributed Transaction Coordinator, follow these steps:

Click Start, and then click Control Panel. Alternatively, click Start, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Component Services.
Click Services.
Double-click Distributed Transaction Coordinator.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the Distributed Transaction Coordinator by using the following command at the command prompt:
sc stop MSDTC & sc config MSDTC start= disabled
Impact of Workaround: If you disable the Distributed Transaction Coordinator, you cannot use any service or application that is dependant on the Distributed Transaction Coordinator. This could include other applications such as SQL Server, BizTalk Server, Exchange Server, or Message Queuing. Also, this service is required in most clustering configurations. Therefore, we recommend this workaround only on systems that cannot install the security update.

Use the Group Policy settings to disable the Distributed Transaction Coordinator on all affected systems that do not require this feature.
Because the Distributed Transaction Coordinator is a possible attack vector, disable it by using the Group Policy settings. You can disable the startup of this service at the local, site, domain, or organizational unit level by using Group Policy object functionality in Windows 2000 domain environments or in Windows Server 2003 domain environments. For more information about how to disable this service through logon scripts, see Microsoft Knowledge Base Article 297789
Note You may also review the Windows 2000 Security Hardening Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If you disable the Distributed Transaction Coordinator, you cannot use any service or application that is dependant on the Distributed Transaction Coordinator. This could include other applications such as SQL Server, BizTalk Server, Exchange Server, or Message Queuing. Also, this service is required in most clustering configurations. Therefore, we recommend this workaround only on systems that cannot install the security update.

Block TCP port 3372 at the firewall:
This port is used to initiate a connection with TIP. Blocking it at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured TIP ports on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.

To help protect from network-based attempts to exploit this vulnerability, enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPsec on the affected systems.
Use Internet Protocol security (IPsec) to help protect network communications. Detailed information about IPsec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.


Workarounds for Distributed TIP Vulnerability - CAN-2005-1980:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the Distributed Transaction Coordinator
Disabling the Distributed Transaction Coordinator helps protect the affected system from attempts to exploit this vulnerability. To disable the Distributed Transaction Coordinator, follow these steps:

Click Start, and then click Control Panel. Alternatively, click Start, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Component Services.
Click Services.
Double-click Distributed Transaction Coordinator.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the Distributed Transaction Coordinator by using the following command at the command prompt:
sc stop MSDTC & sc config MSDTC start= disabled
Impact of Workaround: If you disable the Distributed Transaction Coordinator, you cannot use any service or application that is dependant on the Distributed Transaction Coordinator. This could include other applications such as SQL Server, BizTalk Server, Exchange Server, or Message Queuing. Also, this service is required in most clustering configurations. Therefore, we recommend this workaround only on systems that cannot install the security update.

Use the Group Policy settings to disable the Distributed Transaction Coordinator on all affected systems that do not require this feature.
Because the Distributed Transaction Coordinator is a possible attack vector, disable it by using the Group Policy settings. You can disable the startup of this service at the local, site, domain, or organizational unit level by using Group Policy object functionality in Windows 2000 domain environments or in Windows Server 2003 domain environments. For more information about how to disable this service through logon scripts, see Microsoft Knowledge Base Article 297789
Note You may also review the Windows 2000 Security Hardening Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If you disable the Distributed Transaction Coordinator, you cannot use any service or application that is dependant on the Distributed Transaction Coordinator. This could include other applications such as SQL Server, BizTalk Server, Exchange Server, or Message Queuing. Also, this service is required in most clustering configurations. Therefore, we recommend this workaround only on systems that cannot install the security update.

Block TCP port 3372 at the firewall:
This port is used to initiate a connection with TIP. Blocking it at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured TIP ports on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.

To help protect from network-based attempts to exploit this vulnerability, enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPsec on the affected systems.
Use Internet Protocol security (IPsec) to help protect network communications. Detailed information about IPsec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.


