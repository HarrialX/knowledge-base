Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-002

#### Workarounds for DSN Overflow Vulnerability - CVE-2011-0026
  
Microsoft has not identified any workarounds for this vulnerability.
  
#### Workarounds for ADO Record Memory Vulnerability - CVE-2011-0027
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Set Internet and Local intranet security zone settings to "High" to block ActiveX Controls and Active Scripting in these zones**
  
    You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to block ActiveX controls and Active Scripting. You can do this by setting your browser security to High.
  
    To raise the browsing security level in Internet Explorer, follow these steps:
  
    1.  On the Internet Explorer **Tools** menu, click **Internet Options**.  
    2.  In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.  
    3.  Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.
    
    **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.
    
    **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.
  
    **Impact of workaround.** There are side effects to blocking ActiveX Controls and Active Scripting. Many Web sites that are on the Internet or on an intranet use ActiveX or Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use ActiveX Controls to provide menus, ordering forms, or even account statements. Blocking ActiveX Controls or Active Scripting is a global setting that affects all Internet and intranet sites. If you do not want to block ActiveX Controls or Active Scripting for such sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".
  
    **Add sites that you trust to the Internet Explorer Trusted sites zone**
  
    After you set Internet Explorer to block ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect yourself from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.
  
    To do this, follow these steps:
  
    1.  In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.  
    2.  In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.  
    3.  If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.  
    4.  In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.  
    5.  Repeat these steps for each site that you want to add to the zone.  
    6.  Click **OK** two times to accept the changes and return to Internet Explorer.
    
    **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.
  
-   **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**
  
    You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:
  
    1.  In Internet Explorer, click **Internet Options** on the **Tools** menu.  
    2.  Click the **Security** tab.  
    3.  Click **Internet**, and then click **Custom Level**.  
    4.  Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.  
    5.  Click **Local intranet**, and then click **Custom Level**.  
    6.  Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.  
    7.  Click **OK** two times to return to Internet Explorer.
    
    **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.
  
    **Impact of workaround.**Â There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".
  
    **Add sites that you trust to the Internet Explorer Trusted sites zone**
  
    After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.
  
    To do this, follow these steps:
  
    1.  In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.  
    2.  In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.  
    3.  If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.  
    4.  In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.  
    5.  Repeat these steps for each site that you want to add to the zone.  
    6.  Click **OK** two times to accept the changes and return to Internet Explorer.
    
    **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.
  
-   **Disable the ActiveX Data Objects (ADO) DLL**
  
    Run the following commands from a command prompt as an administrator:
  
    **For 32-bit editions of Windows XP and Windows Server 2003:**
  
    `cacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /E /P everyone:N`
  
    **For 64-bit editions of Windows XP and Windows Server 2003:**
  
    `cacls "%ProgramFiles(86)%\Common Files\System\ado\msado15.dll" /E /P everyone:Ncacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /E /P everyone:N`
  
    **For 32- bit editions of Windows Vista, Windows Server 2008, and Windows 7:**
  
    ```
    takeown /f "%ProgramFiles%\Common Files\System\ado\msado15.dll"
    icacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /save %TEMP%\MSADO15_ACL.TXT
    icacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /deny everyone(F)
    ```
  
    **For 64-bit editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2:**
  
    ```
    takeown /f "%ProgramFiles(86)%\Common Files\System\ado\msado15.dll"
    icacls "%ProgramFiles(86)%\Common Files\System\ado\msado15.dll" /save %TEMP%\MSADO15_ACL.TXT
    icacls "%ProgramFiles(86)%\Common Files\System\ado\msado15.dll" /deny everyone (F)
takeown /f "%ProgramFiles%\Common Files\System\ado\msado15.dll"
icacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /save %TEMP%\MSADO15_ACL64.TXT
icacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /deny everyone(F)
```

**Impact of workaround.** Disabling the ActiveX Data Objects (ADO) DLL will break MDAC functionality.

**How to undo the workaround:**

Run the following commands from a command prompt as an administrator:

For 32-bit editions of Windows XP and Windows Server 2003:

`cacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /E /R everyone`

For 64-bit editions of Windows XP and Windows Server 2003:

```
cacls "%ProgramFiles(86)%\Common Files\System\ado\msado15.dll" /E /R everyone

cacls "%ProgramFiles%\Common Files\System\ado\msado15.dll" /E /R everyone
```

For 32-bit editions of Windows Vista, Windows Server 2008, and Windows 7:

`icacls "%ProgramFiles(86)%\Common Files\System\ado\" /restore %TEMP%\MSADO15_ACL.TXT`

For 64-bit editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2:

```
icacls "%ProgramFiles(86)%\Common Files\System\ado\" /restore %TEMP%\MSADO15_ACL.TXT

icacls "%ProgramFiles%\Common Files\System\ado\" /restore %TEMP%\MSADO15_ACL64.TXT
```

