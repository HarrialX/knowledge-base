Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-026

Workarounds for Outlook Web Access Script Injection Vulnerability - CVE-2007-0220:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable Outlook Web Access (OWA) on a computer running Exchange Server.
Disabling Outlook Web Access helps protect the affected system from attempts to exploit this vulnerability. To disable Outlook Web Access, follow these steps:

Click Start, point to All Programs, point to Microsoft Exchange, and then click System Manager.
Expand Servers, expand Server, expand Protocols, and then expand HTTP.
Right-click Exchange Virtual Server, and then click Stop.

Note A red cross will appear over the Exchange Virtual Server icon, indicating it has been stopped. From now on, users will      see a The Page Cannot Be Displayed error message when they try to access their e-mail through OWA.
Impact of workaround: This workaround prevents users from accessing their mailboxes through Outlook Web Access (OWA),           Outlook Mobile Access (OMA) and Exchange Server ActiveSync.

Block HTML Attachment as Level2 Type in Outlook Web Access (OWA).
Set Outlook Web Access to save HTML attachments locally before they are opened. This enables Internet Explorer to check for active content and warn the user before opening the attachment.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk.
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeWEB\OWA
Update "Level2MIMETypes" to include ”text/html”
Update “Level2FileTypes” to include ”htm,html”
You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:
Group Policy collection
What is Group Policy Object Editor?
Core Group Policy tools and settings


Note You must restart Internet Explorer for your changes to take effect.
Impact of workaround: The Outlook Web Access client has to save the HTML attachment locally before it could be opened.

Block HTML Attachment as Level1 Type in Outlook Web Access (OWA).
Set Outlook Web Access to block the ability to save HTML attachments locally.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk.
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeWEB\OWA
Update "Level1MIMETypes" to include ”text/html”
Update “Level1FileTypes” to include ”htm,html”
You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:
Group Policy collection
What is Group Policy Object Editor?
Core Group Policy tools and settings


Note You must restart Internet Explorer for your changes to take effect.
Impact of workaround: The Outlook Web Access client will not be able to retrieve HTML attachment. Access is totally blocked.
Workarounds for Malformed iCal Vulnerability - CVE-2007-0039:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Require authentication for connections to a server that is running Microsoft Exchange Server for all client and message transport protocols
Requiring authentication for all connections made to the Exchange Server computer will help protect against anonymous attacks. This will not protect against an attack from a user who can successfully authenticate.
Impact of workaround: Anonymous communication from clients through IMAP, POP3, HTTP, LDAP, SMTP, and NNTP will no longer be possible. Server to server anonymous communication through RPC, X.400, foreign gateway, and third-party connector protocols will also no longer be possible. In default configurations of Exchange Server, authenticated access is required for all protocols except SMTP. If all text/calendar MIME type message parts and the meeting.ics file are blocked, anonymous SMTP connections could still be accepted.

Block iCal on Microsoft Exchange Server to help protect against attempts to exploit this vulnerability through SMTP e-mail
Systems can be configured to block certain types of files from being received as e-mail attachments. Meeting requests, typically used in Outlook, contain a file attachment that stores the meeting information. This file attachment is usually named meeting.ics. Blocking this file, and blocking the calendar MIME type, could help protect Exchange Servers and other affected programs from attempts to exploit this vulnerability if customers cannot install the available security update. To help protect an Exchange Server computer from attacks through SMTP, block the .ics files and all text/calendar MIME type content before it reaches the Exchange Server computer.
Note Exchange supports other messaging protocols, such as X.400, that these workarounds do not protect. We recommend that administrators require authentication on all other client and message transport protocols to help prevent attacks using these protocols.
Note Filtering only for attachments that have the file name meeting.ics may not be sufficient to help protect your system. A specially crafted file attachment could be given another file name that could then be processed by the Exchange Server computer. To help protect against specially crafted e-mail messages, block all text/calendar MIME type content.
There are many ways to block the meeting.ics file and other calendar content. Here are some suggestions:

You can use ISA Server 2000 SMTP Message Screener to block all file attachments or to block only the meeting.ics file. Blocking all file attachments provides the most protection for this issue if you use ISA Server 2000 because ISA Server 2000 does not support blocking content based on MIME content types. For more information, see Microsoft Knowledge Base Article 315132.
You can use ISA Server 2000 SMTP Filter to block all file attachments or to block only the meeting.ics file. Blocking all file attachments provides the most protection for this issue if you use ISA Server 2000 because ISA Server 2000 does not support blocking content based on MIME content types. For more information, see Microsoft Knowledge Base Article 320703.
You can use ISA Server 2004 SMTP Filter and Message Screener block all file attachments or just the meeting.ics file. Blocking all file attachments provides the most protection for this issue if you use ISA Server 2004 because ISA Server 2004 does not support blocking content based on MIME content types. For more information, see Microsoft Knowledge Base Article 888709.
You can use third-party e-mail filters to block all text/calendar MIME type content before it is sent to the Exchange Server computer or to a vulnerable application.

Impact of workaround: If calendar attachments are blocked, meeting requests will not be received correctly. In some cases, users could receive blank e-mail messages instead of the original meeting request. In other cases, users may not receive meeting requests at all. Perform this workaround only if you cannot install the available security update or if a security update is not publicly available for your configuration.


Workarounds for MIME Decoding Vulnerability - CVE-2007-0213:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they will help to block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Require authentication for connections to a server that is running Microsoft Exchange Server for all client and message transport protocols.
Requiring authentication for all connections made to the Exchange Server computer will help protect against anonymous attacks. This will not protect against an attack from a malicious user who can successfully authenticate.
Impact of workaround: Anonymous communication from clients through IMAP, POP3, HTTP, LDAP, SMTP, and NNTP will no longer be possible. Server to server anonymous communication through RPC, X.400, foreign gateway, and third-party connector protocols will also no longer be possible. In default configurations of Exchange Server, authenticated access is required for all protocols except SMTP. If all text/calendar MIME type message parts and the meeting.ics file are blocked, anonymous SMTP connections could still be accepted.


Workarounds for IMAP Literal Processing Vulnerability - CVE-2007-0221:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Block the following at the firewall:

TCP port 143

This port is used to initiate a connection with IMAP. Blocking it at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability.

Disable the IMAP service
Disabling the IMAP service will help protect the affected system from attempts to exploit this vulnerability. To disable the IMAP service, follow these steps:

Click Start, and then click Control Panel. Alternatively, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Services.
Double-click IMAP4.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the IMAP service by using the following command at the command prompt:
sc stop IMAP4svcsc config IMAP4svc start= disabled
Impact of workaround: If you disable the IMAP service, you turn off IMAP functionality for IMAP clients.

Stop the IMAP virtual server
Stopping the IMAP virtual server will help protect the affected system from attempts to exploit this vulnerability. To stop the IMAP virtual server, follow these steps:

Click Start, point to All Programs, point to Microsoft Exchange, and then click System Manager.
Expand Servers, expand Server, expand Protocols, and then expand IMAP4.
Right-click IMAP4 Virtual Server and then click Stop.

Impact of workaround: If you disable the IMAP virtual server, you turn off IMAP functionality for IMAP clients.


