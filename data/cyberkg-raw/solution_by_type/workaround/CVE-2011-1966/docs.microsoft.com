Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-058

#### Workarounds for DNS NAPTR Query Vulnerability - CVE-2011-1966
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Disable the DNS service if you are not using it**
  
    **Interactive method:**
  
    1.  Click **Start**, click **Run**, type **regedit**, and then click **OK**.  
    2.  Expand **HKEY\_LOCAL\_MACHINE**, Expand **System**, expand **CurrentControlSet**, and then expand **Services**.  
    3.  Click **DNS**.  
    4.  Click the **File** menu and then select **Export**.  
    5.  In the Export Registry File dialog, type **DNS\_configuration\_backup.reg**, and then click **Save**.  
    6.  Double-click the value named **Start** and then change the **Value** data field to **4**.  
    7.  Click **OK**.  
    8.  Run the following command at a command prompt running as an administrator:  
        `sc stop DNS`
  
    **Using a managed deployment script:**
  
    1.  Back up the registry keys from a managed deployment script using the following command:  
        `regedit /e DNS_configuration_backup.reg HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\DNS`  
    2.  Save the following text to a file with a .REG extension (e.g., "Disable\_service\_DNSame.reg").  
        ```
        Windows Registry Editor Version 5.00  
        [HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\DNS]  
        "Start"=dword:00000004
         ```  
    3.  Run the registry script created in step 2 above on the target machine using the following command:  
        `Regedit /s Disable_service_DNSame.reg`  
    4.  Run the following command at a command prompt running as an administrator:  
        `sc stop DNS`
  
    **How to undo the workaround.**
  
    **Interactive method:**
  
    1.  Click **Start**, click **Run**, type **regedit**, and then click **OK**.  
    2.  Click the **File** menu and then select **Import**.  
    3.  In the Import Registry File window, select **DNS\_configuration\_backup.reg**, and then click **Open**.
  
    **Using a managed deployment script:**
  
    Restore the registry to its original state by running the following command at a command prompt running as an administrator:  
    `Regedit`` /s DNS_configuration_backup.reg`
  
#### Workarounds for DNS Uninitialized Memory Corruption Vulnerability - CVE-2011-1970
  
Microsoft has not identified any workarounds for this vulnerability.
  
