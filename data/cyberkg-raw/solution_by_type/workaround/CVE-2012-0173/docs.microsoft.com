Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-036

Workarounds for Remote Desktop Protocol Vulnerability - CVE-2012-0173
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable Terminal Services, Remote Desktop, Remote Assistance, and Windows Small Business Server 2003 Remote Web Workplace feature if no longer required
If you no longer need these services on your system, consider disabling them as a security best practice. Disabling unused and unneeded services helps reduce your exposure to security vulnerabilities.
For information about how to disable Remote Desktop manually, see To disable Remote Desktop.
For information about how to disable Remote Desktop by using Group Policy, see Microsoft Knowledge Base Article 306300.
For information about Remote Assistance, including instructions on how to disable Remote Assistance manually and by using Group Policy, see the TechNet article, Remote Assistance.
For information about how to disable the Windows Small Business Server 2003 Terminal Services and Remote Web Workplace features, see the TechNet article, Securing Your Windows Small Business Server 2003 Network.
 

Block TCP port 3389 at the enterprise perimeter firewall
TCP port 3389 is used to initiate a connection with the affected component. Blocking this port at the network perimeter firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. This can help protect networks from attacks that originate outside the enterprise perimeter. Blocking the affected ports at the enterprise perimeter is the best defense to help avoid Internet-based attacks. However, systems could still be vulnerable to attacks from within their enterprise perimeter.
Additionally, on Windows XP and Windows Server 2003, the Windows Firewall can help protect individual systems. By default, the Windows Firewall does not allow connections to this port, except in Windows XP Service Pack 2 when the Remote Desktop feature is enabled. For information about how to disable the Windows Firewall exception for Remote Desktop on these platforms, see the TechNet article, Enable or Disable the Remote Desktop Firewall Rule. If you cannot disable the Windows Firewall exception for Remote Desktop, you may be able to reduce the scope of this vulnerability by setting the default value of all computers (including those on the Internet), to the local network. Doing this helps reduce the likelihood of attacks from the Internet.
Note Windows Small Business Server 2003 uses a feature named Remote Web Workplace. This feature uses TCP port 4125 to listen for RDP connections. If you are using this feature, you should validate that this port is also blocked from the Internet in addition to port 3389.
Note It is possible to manually change the affected components to use other ports. If you have performed these actions, you should also block those additional ports.
 

Enable Network Level Authentication on systems running supported editions of Windows Vista, Windows 7, Windows Server 2008, and Windows Server 2008 R2
Note See Microsoft Knowledge Base Article 2685939 to use the automated Microsoft Fix it solution to enable this workaround.
You can enable Network Level Authentication to block unauthenticated attackers from exploiting this vulnerability. With Network Level Authentication turned on, an attacker would first need to authenticate to Remote Desktop Services using a valid account on the target system before the attacker could exploit the vulnerability.
In order to use Network Level Authentication, your environment must meet the following requirements:

The client computer must be using at least Remote Desktop Connection 6.0.
The client computer must be using an operating system, such as Windows 7 or Windows Vista that supports the Credential Security Support Provider (CredSSP) protocol.
The RD Session Host server must be running Windows Server 2008 R2 or Windows Server 2008.

To configure Network Level Authentication for a connection, perform the following steps:

On the RD Session Host server, open Remote Desktop Session Host Configuration. To open Remote Desktop Session Host Configuration, click Start, point to AdministrativeTools, point to Remote Desktop Services, and then click Remote Desktop Session Host Configuration.
Under Connections, right-click the name of the connection, and then click Properties.
On the General tab, select the Allow connections only from computers running Remote Desktop with Network Level Authentication check box.
If the Allow connections only from computers running Remote Desktop with Network Level Authentication check box is selected and is not enabled, the Require user authentication for remote connections by using Network Level Authentication Group Policy setting has been enabled and has been applied to the RD Session Host server.
Click OK.

Impact of workaround. Client computers that do not support Credential Security Support Provider (CredSSP) protocol will not be able to access servers protected with Network Level Authentication. Note For administrators deploying this workaround in a mixed network environment where Windows XP Service Pack 3 systems need to use Remote Desktop, see Microsoft Knowledge Base Article 951608 for information on how to enable CredSSP in Windows XP Service Pack 3.
For more information regarding Network Level Authentication, including how to enable Network Level Authentication using Group Policy, see the Technet article, Configure Network Level Authentication for Remote Desktop Services Connections.


