Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-011

Workarounds for LSASS Vulnerability - CAN-2003-0533:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Create a file called %systemroot%\debug\dcpromo.log and make the file read-only. To do this, type the following command:
echo dcpromo >%systemroot%\debug\dcpromo.log & attrib +r %systemroot%\debug\dcpromo.log
Note This is the most effective mitigation technique as it completely mitigates this vulnerability by causing the vulnerable code to never be executed. This work-around will work for packets sent to any vulnerable port.

Use a personal firewall such as the Internet Connection Firewall, which is included with Windows XP and Windows Server 2003.
If you use the Internet Connection Firewall feature in Windows XP or in Windows Server 2003 to help protect your Internet connection, it blocks unsolicited inbound traffic by default. Microsoft recommends blocking all unsolicited inbound communication from the Internet.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections.
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click the Advanced tab.
Click to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.

Note If you want to enable the use of some programs and services through the firewall, click Settings on the Advanced tab, and then select the programs, protocols, and services needed.

Block the following at the firewall:

UDP ports 135, 137, 138, and 445, and TCP ports 135, 139, 445, and 593
All unsolicited inbound traffic on ports greater than 1024
Any other specifically configured RPC port

These ports are used to initiate a connection with RPC. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports that RPC uses, visit the following Web site.

Enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

Block the affected ports by using IPSec on the affected systems.
Use Internet Protocol Security (IPSec) to help protect network communications. Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Articles 313190 and 813878.


Workarounds for LDAP Vulnerability - CAN-2003-0663:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block LDAP TCP ports 389, 636, 3268, and 3269 at your firewall.
These ports are used to initiate an LDAP connection with a Windows 2000 domain controller. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability that originate outside the enterprise perimeter. While other ports could be used to exploit this vulnerability, the ports listed are the most common attack vectors. Microsoft recommends blocking all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.
Impact of workaround: Active Directory domain authentication will not be possible over a network connection where these ports are blocked.


Workarounds for PCT Vulnerability - CAN-2003-0719:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Disable PCT support through the registry
This workaround is fully documented in Microsoft Knowledge Base Article 187498. This article is summarized below.
The following steps demonstrate how to disable the PCT 1.0 protocol that prevents the affected system from negotiating its use.
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk.
For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note It is a good idea to back up the registry before you edit it.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.

In Registry Editor, locate the following registry key:
HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\PCT 1.0\Server

In the Edit menu, click Add Value to create a new REG_DWORD value called "Enabled" in the Server subkey.

In the Data Type list, click REG_DWORD.

In the Value Name text box, type "Enabled" (without the quotation marks), and then click OK.
Note If this value is already present, double-click on the value to edit its current value, and then go to step 6.

In the Binary Editor, set the new keys value to equal 0 by typing the following string: 00000000.

Click OK, and then restart the system.
Note To enable PCT, change the value of the Enabled registry key to 00000001, and then restart the system.
Note If you are using Windows XP RTM you must also create a second registry key to fully disable PCT. This is not required on later versions of Windows XP or other affected operating systems. Use the instructions provided earlier and create a second REG_DWORD value named “Client”. Use the same values as documented earlier.




Workarounds for Winlogon Vulnerability - CAN-2003-0806:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Reduce the number of users that have account modification permissions.
To exploit this vulnerability an attacker requires the ability to modify user objects in the domain. Some organizations add user accounts to the Administrators or Account Operators groups unnecessarily. For example, if a Helpdesk representative only requires the ability to reset user passwords, the administrator should directly delegate that permission without adding the representative to the Account Operator group. Reducing the number of user accounts in administrative groups helps block known attack vectors. Only trusted employees should be members of administrative groups. For more information about domain best practices, visit the following Web site.


Workarounds for Metafile Vulnerability - CAN-2003-0906:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Read e-mail messages in plain text format if you are using Outlook 2002 or later, or Outlook Express 6 SP1 or later, to help protect yourself from the HTML e-mail attack vector.
Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or later and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 can enable this setting and view all non-digitally signed e-mail messages or non-encrypted e-mail messages in plain text only.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about enabling this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
For information about this setting in Outlook Express 6, see Microsoft Knowledge Base Article 291387.
Impact of Workaround: E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. In addition:

The changes are applied to the preview pane and open messages.
Pictures become attachments so they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.



Workarounds for Help and Support Center Vulnerability - CAN-2003-0907:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Unregister the HCP Protocol.
To help prevent an attack, unregister the HCP Protocol by deleting the following key from the registry: HKEY_CLASSES_ROOT\HCP. To do so, follow these steps:

Click Start, and then click Run.

Type regedit, and then click OK.
The registry editor program launches.

Expand HKEY_CLASSES_ROOT, and then highlight the HCP key.

Right-click on the HCP key, and then click Delete.


Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall Windows. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk.
Impact of Workaround: Unregistering the HCP protocol will break all local, legitimate help links that use hcp://. For example, links in Control Panel may no longer work.

Install Outlook E-mail Security Update if you are using Outlook 2000 SP1 or earlier.
By default, Outlook Express 6, Outlook 2002 and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 98 and Outlook 2000 open HTML e-mail messages in the Restricted sites zone if the Outlook E-mail Security Update has been installed.
Customers who use any of these products could be at a reduced risk from an e-mail-borne attack that tries to exploit this vulnerability unless the user clicks a malicious link in the e-mail message.

Read e-mail messages in plain text format if you are using Outlook 2002 or later, or Outlook Express 6 SP1 or later, to help protect yourself from the HTML e-mail attack vector.
Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or later and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 can enable this setting and view all non-digitally signed e-mail messages or non-encrypted e-mail messages in plain text only.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about enabling this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
For information about this setting in Outlook Express 6, see Microsoft Knowledge Base Article 291387.
Impact of Workaround: E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. In addition:

The changes are applied to the preview pane and open messages.
Pictures become attachments so they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.



Workarounds for Utility Manager Vulnerability - CAN-2003-0908:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Use Group Policies to disable the Utility Manager on all affected systems that do not require this feature.
Because the Utility Manager is a possible attack vector, disable it using Group Policies. The Utility Manager process name is Utilman.exe. The following guide provides information about how to require users to run only approved applications using Group Policies.
Note You may also review the Windows 2000 Hardening Guide. This guide includes information about how to disable the Utility Manager.
Impact of Workaround:
The Utility Manager provides easy access to many of the accessibility features of the operating system. This access would be unavailable until the restrictions are removed. To find information about how to manually start many of the accessibility features, visit this Web site.


Workarounds for Windows Management Vulnerability - CAN-2003-0909:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.
Delete the affected Windows Management Interface Provider.
An administrator with local administrative permissions can delete the affected Windows Management Interface (WMI) Provider by inserting the following script into a text file that has a ‘.vbs’ file name extension and then running it.
To delete the affected WMI Provider:
set osvc = getobject("winmgmts:root\cimv2")set otrigger = osvc.get("__win32provider='cmdtriggerconsumer'")otrigger.delete_
The installation of the update automatically re-registers the affected WMI Provider that is referenced above. You do not have to take any additional steps to restore the system to typical functionality after the update has been applied.
Impact of Workaround: Tasks that are created as event-based triggers will not function while this provider is not registered. For more information about event-based triggers, visit the following Web site.
Note In rare cases, Windows XP could re-register this WMI Provider. For example, if Windows XP detects that the WMI repository has become corrupted, it could try to re-register the affected WMI Provider.
Workarounds for Local Descriptor Table Vulnerability - CAN-2003-0910:
None.
Workarounds for H.323 Vulnerability - CAN-2004-0117:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block ports TCP 1720 and TCP 1503 both inbound and outbound at the firewall.
Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. Microsoft recommends blocking all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.
Impact of Workaround:
If inbound and outbound TCP ports 1503 and 1720 are blocked, users will not be able to connect to the Internet Locator Service (ILS) or to other NetMeeting clients.


Workarounds for Virtual DOS Machine Vulnerability - CAN-2004-0118:
None.
Workarounds for Negotiate SSP Vulnerability - CAN-2004-0119:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Workarounds for the Internet Information Services Attack Vector

Disable Integrated Windows Authentication
Administrators can help reduce the risk of attack through Internet Information Services by disabling Integrated Windows Authentication. Information about how to enable or disable this option is available at the following Web site.
Impact of Workaround: Any IIS-based applications that require Windows NT Challenge/Response authentication (NTLM) or Kerberos authentication will no longer function correctly.

Disable the Negotiate SSP
Administrators can disable just the Negotiate SSP (which keeps NTLM enabled) by following the instructions in Microsoft Knowledge Base Article 215383, which is summarized below:
To disable Negotiate (and therefore prevent Kerberos authentication), use the following command . Notice that “NTLM” must be uppercase to avoid any adverse effects):
cscript adsutil.vbs set w3svc/NTAuthenticationProviders “NTLM”
Impact of Workaround: Any IIS-based applications that require Kerberos authentication will no longer function correctly.




Workarounds for SSL Vulnerability - CAN-2004-0120:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block ports 443 and 636 at the firewall
Port 443 is used to receive SSL traffic. Port 636 is used for LDAP SSL connections (LDAPS). Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Other ports may be found that could be used to exploit this vulnerability. However, the ports listed here are the most common attack vectors. Microsoft recommends blocking all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.
Impact of Workaround: If ports 443 or 636 are blocked, the affected systems can no longer accept external connections using SSL or LDAPS.


Workarounds for ASN.1 “Double Free” Vulnerability - CAN-2004-0123:
None.
