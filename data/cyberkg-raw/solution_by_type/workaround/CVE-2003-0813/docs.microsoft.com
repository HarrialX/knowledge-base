Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-012

Workarounds for RPC Runtime Library Vulnerability - CAN-2003-0813:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Use a personal firewall such as the Internet Connection Firewall, which is included with Windows XP and Windows Server 2003.
If you use the Internet Connection Firewall feature in Windows XP or in Windows Server 2003 to help protect your Internet connection, it blocks unsolicited inbound traffic by default. Microsoft recommends blocking all unsolicited inbound communication from the Internet.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections.
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click the Advanced tab.
Click to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.

Note If you want to enable the use of some programs and services through the firewall, click Settings on the Advanced tab, and then select the programs, protocols, and services needed.

Block the following at the firewall:

UDP ports 135, 137, 138, and 445, and TCP ports 135, 139, 445, and 593
All unsolicited inbound traffic on ports greater than 1024
Any other specifically configured RPC port
If installed, COM Internet Services (CIS) or RPC over HTTP, which listen on ports 80 and 443

These ports are used to initiate a connection with RPC. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports that RPC uses, visit the following Web site. For more information about how to disable CIS, see Microsoft Knowledge Base Article 825819.

Enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For additional information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

Block the affected ports by using IPSec on the affected systems.
Use Internet Protocol Security (IPSec) to help protect network communications. Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Articles 313190 and 813878.


Workarounds for the COM Internet Services (CIS) and RPC over HTTP Vulnerability - CAN-2003-0807:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.
The workarounds that are listed for the RPC Runtime Library Vulnerability- CAN-2003-0813 could also apply to this vulnerability. Additionally, the following workarounds apply:

Disable forwarding to untrusted sources for CIS and for RPC over HTTP if they have been enabled manually on the affected systems.

If an administrator has installed and has enabled forwarding to untrusted servers through CIS for Windows NT 4.0 or for Windows 2000, verify that CIS and RPC over HTTP are configured to permit forwarding only to trusted servers.

If an administrator has configured RPC over HTTP on Windows Server 2003, verify that RPC over HTTP is not running in IIS 5 compatibility mode. The default mode, IIS 6.0, does not contain the vulnerability. Therefore, the default mode is the preferred configuration. For more information about deployment recommendations and configuration settings, visit the following MSDN Library Web site.
Note Microsoft also recommends that administrators disable forwarding to DCOM. For more information, see Microsoft Knowledge Base Article 826382.



If you do not need CIS or RPC over HTTP, disable this functionality on the affected systems.

For information about how to disable CIS, see Microsoft Knowledge Base Article 825819.
For information about RPC over HTTP, visit the following MSDN Library Web site.



Workarounds for the Object Identity Vulnerability - CAN-2004-0124:
The workarounds that are listed for the RPC Runtime Library Vulnerability- CAN-2003-0813 could also apply to this vulnerability.
