Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-044

Workarounds for Remote Desktop Connection Heap Overflow Vulnerability - CVE-2009-1133
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict access to mstscax.dll
Note You must be an administrator to use these commands.
Windows XP and Windows Server 2003
Run the following commands from a command prompt:
cacls %windir%\system32\mstscax.dll /E /P everyone:N
cacls %windir%\sysWOW64\mstscax.dll /E /P everyone:N
Windows Vista and Windows Server 2008
Run the following commands from an elevated command prompt:
takeown /F %windir%\system32\mstscax.dll
cacls %windir%\system32\mstscax.dll /E /P everyone:N
takeown /F %windir%\SysWOW64\mstscax.dll
cacls %windir%\SysWOW64\mstscax.dll /E /P everyone:N
for /F "tokens=*" %G IN ('dir /b /s %windir%\winsxs\mstscax.dll') DO takeown /F %G && cacls %G /E /P everyone:N
**Impact of workaround.**After performing these steps, you will not be able to make outbound Remote Desktop connections.
How to undo the workaround
Note You must be an administrator to use these commands.
Windows XP and Windows Server 2003
Run the following commands from a command prompt:
cacls %windir%\system32\mstscax.dll /E /R everyone
cacls %windir%\SysWOW64\mstscax.dll /E /R everyone
Windows Vista and Windows Server 2008
Run the following commands from an elevated command prompt:
cacls %windir%\system32\mstscax.dll /E /R everyone
cacls %windir%\SysWOW64\mstscax.dll /E /R everyone
for /F "tokens=*" %G IN ('dir /b /s %windir%\winsxs\mstscax.dll') DO cacls %G /E /R everyone

Prevent the Remote Desktop Connection ActiveX control from running in Internet Explorer
You can disable attempts to instantiate a COM object in Internet Explorer by setting the kill bit for the control in the registry.
Note This workaround prevents exploitation through the Web-based attack vector, but it does not protect the user against manually initiating a connection to a malicious RDP server.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.
For detailed steps that you can use to prevent an ActiveX control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797.
Follow these steps to create a Compatibility Flags value in the registry to prevent a COM object from being instantiated in Internet Explorer.

Create a text file named Disable_Remote_Desktop_ActiveX.reg with the following contents:
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{7390f3d8-0439-4c05-91e3-cf5cb290c3d0}]
"Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{7390f3d8-0439-4c05-91e3-cf5cb290c3d0}]"Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{4EB89FF4-7F78-4A0F-8B8D-2BF02E94E4B2}] "Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{4EB89FF4-7F78-4A0F-8B8D-2BF02E94E4B2}]"Compatibility Flags"=dword:00000400
Apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy.

For more information about Group Policy, visit the following Microsoft Web sites:
Group Policy collection
What is Group Policy Object Editor?
Core Group Policy Tools and Settings
Note You must restart Internet Explorer for your changes to take effect.
Impact of workaround. Users will not be able to start remote desktop connections from within Web pages.
How to undo the workaround. Delete the registry keys previously added in implementing this workaround.


Workarounds for Remote Desktop Connection ActiveX Control Heap Overflow Vulnerability - CVE-2009-1929
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Prevent the Remote Desktop Connection ActiveX control from running in Internet Explorer
You can disable attempts to instantiate a COM object in Internet Explorer by setting the kill bit for the control in the registry.
Note This workaround prevents exploitation through the Web-based attack vector, but it does not protect the user against manually initiating a connection to a malicious RDP server.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.
For detailed steps that you can use to prevent an ActiveX control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797.
Follow these steps to create a Compatibility Flags value in the registry to prevent a COM object from being instantiated in Internet Explorer.

Create a text file named Disable_Remote_Desktop_ActiveX.reg with the following contents:
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{7390f3d8-0439-4c05-91e3-cf5cb290c3d0}]
"Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{7390f3d8-0439-4c05-91e3-cf5cb290c3d0}]"Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{4EB89FF4-7F78-4A0F-8B8D-2BF02E94E4B2}] "Compatibility Flags"=dword:00000400
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{4EB89FF4-7F78-4A0F-8B8D-2BF02E94E4B2}]"Compatibility Flags"=dword:00000400
Apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy.

For more information about Group Policy, visit the following Microsoft Web sites:
Group Policy collection
What is Group Policy Object Editor?
Core Group Policy Tools and Settings
Note You must restart Internet Explorer for your changes to take effect.
Impact of workaround. Users will not be able to start remote desktop connections from within Web pages.
How to undo the workaround. Delete the registry keys previously added in implementing this workaround.

Set Internet and Local intranet security zone settings to "High" to prompt before running ActiveX Controls and Active Scripting in these zones
You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.
To raise the browsing security level in Internet Explorer, follow these steps:

On the Internet Explorer Tools menu, click Internet Options.
In the Internet Options dialog box, click the Security tab, and then click the Internet icon.
Under Security level for this zone, move the slider to High. This sets the security level for all Web sites you visit to High.

Note If no slider is visible, click Default Level, and then move the slider to High.
Note Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.
Impact of workaround. There are side effects to prompting before running ActiveX Controls and Active Scripting. Many Web sites that are on the Internet or on an intranet use ActiveX or Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use ActiveX Controls to provide menus, ordering forms, or even account statements. Prompting before running ActiveX Controls or Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click Yes to run ActiveX Controls or Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".
Add sites that you trust to the Internet Explorer Trusted sites zone
After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.
To do this, follow these steps:

In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.
In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.
If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.
In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.
Repeat these steps for each site that you want to add to the zone.
Click OK two times to accept the changes and return to Internet Explorer.

Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.


