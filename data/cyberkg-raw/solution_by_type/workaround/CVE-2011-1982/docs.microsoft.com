Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-073

Workarounds for Office Component Insecure Library Loading Vulnerability - CVE-2011-1980
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2003 and Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.







Microsoft Office Software
Registry Script


Microsoft Word 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001


Microsoft Excel 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001


Microsoft PowerPoint 2003
Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
"BinaryFiles"=dword:00000001


Microsoft Word 2007
Windows Registry Editor Version 5.00



    [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

    "BinaryFiles"=dword:00000001



Microsoft Excel 2007
Windows Registry Editor Version 5.00

    [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

    "BinaryFiles"=dword:00000001



Microsoft PowerPoint 2007
Windows Registry Editor Version 5.00

    [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock]

    "BinaryFiles"=dword:00000001




**Impact of workaround.** For Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For more information about the impact of file block setting in Microsoft Office software, see [Microsoft Knowledge Base Article 922850](http://support.microsoft.com/kb/922850).

**How to undo the workaround.**

For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:

<table style="border:1px solid black;">    
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Microsoft Office Software</td>
<td style="border:1px solid black;">Registry Script</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Microsoft Word 2003</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]
&quot;BinaryFiles&quot;=dword:00000000</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Microsoft Excel 2003</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]
&quot;BinaryFiles&quot;=dword:00000000</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Microsoft PowerPoint 2003</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00
[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]
&quot;BinaryFiles&quot;=dword:00000000</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Microsoft Word 2007</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]<br />
<br />
&quot;BinaryFiles&quot;=dword:00000000<br />
</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Microsoft Excel 2007</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]<br />
<br />
&quot;BinaryFiles&quot;=dword:00000000<br />
</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Microsoft PowerPoint 2007</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00<br />
<br />
[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock]<br />
<br />
&quot;BinaryFiles&quot;=dword:00000000 <br />
</td>
</tr>
</tbody>
</table>


Disable loading of libraries from WebDAV and remote network shares
Note See Microsoft Knowledge Base Article 2264107 to deploy a workaround tool that allows customers to disable the loading of libraries from remote network or WebDAV shares. This tool can be configured to disallow insecure loading on a per-application or a global system basis.
Customers who are informed by their vendor of an application being vulnerable can use this tool to help protect against attempts to exploit this issue.
Note See Microsoft Knowledge Base Article 2264107 to use the automated Microsoft Fix it solution to deploy the registry key to block loading of libraries for SMB and WebDAV shares. Note that this Fix it solution does require you to install the workaround tool also described in Microsoft Knowledge Base Article 2264107 first. This Fix it solution only deploys the registry key and requires the workaround tool in order to be effective. We recommend that administrators review the KB article closely prior to deploying this Fix it solution.

Disable the WebClient service
Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet.
To disable the WebClient Service, follow these steps:

Click Start, click Run, type Services.msc and then click OK.
Right-click WebClient service and select Properties.
Change the Startup type to Disabled. If the service is running, click Stop.
Click OK and exit the management application.

Impact of workaround. When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the Web Client service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer.
How to undo the workaround.
To re-enable the WebClient Service, follow these steps:

Click Start, click Run, type Services.msc and then click OK.
Right-click WebClient service and select Properties.
Change the Startup type to Automatic. If the service is not running, click Start.
Click OK and exit the management application.


Block TCP ports 139 and 445 at the firewall
These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, TCP and UDP Port Assignments.
Impact of workaround. Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:

Applications that use SMB (CIFS)
Applications that use mailslots or named pipes (RPC over SMB)
Server (File and Print Sharing)
Group Policy
Net Logon
Distributed File System (DFS)
Terminal Server Licensing
Print Spooler
Computer Browser
Remote Procedure Call Locator
Fax Service
Indexing Service
Performance Logs and Alerts
Systems Management Server
License Logging Service

How to undo the workaround. Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see TCP and UDP Port Assignments.


Workarounds for Office Uninitialized Object Pointer Vulnerability - CVE-2011-1982
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.



Microsoft Office Software
Registry Script


Microsoft Office 2007
Windows Registry Editor Version 5.00



    [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

    "BinaryFiles"=dword:00000001




 
    **For Microsoft Office 2010** 
Open Microsoft Word 2010 and perform the following steps:

1.  Click the **File** tab.
2.  Under **Help**, click **Options**.
3.  Click **Trust Center**, and then click **Trust Center Settings**.
4.  In the Trust Center, click **File Block Settings**.
5.  Ensure the **Open** check box is selected for the following file types:
In Microsoft Word 2010:
- Word 2003 Binary Documents and Templates
- Word XP Binary Documents and Templates
- Word 2000 Binary Documents and Templates
- Word 97 Binary Documents and Templates
- Word 95 Binary Documents and Templates
- Word 6.0 Binary Documents and Templates
- Word 2 and earlier Binary Documents and Templates
6.  Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
7.  Click **OK** to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, [Plan file block settings for Office 2010](http://technet.microsoft.com/en-us/library/cc179230.aspx).

**Impact of workaround.** For Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see [Microsoft Knowledge Base Article 922850](http://support.microsoft.com/kb/922850).

**How to undo the workaround.**

For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:

<table style="border:1px solid black;">
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Microsoft Office Software</td>
<td style="border:1px solid black;">Registry Script</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Microsoft Word 2007</td>
<td style="border:1px solid black;">Windows Registry Editor Version 5.00<br />


    [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

    "BinaryFiles"=dword:00000000




 
    For Microsoft Office 2010, open the Microsoft Word 2010 and perform the following steps:
1.  Click the **File** tab.
2.  Under **Help**, click **Options**.
3.  Click **Trust Center**, and then click **Trust Center Settings**.
4.  In the Trust Center, click **File Block Settings**.
5.  Clear the **Open** check box for the file types that you previously selected.
6.  Click **OK** to apply the File Block settings.


Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


