Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-038

#### Workarounds for Malformed AVI Header Vulnerability - CVE-2009-1545
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Deny access to Avifil32.dll**
  
On Windows 2000, Windows XP, and Windows Server 2003 systems:
  
*For 32-bit Windows:*
  
`cacls %windir%\system32\avifil32.dll /E /P everyone:N`
  
*For 64-bit Windows:*
  
`cacls %windir%\syswow64\avifil32.dll /E /P everyone`
  
On Windows Vista and Windows Server 2008:
  
Run the following commands from a command prompt as an administrator:
  
*For 32-bit Windows:*
takeown.exe /f %windir%\system32\avifil32.dll
icacls.exe %windir%\system32\avifil32.dll /save %TEMP%\AVIFIL32_ACL.TXT
icacls.exe %windir%\system32\avifil32.dll /deny everyone:(F)

For 64-bit Windows:
takeown /f %windir%\syswow64\avifil32.dll
icacls %windir%\syswow64\avifil32.dll /save %TEMP%\AVIFIL32_ACL.TXT
icacls %windir%\syswow64\avifil32.dll /deny everyone:(F)

Impact of workaround: Applications that rely on the AVIFile API will fail to render AVI video content properly
How to undo the workaround:
On Windows 2000, Windows XP, and Windows Server 2003 systems:
For 32-bit Windows:
cacls %windir%\system32\avifil32.dll /E /R everyone
For 64-bit Windows:
cacls %windir%\syswow64\avifil32.dll /E /R everyone
On Windows Vista and Windows Server 2008:
Run the following commands from a command prompt as an administrator:
For 32-bit Windows:
icacls %windir%\system32 /restore %TEMP%\AVIFIL32_ACL.TXT
For 64-bit Windows:
icacls %windir%\syswow64 /restore %TEMP%\AVIFIL32_ACL.TXT

Remove HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}

Removing this registry will prevent Windows Explorer from previewing AVI files.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.

Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}

On the File menu, click Export.

In the Export Registry File dialog box, enter Video_Media_Properties_Handler_Backup.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.

Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.


For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.

Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}

On the File menu, click Export.

In the Export Registry File dialog box, enter Video_Media_Properties_Handler_Backup1.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.

Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

Click Start, click Run, type Regedit in the Open box, and then click OK.

Locate the following subkey:
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}

On the File menu, click Export.

In the Export Registry File dialog box, enterÂ  Video_Media_Properties_Handler_Backup2.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.

Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.


Impact of workaround: Windows Explorer will not provide a preview image for AVI files.
Using a Managed Deployment Script

Create a backup copy of the registry keys by using a managed deployment script that contains the following commands:
For 32-bit Windows systems:
Regedit.exe /e Video_Media_Properties_Handler_Backup.reg
HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}
For 64-bit Windows Systems:
Regedit.exe /e Video_Media_Properties_Handler_Backup1.reg
HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}
Regedit.exe /e Video_Media_Properties_Handler_Backup2.reg
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}

Next, save the following to a file with a .REG extension, such as Disable_Video_Media_Properties_Handler.reg:
For 32-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}]
For 64-bit Windows Systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}]
[-HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{40C3D757-D6E4-4b49-BB41-0E5BBEA28817}]


Run the above registry script on the target machine with the following command from an elevated command prompt:
Regedit.exe /s Disable_Video_Media_Properties_Handler.reg
Workarounds for AVI Integer Overflow Vulnerability - CVE-2009-1546
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Deny access to Avifil32.dll

On Windows 2000, Windows XP, and Windows Server 2003 systems:
For 32-bit Windows:
cacls %windir%\system32\avifil32.dll /E /P everyone:N
For 64-bit Windows:
cacls %windir%\syswow64\avifil32.dll /E /P everyone
On Windows Vista and Windows Server 2008:
Run the following commands from a command prompt as an administrator:
For 32-bit Windows:
takeown.exe /f %windir%\system32\avifil32.dll
icacls.exe %windir%\system32\avifil32.dll /save %TEMP%\AVIFIL32_ACL.TXT
icacls.exe %windir%\system32\avifil32.dll /deny everyone:(F)

For 64-bit Windows:
takeown /f %windir%\syswow64\avifil32.dll
icacls %windir%\syswow64\avifil32.dll /save %TEMP%\AVIFIL32_ACL.TXT
icacls %windir%\syswow64\avifil32.dll /deny everyone:(F)

Impact of workaround: Applications that rely on the AVIFile API will fail to render AVI video content properly
How to undo the workaround:
On Windows 2000, Windows XP, and Windows Server 2003 systems:
For 32-bit Windows:
cacls %windir%\system32\avifil32.dll /E /R everyone
For 64-bit Windows:
cacls %windir%\syswow64\avifil32.dll /E /R everyone
On Windows Vista and Windows Server 2008:
Run the following commands from a command prompt as an administrator:
For 32-bit Windows:
icacls %windir%\system32 /restore %TEMP%\AVIFIL32_ACL.TXT
For 64-bit Windows:
icacls %windir%\syswow64 /restore %TEMP%\AVIFIL32_ACL.TXT
