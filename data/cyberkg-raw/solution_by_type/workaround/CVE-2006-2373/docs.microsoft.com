Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-030

Workarounds for SMB Driver Elevation of Privilege Vulnerability - CVE-2006-2373:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.
Note The following steps require Administrator privileges. In order to block the known attack vectors both of the recommended workarounds must be performed. We recommend that you restart the computer after you apply the workaround.

Disable the Workstation service
Disabling the Workstation service will help protect the affected system from attempts to exploit this vulnerability. To disable the Workstation service, follow these steps:

Click Start, and then click Control Panel. Alternatively, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Services.
Double-click Workstation.
In the Startup type list, click Disabled.
Click Stop, and then click OK.



You can also stop and disable the Workstation service by using the following command at the command prompt:
sc stop lanmanworkstation & sc config lanmanworkstation start= disabled
Impact of Workaround: If you disable the Workstation service, clients will not be able to access SMB shares.

Delete the MRxSmb driver registry entry
Deleting the MRxSmb registry entry will help protect the affected system from attempts to exploit this vulnerability. To delete the MRxSmb key, follow these steps:
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe

Click Start, click Run, type “regedit" (without the quotation marks), and then click OK.
Navigate to HKLM\System\CurrentControlSet\Services.
Right click on the MRxSmb key and Export the key.
Right click on the MRxSmb key and Delete the key.

Impact of Workaround: If you delete the MRxSmb registry key, clients will not be able to access SMB shares.


Workarounds for SMB Invalid Handle Vulnerability - CVE-2006-2374:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.
Note The following steps require Administrator privileges. In order to block the known attack vectors both of the recommended workarounds must be performed. We recommend that you restart the computer after you apply this workaround.

Disable the Workstation service
Disabling the Workstation service will help protect the affected system from attempts to exploit this vulnerability. To disable the Workstation service, follow these steps:

Click Start, and then click Control Panel. Alternatively, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Services.
Double-click Workstation.
In the Startup type list, click Disabled.
Click Stop, and then click OK.



You can also stop and disable the Workstation service by using the following command at the command prompt:
sc stop lanmanworkstation & sc config lanmanworkstation start= disabled
Impact of Workaround: If you disable the Workstation service, clients will not be able to access SMB shares.

Delete the MRxSmb driver registry entry
Deleting the MRxSmb registry entry will help protect the affected system from attempts to exploit this vulnerability. To delete the MRxSmb key, follow these steps:
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe

Click Start, click Run, type “regedit" (without the quotation marks), and then click OK.
Navigate to HKLM\System\CurrentControlSet\Services.
Right click on the MRxSmb key and Export the key.
Right click on the MRxSmb key and Delete the key.

Impact of Workaround: If you delete the MRxSmb registry key, clients will not be able to access SMB shares.


