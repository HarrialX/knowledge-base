Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-017

Workarounds for Directory Traversal Vulnerability - CAN-2004-0204:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Stop, disable, or remove IIS

You can stop IIS by issuing the net stop w3svc command at a command prompt.
You can use the IIS Manager to disable or stop IIS.
You can use the Add or Remove Programs tool in Control Panel to remove IIS from your system. To find IIS, click Add/Remove Windows Components.

Impact of Workaround: If you stop w3svc, the system can no longer provide Web content. If you stop or remove IIS, the system can no longer provide Web, FTP, or NTP content. The SMTP service is also unavailable.

To stop or pause a Web site by using IIS Manager

In IIS Manager, right-click the site that you want to stop or pause, (in this case the crystalreportwebformviewer2 virtual directory); and then click Stop, or Pause.

Impact of Workaround: The system will no longer provide Crystal Reports through the Crystal Web Interface.

To stop or pause a Web site by using a command-line command

Click Start, and then click Run, type cmd, and then click OK.
At the command prompt, type cscript iisweb.vbs /action "WebSiteName", and then press ENTER. Substitute stop or pause for action. Substitute your actual Web site name (for example "Default Web Site") for WebSiteName.

Impact of Workaround: The system will no longer provide Crystal Reports through the Crystal Web Interface.

Modify the crystalreportwebformviewer2 virtual directory to allow only authenticated and authorized access

Use IIS Manager to modify the crystalreportwebformviewer2 virtual directory and make it more restrictive. For example, you can make it allow only members of the Authenticated Users group, and disallow anonymous access.
Impact of Workaround: Anonymous access to the Crystal Reports Web viewer would no longer be available.



Restrict the Access Control List (ACL) on the crystalimagehandler.aspx file to allow access to authenticated and authorized users only

IIS supports controlling access to directories and files on a local computer by using all Windows authentication methods. Modify the ACL on the crystalimagehandler.aspx file to be more restrictive. For example, you can make it allow access to only a limited group of authenticated users.
Note You must use this workaround in conjunction with the “Modify the crystalreportwebformviewer2 virtual directory to allow only authenticated and authorized access” workaround.

Impact of Workaround: Only authenticated and authorized users will be able to access your Web site.


