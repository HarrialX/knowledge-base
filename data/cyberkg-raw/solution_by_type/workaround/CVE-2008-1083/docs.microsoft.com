Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-021

#### Workarounds for GDI Heap Overflow Vulnerability - CVE-2008-1083
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality.
  
-   Turn off metafile processing by modifying the registry  
    Customers who have applied [MS07-017](http://go.microsoft.com/fwlink/?linkid=84687) or customers using Windows Vista or Windows Server 2008 can disable metafile processing by modifying the registry. This setting will help protect the affected system from attempts to exploit this vulnerability.  
    To modify the key, follow these steps:    
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE\_Initialize  
    3.  On the **Edit** menu, point to **New**, and then click **DWORD**.  
    4.  Type **DisableMetaFiles**, and then press ENTER.  
    5.  On the **Edit** menu, click **Modify** to modify the DisableMetaFiles registry entry.  
    6.  In the **Value data** box, type **1**, and then click **OK**.  
    7.  Exit Registry Editor.  
    8.  Reboot the computer.
  
    **Impact of workaround.** Turning off processing ourning f metafiles may cause the appearance of software or system components to decrease in quality. Turning off processing of metafiles may also cause the software or system components to fail completely. It has been identified to have a potential significant functionality impact and should be evaluated and tested carefully to determine its applicability.
  
    Examples include the following:
  
    -   You cannot print on the computer.  
    -   Some applications on the computer may be unable to display Clipart.  
    -   Some scenarios that involve OLE rendering may break. Especially, it occurs when the object server is not active.
  
    For more information on this setting please read [Microsoft Knowledge Base Article 941835](http://support.microsoft.com/kb/941835).
  
    **Managed Deployment Script:**
  
    1.  Save the following to a file with a .REG extension (e.g. Disable\_MetaFiles.reg):  
        Windows Registry Editor Version 5.00  
        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE\_Initialize\]  
        "DisableMetaFiles"=dword:00000001  
    2.  Run the above registry script on the target machine with the following command from an administrator (on Vista, an elevated administrator) command prompt:  
        Regedit.exe /s Disable\_MetaFiles.reg  
    3.  Reboot the computer.
  
    **How to undo the workaround:**
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE\_Initialize  
    3.  On the **Edit** menu, click **Modify** on the DisableMetaFiles registry entry.  
    4.  In the **Value data** box, type **0**, and then click **OK**.  
    5.  Exit Registry Editor.  
    6.  Reboot the computer.
  
    **Important Notice Regarding Workaround Information.**
  
    The Workaround information provided in this document is intended ONLY to be an interim (i.e., emergency) solution for an undisclosed security vulnerability. Once Microsoft provides a security update, or provides more detailed workaround information in a security bulletin, you should not continue to use or rely on this Workaround; and you should promptly apply any security update and/or updated workaround information subsequently provided by Microsoft. In the event this Workaround applies to a version of Microsoft software for which no security update will be made available, and a more recent version of Microsoft software has addressed the underlying security vulnerability or will be updated to address the underlying security vulnerability, then you should not rely on this Workaround as a permanent solution; and you should install the more recent version of such Microsoft software and security updates at the earliest possible time.
  
#### Workarounds for GDI Stack Overflow Vulnerability - CVE-2008-1087
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality.
  
-   Turn off metafile processing by modifying the registry  
    Customers who have applied [MS07-017](http://go.microsoft.com/fwlink/?linkid=84687) or customers using Windows Vista or Windows Server 2008 can disable metafile processing by modifying the registry. This setting will help protect the affected system from attempts to exploit this vulnerability.  
    To modify the key, follow these steps:    
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE\_Initialize  
    3.  On the **Edit** menu, point to **New**, and then click **DWORD**.  
    4.  Type **DisableMetaFiles**, and then press ENTER.  
    5.  On the **Edit** menu, click **Modify** to modify the DisableMetaFiles registry entry.  
    6.  In the **Value data** box, type **1**, and then click **OK**.  
    7.  Exit Registry Editor.  
    8.  Reboot computer.
  
    **Impact of workaround.** Turning off processing of metafiles may cause the appearance of software or system components to decrease in quality. Turning off processing of metafiles may also cause the software or system components to fail completely. It has been identified to have a potential significant functionality impact and should be evaluated and tested carefully to determine its applicability.
  
    Examples include the following:
  
    -   You cannot print on the computer.  
    -   Some applications on the computer may be unable to display Clipart.  
    -   Some scenarios that involve OLE rendering may break. Especially, it occurs when the object server is not active.
  
    For more information on this setting please read [Microsoft Knowledge Base Article 941835](http://support.microsoft.com/kb/941835).
  
    **Managed Deployment Script:**
  
    1.  Save the following to a file with a .REG extension (e.g. Disable\_MetaFiles.reg):  
        Windows Registry Editor Version 5.00  
        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE\_Initialize\]  
        "DisableMetaFiles"=dword:00000001  
    2.  Run the above registry script on the target machine with the following command from an administrator (on Vista, an elevated administrator) command prompt:  
        Regedit.exe /s Disable\_MetaFiles.reg  
    3.  Reboot the computer.
  
    **How to undo the workaround:**
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\GRE\_Initialize  
    3.  On the **Edit** menu, click **Modify** on the DisableMetaFiles registry entry.  
    4.  In the **Value data** box, type **0**, and then click **OK**.  
    5.  Exit Registry Editor.  
    6.  Reboot the computer.
  
    **Important Notice Regarding Workaround Information.**
  
    The Workaround information provided in this document is intended ONLY to be an interim (i.e., emergency) solution for an undisclosed security vulnerability. Once Microsoft provides a security update, or provides more detailed workaround information in a security bulletin, you should not continue to use or rely on this Workaround; and you should promptly apply any security update and/or updated workaround information subsequently provided by Microsoft. In the event this Workaround applies to a version of Microsoft software for which no security update will be made available, and a more recent version of Microsoft software has addressed the underlying security vulnerability or will be updated to address the underlying security vulnerability, then you should not rely on this Workaround as a permanent solution; and you should install the more recent version of such Microsoft software and security updates at the earliest possible time.
  
