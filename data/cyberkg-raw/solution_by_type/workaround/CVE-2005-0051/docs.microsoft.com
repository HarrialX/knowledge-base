Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-007

Workarounds for Named Pipe Vulnerability - CAN-2005-0051:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the Computer Browser service
Disabling the Computer Browser service and restarting the affected system will help protect from remote attempts to exploit this vulnerability.
You can disable the Computer Browser service by following these steps:

Click Start, and then click Control Panel (or point to Settings, and then click Control Panel).
Double-click Administrative Tools.
Double-click Services.
Double-click Computer Browser Service.
In the Startup type list, click Disabled.
Click Stop, and then click OK.
You must restart the affected system for this workaround to correction function.

Impact of Workaround: If the Computer Browser service is disabled, any services that explicitly depend on the Computer Browser service may log an error message in the system event log. For more information about the Computer Browser service, see Microsoft Knowledge Base Article 188001.

Use the Group Policy settings to disable Computer Browser service on all affected systems that do not require this feature.
Because the Computer Browser service is a possible attack vector, disable it by using the Group Policy settings. You can disable the startup of this service at the local, site, domain, or organizational unit level by using Group Policy object functionality in Windows 2000 domain environments or in Windows Server 2003 domain environments. For more information about how to disable this service through login scripts, see Microsoft Knowledge Base Article 297789
Note You may also review the Windows 2000 Security Hardening Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If the Computer Browser service is disabled, any services that explicitly depend on the Computer Browser service may log an error message in the system event log. For more information about the Computer Browser service, see Microsoft Knowledge Base Article 188001.

Block TCP ports 139 and 445 at the firewall:
These ports are used to initiate a connection with the affected protocol. Blocking them at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports, visit the following Web site.

Use a personal firewall, such as the Internet Connection Firewall, which is included with Windows XP and do not enable “File and Printer Sharing for Microsoft Networks”.
By default, the Internet Connection Firewall feature in Windows XP helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet. If you have enabled “File and Printer Sharing for Microsoft Networks” this option will create an exception to allow communication on the affected ports and would still allow a system to be vulnerable to this issue even with the Internet Connection Firewall enabled. The “File and Printer Sharing for Microsoft Networks” exception should be removed to help protect against this vulnerability.
To enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.

To configure Internet Connection Firewall manually for a connection, follow these steps:

Click Start, and then click Control Panel.
In the default Category View, click Networking and Internet Connections, and then click Network Connections.
Right-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.
Click to deselect “File and Printer Sharing for Microsoft Networks”.
Click the Advanced tab.
Click to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.

Note If you want to enable certain programs and services to communicate through the firewall, click Settings on the Advanced tab, and then select the programs, the protocols, and the services that are required.

Enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798. While this documentation references Windows 2000, it also applies to Windows XP.

Block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878. While this documentation references Windows 2000, it also applies to Windows XP.


