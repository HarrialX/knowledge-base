Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-042

Workarounds for Logging Vulnerability - CAN-2004-0899:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Disable DHCP Logging
You can help protect against attacks that attempt to exploit this vulnerability by disabling the DHCP Logging feature. To disable this feature, perform the following steps:

Start the DHCP Manager.
Click the DHCP server where you want to enable logging.
Click Server, and then click Properties.
Click to clear the Enable DHCP Logging check box.
Restart the DHCP Server service or restart the affected system.

For more information, see Microsoft Knowledge Base Article 164524
Impact of Workaround DHCP Logging features are disabled. It is not possible to track activity logs until this feature is enabled.

Block UDP port 67 and UDP port 68 at your firewall.
These ports are used to initiate a connection with a DHCP server. Blocking these ports at the firewall will help prevent systems that are behind that firewall from being attacked by attempts to exploit this vulnerability. It is possible that other ports may be found that could be used to exploit this vulnerability. The ports that are listed are the most common attack vectors. We recommend that you block all inbound unsolicited communication from the Internet.

Move DHCP Services to Windows 2000 Server or a later version.
Later versions of the DHCP Server service, such as those that are provided as part of Windows 2000 Server or Windows Server 2003 are not vulnerable to this issue. Note Windows NT 4.0 Server is nearing the end of its support life cycle on December 30, 2004. For more information about the Windows Product Lifecycle, visit the following Microsoft Support Lifecycle Web site.


Workarounds for DHCP Request Vulnerability - CAN-2004-0900:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block UDP port 67 and UDP port 68 at your firewall.
These ports are used to initiate a connection with a DHCP server. Blocking these ports at the firewall will help prevent systems that are behind that firewall from being attacked by attempts to exploit this vulnerability. It is possible that other ports may be found that could be used to exploit this vulnerability. The ports that are listed are the most common attack vectors. We recommend that you block all inbound unsolicited communication from the Internet.

Move DHCP Services to Windows 2000 Server or a later version.
Later versions of the DHCP Server service, such as those that are provided as part of Windows 2000 Server or Windows Server 2003 are not vulnerable to this issue. Note Windows NT 4.0 Server is nearing the end of its support life cycle on December 30, 2004. For more information about the Windows Product Lifecycle, visit the following Microsoft Support Lifecycle Web site.


