Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-022

#### Workarounds for Buffer Overflow in Print Spooler Vulnerability - CVE-2009-0228
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block TCP ports 139 and 445 at the firewall**
  
    These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
    **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:
  
    -   Applications that use SMB (CIFS)  
    -   Applications that use mailslots or named pipes (RPC over SMB)  
    -   Server (File and Print Sharing)  
    -   Group Policy  
    -   Net Logon  
    -   Distributed File System (DFS)  
    -   Terminal Server Licensing  
    -   Print Spooler  
    -   Computer Browser  
    -   Remote Procedure Call Locator  
    -   Fax Service  
    -   Indexing Service  
    -   Performance Logs and Alerts  
    -   Systems Management Server  
    -   License Logging Service
  
-   **On Microsoft Windows 2000 Server Service Pack 4, remove the Print Spooler service from the NullSessionPipes registry key**
  
    Microsoft Windows 2000 Server Service Pack 4 allows anonymous connections to the affected service. To help prevent attempts to exploit this vulnerability by anonymous attackers, remove the Print Spooler Service from the NullSessionPipes subkey. This workaround will not prevent attacks from authenticated users. Use this workaround only if you cannot disable the Printer Spooler service.
  
    **Warning** Using Registry Editor incorrectly can cause serious problems that may require that you reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to modify the registry, view the "Change Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    **Note** We recommend backing up the registry before you modify it
  
    1.  Click **Start**, click **Run**, type **regedt32** and then click **OK.**  
    2.  In Registry Editor, locate the following registry key:  
        HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\\NullSessionPipes  
    3.  Edit the registry key and remove the **SPOOLSS** value.  
    4.  Restart the affected system after performing these actions.
  
    **Impact of workaround.** Anonymous connections to the Print Spooler service will not be allowed. This is the default behavior of later operating system versions.
  
-   **Disable the Print Spooler service**
  
    Disabling the Print Spooler service will help protect the affected system from attempts to exploit this vulnerability. To disable the Print Spooler service, follow these steps:
  
    1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel.**  
    2.  Double-click **Administrative Tools**.  
    3.  Double-click **Services**.  
    4.  Double-click **Print Spooler**.  
    5.  In the **Startup type** list, click **Disabled**.  
    6.  Click **Stop**, and then click **OK**.
  
    You can also stop and disable the Print Spooler service by using the following command at the command prompt:
  
    `sc stop Spooler & sc config Spooler start=disabled`
  
    **Impact of workaround.** If you disable the Print Spooler service, you cannot print locally or remotely. Therefore, we recommend this workaround only on systems that do not require printing.
  
    **How to undo the workaround.**
  
    To enable the Print Spooler service, follow these steps:
  
    1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel.**  
    2.  Double-click **Administrative Tools**.  
    3.  Double-click **Services**.  
    4.  Double-click **Print Spooler**.  
    5.  In the **Startup type** list, click **Automatic.**  
    6.  Click **Start**, and then click **OK**.
  
#### Workarounds for Print Spooler Read File Vulnerability - CVE-2009-0229
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Disable the Print Spooler service**
  
    Disabling the Print Spooler service will help protect the affected system from attempts to exploit this vulnerability. To disable the Print Spooler service, follow these steps:
  
    1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel.**  
    2.  Double-click **Administrative Tools**.  
    3.  Double-click **Services**.  
    4.  Double-click **Print Spooler**.  
    5.  In the **Startup type** list, click **Disabled**.  
    6.  Click **Stop**, and then click **OK**.
  
    You can also stop and disable the Print Spooler service by using the following command at the command prompt:
  
    `sc stop Spooler & sc config Spooler start=disabled`
  
    **Impact of workaround.** If you disable the Print Spooler service, you cannot print locally or remotely. Therefore, we recommend this workaround only on systems that do not require printing.
  
    **How to undo the workaround.**
  
    To enable the Print Spooler service, follow these steps:
  
    1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel.**  
    2.  Double-click **Administrative Tools**.  
    3.  Double-click **Services**.  
    4.  Double-click **Print Spooler**.  
    5.  In the **Startup type** list, click **Automatic.**  
    6.  Click **Start**, and then click **OK**.
  
#### Workarounds for Print Spooler Load Library Vulnerability - CVE-2009-0230
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Disable the Print Spooler service**
  
    Disabling the Print Spooler service will help protect the affected system from attempts to exploit this vulnerability. To disable the Print Spooler service, follow these steps:
  
    1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel.**  
    2.  Double-click **Administrative Tools**.  
    3.  Double-click **Services**.  
    4.  Double-click **Print Spooler**.  
    5.  In the **Startup type** list, click **Disabled**.  
    6.  Click **Stop**, and then click **OK**.
  
    You can also stop and disable the Print Spooler service by using the following command at the command prompt:
  
    `sc stop Spooler & sc config Spooler start=disabled`
  
    **Impact of workaround.** If you disable the Print Spooler service, you cannot print locally or remotely. Therefore, we recommend this workaround only on systems that do not require printing.
  
    **How to undo the workaround.**
  
    To enable the Print Spooler service, follow these steps:
  
    1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel.**  
    2.  Double-click **Administrative Tools**.  
    3.  Double-click **Services**.  
    4.  Double-click **Print Spooler**.  
    5.  In the **Startup type** list, click **Automatic.**  
    6.  Click **Start**, and then click **OK**.
  
