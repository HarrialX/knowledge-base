Original Source:
https://github.com/torvalds/linux/commit/a5b2c5b2ad5853591a6cac6134cd0f599a720865

Commit history:

  @@ -593,7 +593,8 @@ static int apparmor_setprocattr(struct task_struct *task, char *name,
  			sa.aad.op = OP_SETPROCATTR;
  			sa.aad.info = name;
  			sa.aad.error = -EINVAL;
-  return aa_audit(AUDIT_APPARMOR_DENIED, NULL, GFP_KERNEL,
+  return aa_audit(AUDIT_APPARMOR_DENIED,
+  __aa_current_profile(), GFP_KERNEL,
  					&sa, NULL);
  		}
  	} else if (strcmp(name, "exec") == 0) {
  
