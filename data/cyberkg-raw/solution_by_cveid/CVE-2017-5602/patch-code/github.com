Original Source:
https://github.com/jappix/jappix/commit/ea6de7c65b80880bdf85df47c1a8a5d3d68491af

Commit history:

  @@ -4,10 +4,10 @@ Jappix Changelog
  Here's the log of what has changed over the Jappix releases.
  
  
- Primo, v1.1.7 (Development)
- ---------------------------
+ Primo, v1.1.7 (January 2017)
+ ----------------------------
  
-  * (...)
+  * Improve Carbons  @valeriansaliou
  
  
  Primo, v1.1.6 (August 2015)
  
  @@ -1 +1 @@
- Primo [1.1.7~dev]
+ Primo [1.1.7]
  @@ -127,10 +127,13 @@ var Carbons = (function () {
   self._getForwarded = function(message) {
  
   try {
-  var forwarded_message = $(message.getNode()).find('forwarded[xmlns="' + NS_URN_FORWARD + '"]:first message:first');
+  // Check message is forwarded from our local user
+  if(Common.bareXID(Common.getStanzaFrom(message)) == Common.getXID()) {
+  var forwarded_message = $(message.getNode()).find('forwarded[xmlns="' + NS_URN_FORWARD + '"]:first message:first');
  
-  if(forwarded_message[0]) {
-  return JSJaCPacket.wrapNode(forwarded_message[0]);
+  if(forwarded_message[0]) {
+  return JSJaCPacket.wrapNode(forwarded_message[0]);
+  }
   }
  
   return null;
  @@ -238,4 +241,4 @@ var Carbons = (function () {
       */
   return self;
  
- })();
+ })();
