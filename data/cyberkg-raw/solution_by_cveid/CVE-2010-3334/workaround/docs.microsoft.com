Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-087

Workarounds for PowerPoint Integer Underflow Causes Heap Corruption Vulnerability - CVE-2010-2573
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special "exempt directory" as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2007, Office 2003 or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.


 



Command to enable MOICE to be the registered handler




For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler




For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open PowerPoint files from untrusted sources
Do not open or save PowerPoint files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for RTF Stack Buffer Overflow Vulnerability - CVE-2010-3333
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Read e-mails in plain text
To help protect yourself from the e-mail attack vector, read e-mail messages in plain text format.
Microsoft Office Outlook 2002 users who have applied Office XP Service Pack 1 or a later version can enable this setting and view in plain text only those e-mail messages that are not digitally signed or e-mail messages that are not encrypted.
Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about how to enable this setting in Outlook 2002, see Microsoft Knowledge Base Article 307594.
Impact of workaround. E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. Additionally:

The changes are applied to the preview pane and to open messages.
Pictures become attachments so that they are not lost.
Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.


Use Microsoft Office File Block policy to block the opening of RTF documents from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Microsoft Office 2007 must be applied.
For Office 2010 
Open Word 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

RTF Files


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. Users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open RTF files in Office 2003 or 2007 Microsoft Office System. For Microsoft Office 2010, RTF files will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000000

For 2007 Office system
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000000

For Office 2010 
Open Word 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.



Workarounds for Office Art Drawing Records Vulnerability - CVE-2010-3334
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents in Microsoft Word from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Office 2007, all of the latest security updates for Microsoft Office 2007 must be applied.
For Office 2010 
Open Word 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

Word 2003 Binary Documents and Templates
Word XP Binary Documents and Templates
Word 2000 Binary Documents and Templates
Word 97 Binary Documents and Templates
Word 95 Binary Documents and Templates
Word 6.0 Binary Documents and Templates
Word 2 and earlier Binary Documents and Templates


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2010 
Open Word 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents in Microsoft Excel from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.
For Office 2010 
Open Excel 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2010 
Open Excel 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents in Microsoft PowerPoint from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with the 2007 Microsoft Office system, all of the latest security updates for the 2007 Microsoft Office system must be applied.
For Office 2010 
Open PowerPoint 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

PowerPoint 97-2003 Presentations, Shows, Templates and Add-in Files


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2010 
Open PowerPoint 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.


 



Command to enable MOICE to be the registered handler




For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler




For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Drawing Exception Handling Vulnerability - CVE-2010-3335
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents in Microsoft Word from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Office 2007, all of the latest security updates for Microsoft Office 2007 must be applied.
For Office 2010 
Open Word 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

Word 2003 Binary Documents and Templates
Word XP Binary Documents and Templates
Word 2000 Binary Documents and Templates
Word 97 Binary Documents and Templates
Word 95 Binary Documents and Templates
Word 6.0 Binary Documents and Templates
Word 2 and earlier Binary Documents and Templates


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2010 
Open Word 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents in Microsoft Excel from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.
For Office 2010 
Open Excel 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2010 
Open Excel 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents in Microsoft PowerPoint from unknown or untrusted sources and locations
The following registry scripts can be used to set the File Block policy.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
For Office 2003 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
For Office 2007 
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001

Note In order to use 'FileOpenBlock' with the 2007 Microsoft Office system, all of the latest security updates for the 2007 Microsoft Office system must be applied.
For Office 2010 
Open PowerPoint 2010 and follow the steps below:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:

PowerPoint 97-2003 Presentations, Shows, Templates and Add-in Files


Under Open behavior for selected file types, select "Do not open selected file types" or select "Open selected file types in Protected View". Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location as discussed in Microsoft Knowledge Base Article 922848 will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected.
How to undo the workaround.
For Office 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000

For Office 2010 
Open PowerPoint 2010 and follow these steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.


 



Command to enable MOICE to be the registered handler




For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler




For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .PPS=oice.powerpoint.slideshow
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for MSO Large SPID Read AV Vulnerability - CVE-2010-3336
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Insecure Library Loading Vulnerability - CVE-2010-3337
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable loading of libraries from WebDAV and remote network shares
Note See Microsoft Knowledge Base Article 2264107 to deploy a workaround tool that allows customers to disable the loading of libraries from remote network or WebDAV shares. This tool can be configured to disallow insecure loading on a per-application or a global system basis.
Customers who are informed by their vendor of an application being vulnerable can use this tool to help protect against attempts to exploit this issue.
Note See Microsoft Knowledge Base Article 2264107 to use the automated Microsoft Fix it solution to deploy the registry key to block loading of libraries for SMB and WebDAV shares. Note that this Fix it solution does require you to install the workaround tool also described in Microsoft Knowledge Base Article 2264107 first. This Fix it solution only deploys the registry key and requires the workaround tool in order to be effective. We recommend that administrators review the KB article closely prior to deploying this Fix it solution.

Disable the WebClient service
Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause Microsoft Office Outlook to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet.
To disable the WebClient Service, follow these steps:

Click Start, click Run, type Services.msc and then click OK.
Right-click WebClient service and select Properties.
Change the Startup type to Disabled. If the service is running, click Stop.
Click OK and exit the management application.

Impact of workaround. When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the Web Client service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer.
How to undo the workaround.
To re-enable the WebClient Service, follow these steps:

Click Start, click Run, type Services.msc and then click OK.
Right-click WebClient service and select Properties.
Change the Startup type to Automatic. If the service is not running, click Start.
Click OK and exit the management application.


Block TCP ports 139 and 445 at the firewall
These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, TCP and UDP Port Assignments.
Impact of workaround. Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:

Applications that use SMB (CIFS)
Applications that use mailslots or named pipes (RPC over SMB)
Server (File and Print Sharing)
Group Policy
Net Logon
Distributed File System (DFS)
Terminal Server Licensing
Print Spooler
Computer Browser
Remote Procedure Call Locator
Fax Service
Indexing Service
Performance Logs and Alerts
Systems Management Server
License Logging Service

How to undo the workaround. Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see TCP and UDP Port Assignments.


