Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-055

#### Workarounds for Cinepak Codec Decompression Vulnerability - CVE-2010-2553
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Modify the Access Control List (ACL) on iccvid.dll**
  
    Modify the ACL on iccvid.dll to be more restrictive.
  
    For 32-bit editions of Windows XP, run the following commands from a command prompt (requires administrative privileges):
  
    `cacls %WINDIR%\SYSTEM32\iccvid.DLL /E /P everyone:N`
  
    For 64-bit editions of Windows XP, run the following commands from a command prompt (requires administrative privileges):
  
    `cacls %WINDIR%\SYSWOW64\iccvid.DLL /E /P everyone:N`
  
    For 32-bit editions of Windows Vista and Windows 7, run the following commands from an elevated command prompt:
  
    ```
    takeown /f %WINDIR%\SYSTEM32\ICCVID.DLL
    icacls %WINDIR%\SYSTEM32\ICCVID.DLL /save %TEMP%\ICCVID_ACL.TXT
    icacls %WINDIR%\SYSTEM32\ICCVID.DLL /deny everyone:(F)
    ```
  
    For 64-bit editions of Windows Vista and Windows 7, run the following commands from an elevated command prompt:
  
    ```
    takeown /f %WINDIR%\SYSWOW64\ICCVID.DLL
    icacls %WINDIR%\SYSWOW64\ICCVID.DLL /save %TEMP%\ICCVID_ACL.TXT
    icacls %WINDIR%\SYSWOW64\ICCVID.DLL /deny everyone:(F)
    ```
  
    **Impact of workaround.**Media files encoded using the Cinepak codec will fail to play in multimedia.
  
    **How to undo the workaround.**
  
    For 32-bit editions of Windows XP, run the following commands from a command prompt (requires administrative privileges):
  
    `cacls %WINDIR%\SYSTEM32\iccvid.dll /E /R everyone`
  
    For 64-bit editions of Windows XP, run the following commands from a command prompt (requires administrative privileges):
  
    `cacls %WINDIR%\SYSWOW64\iccvid.dll /E /R everyone`
  
    For 32-bit editions of Windows Vista and Windows 7, run the following commands from an elevated command prompt:
  
    `icacls %windir%\system32 /restore %TEMP%\ICCVID_ACL.TXT`
  
    For 64-bit editions of Windows Vista and Windows 7, run the following commands from an elevated command prompt:
  
    `icacls %windir%\syswow64 /restore %TEMP%\ICCVID_ACL.TXT`
  
-   **Disable the parsing of Cinepak encoded files in DirectShow**
  
    Disable the parsing of media files encoded with the Cinepak codec within DirectShow.
  
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    **Using the Interactive Method**
  
    For 32-bit Windows systems:
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate the following subkey:  
        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32  
    3.  On the **File** menu, click **Export**.  
    4.  In the Export Registry File dialog box, enter **Drivers32\_Backup.reg** and click **Save**.  
        **Note** This will create a backup of this registry key in the My Documents folder by default.  
    5.  Locate and select the string value with **vidc.cvid** as Name and **iccvid.dll** as Data.  
    6.  Press the **Delete** key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click **Yes**.
  
    For 64-bit Windows systems:
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate the following subkey:  
        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32  
    3.  On the **File** menu, click **Export**.  
    4.  In the Export Registry File dialog box, enter **Drivers32\_Backup.reg** and click **Save**.  
        **Note** This will create a backup of this registry key in the My Documents folder by default.  
    5.  Locate and select the string value with **vidc.cvid** as Name and **iccvid.dll** as Data.  
    6.  Press the **Delete** key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click **Yes**.
  
    **Using a Managed Deployment Script**
  
    1.  Create a backup copy of the registry keys by using a managed deployment script that contains the following commands:  
        **For 32-bit Windows systems**:
  
        `Regedit.exe /e Drivers32_Backup.reg "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32"`
  
        **For 64-bit Windows Systems**:
  
        `Regedit.exe /e Drivers32_Backup.reg "HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32"`
  
    2.  Next, save the following to a file with a .REG extension, such as Disable\_Cinepak\_Parser.reg:  
        **For 32-bit Windows systems**:
  
        `Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32]"vidc.cvid"=-`
  
        **For 64-bit Windows Systems**:
  
        `Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32]"vidc.cvid"=-`
  
    3.  Run the above registry script on the target machine with the following command from an elevated command prompt:
  
        `Regedit.exe /s Disable_Cinepak_Parser.reg`
  
    **Impact of workaround.**MPEG Layer-3 Parsing is disabled in applications that use DirectShow to play MPEG Layer-3 content.
  
    **How to undo the workaround.**
  
    Using the Interactive Method
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Click the **File** menu and select **Import**.  
    3.  In the Import Registry File dialog box, select **Drivers32\_Backup.reg** and click **Open**.
  
    Using a Managed Deployment Script
  
    Restore the original state by running the following command:
  
    `Regedit.exe /s Drivers32_Backup.reg`
  
-   **Unregister quartz.dll**
  
    To unregister this DLL, run the following command from an elevated command prompt.
  
    For 32-bit Windows:
  
    `Regsvr32.exe –u %WINDIR%\system32\quartz.dll`
  
    For 64-bit Windows:
  
    ```
    Regsvr32.exe –u %WINDIR%\system32\quartz.dll
    Regsvr32.exe –u %WINDIR%\syswow64\quartz.dll
    ```
  
    **Impact of workaround.**Windows Media Player will not be able to play .AVI or .WAV files.
  
    **How to undo the workaround.**
  
    Run the following command from an elevated command prompt.
  
    For 32-bit Windows:
  
    `Regsvr32.exe %WINDIR%\system32\quartz.dll`
  
    For 64-bit Windows:
  
    ```
    Regsvr32.exe %WINDIR%\system32\quartz.dll
    Regsvr32.exe %WINDIR%\syswow64\quartz.dll
    ```
  
