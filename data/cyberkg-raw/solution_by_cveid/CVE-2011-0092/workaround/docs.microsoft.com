Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-008

Workarounds for Visio Object Memory Corruption Vulnerability - CVE-2011-0092
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict Access to ORMELEMS.DLL
Run the following commands from a command prompt as an administrator:
For 32-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles%\Microsoft Office\<office version>\ormelems.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\ormelems.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 32-bit editions of Windows Vista, Windows Server 2008, and Windows 7:
cacls "%ProgramFiles%\Microsoft Office\<office version>\ormelems.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2:
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\ormelems.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
Impact of workaround. Users will not be able to use the Database Modeling feature in Visio.
How to undo the workaround:
Run the following command from a command prompt as an administrator:
For 32-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles%\Microsoft Office\<office version>\ormelems.dll" /E /R everyone
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\ormelems.dll" /E /R everyone
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 32-bit editions of Windows Vista, Windows Server 2008, and Windows 7:
takeown /f "%ProgramFiles%\Microsoft Office\<office version>\ormelems.dll"
cacls "%ProgramFiles%\Microsoft Office\<office version>\ormelems.dll" /E /R everyone

Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2:
takeown /f "%ProgramFiles(86)%\Microsoft Office\<office version>\ormelems.dll"
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\ormelems.dll" /E /R everyone

Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.

Disable Add-ins in Microsoft Visio 2007
Open Visio 2007 and follow the steps below:

Click Tools.
Click Trust Center.
Click Add-ins.
Ensure the Disable all Application Add-ins check box is selected.
Click OK to apply Settings.

Impact of workaround. Functionality that relies on Visio add-ins will not work.
How to undo the workaround.
Open Visio 2007 and follow the steps below:

Click Tools.
Click Trust Center.
Click Add-ins.
Ensure the Disable all Application Add-ins check box is not selected.
Click OK to apply Settings.


Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open Visio files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Visio Data Type Memory Corruption Vulnerability - CVE-2011-0093
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Restrict Access to ELEMENTS.DLL
Run the following commands from a command prompt as an administrator:
For 32-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles%\Microsoft Office\<office version>\elements.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\elements.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 32-bit editions of Windows Vista, Windows Server 2008, and Windows 7:
cacls "%ProgramFiles%\Microsoft Office\<office version>\elements.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2:
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\elements.dll" /E /P everyone:N
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
Impact of workaround. Users will not be able to use the Database Modeling feature in Visio.
How to undo the workaround:
Run the following command from a command prompt as an administrator:
For 32-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles%\Microsoft Office\<office version>\elements.dll" /E /R everyone
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows XP and Windows Server 2003:
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\elements.dll" /E /R everyone
Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 32-bit editions of Windows Vista, Windows Server 2008, and Windows 7:
Takeown /f "%ProgramFiles%\Microsoft Office\<office version>\elements.dll"
cacls "%ProgramFiles%\Microsoft Office\<office version>\elements.dll" /E /R everyone

Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.
For 64-bit editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2:
Takeown /f "%ProgramFiles(86)%\Microsoft Office\<office version>\elements.dll"
cacls "%ProgramFiles(86)%\Microsoft Office\<office version>\elements.dll" /E /R everyone

Note For <office version>, enter the version of the appropriate Microsoft Office component in your system, such as "Office10" for Microsoft Visio 2002, "Office11" for Microsoft Visio 2003, and "Office12" for Microsoft Visio 2007. To verify the version, open this Microsoft Office component and click Help.

Disable Add-ins in Microsoft Visio 2007
Open Visio 2007 and follow the steps below:

Click Tools.
Click Trust Center.
Click Add-ins.
Ensure the Disable all Application Add-ins check box is selected.
Click OK to apply Settings.

Impact of workaround. Functionality that relies on Visio add-ins will not work.
How to undo the workaround.
Open Visio 2007 and follow the steps below:

Click Tools.
Click Trust Center.
Click Add-ins.
Ensure the Disable all Application Add-ins check box is not selected.
Click OK to apply Settings.


Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open Visio files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


