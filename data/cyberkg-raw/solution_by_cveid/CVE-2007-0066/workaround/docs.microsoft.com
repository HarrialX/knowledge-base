Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-001

#### Workarounds for Windows Kernel TCP/IP/IGMPv3 and MLDv2 Vulnerability - CVE-2007-0069
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality.
  
-   **Disable IGMP and MLD processing**
  
    You can help prevent attempts to exploit the IGMP vulnerability by modifying the IGMPLevel control in the registry.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    To disable IGMP and MLD processing, following these steps:
  
    1.  Click **Start**, click **Run**, type **regedit** and then click **OK**.  
    2.  Expand **HKEY\_LOCAL\_MACHINE**.  
    3.  Expand **SYSTEM**, expand **CurrentControlSe**t, and then expand **Services**.  
    4.  Expand **TCPIP**, expand **Parameters**, and then expand **IGMPLevel**.  
    5.  Change the **DWORD** value to 0.
    
    **Note** You must restart the system for your changes to take effect.
  
    **Impact of workaround:** IGMPv3 and MLDv2 will be disabled. Applications that depend on this service will no longer function as designed.
  
    **How to undo the workaround:** Use the steps above to set the registry key setting to its original value or delete this registry key setting. By default this registry key setting is not present.
  
-   **Block IGMP and MLD on perimeter firewalls**
  
    Firewall best practices and standard default firewall configurations can help protect networks from IGMP and MLD attacks that originate outside the enterprise perimeter.
  
    **Impact of workaround:** IGMPv3 and MLDv2 will be blocked from outside the enterprise perimeter, and applications that depend on IGMPv3 and MLDv2 from outside the enterprise perimeter will no longer function as designed.
  
-   **Block IGMP and MLD inbound on Vista Firewall**
  
    Click **Control Panel**, click **Administrative Tools**, and then double-click **Windows Firewall with Advanced Security**.
  
    To Block IGMP:
  
    1.  Select **inbound rules**.  
    2.  Select **Core Networking - Internet Group Management Protocol (IGMP-In).**  
    3.  Right-click **select properties.**  
    4.  Select **Block the connections**.
  
    To Block MLD:
  
    1.  Select **inbound rules**.  
    2.  Select **Core Networking - Multicast Listener Query (ICMPv6-In)**.  
    3.  Right-click **select properties**.  
    4.  Select **Block the connections**.
  
-   **Impact of workaround:** IGMP/MLD will be blocked and applications or services that rely on multicast will no longer function.
  
    **How to undo the workaround:** Use the first three steps above and select **Allow the connections**.
  
#### Workarounds for Windows Kernel TCP/IP/ICMP Vulnerability - CVE-2007-0066
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality.
  
-   **Disable Router Discovery Protocol Processing**
  
    By default, Router Discovery Protocol is disabled on all affected platforms. If the Router Discovery Protocol is already enabled, the following workaround would disable it. You can help prevent attempts to exploit the ICMP vulnerability by setting the PerformRouterDiscovery value in the registry.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    To disable ICMP processing, following these steps:
  
    1.  Click **Start**, click **Run**, type **regedit** and then click **OK**.  
    2.  Expand **HKEY\_LOCAL\_MACHINE**.  
    3.  Expand **SYSTEM**, expand **CurrentControlSe**t, and then expand **Services**.  
    4.  Expand **TCPIP**, expand **Parameters**, and then expand **Interfaces**.  
    5.  Select **interface\_name** and set the **PerformRouterDiscovery** value to **0**.
    
    **Note** You must restart the system for your changes to take effect.
  
    **Impact of workaround:** Router Discovery will be disabled.
  
    **How to undo the workaround:** Use the steps above to set the **PerformRouterDiscovery** registry key setting to its original value or delete this registry key setting.
  
