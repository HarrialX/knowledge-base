Original Source:
https://github.com/liblouis/liblouis/commit/5e4089659bb49b3095fa541fa6387b4c40d7396e

Commit history:

  @@ -354,7 +354,9 @@ matchCurrentInput(
   const InString *input, int pos, const widechar *passInstructions, int passIC) {
   int k;
   int kk = pos;
-  for (k = passIC + 2; k < passIC + 2 + passInstructions[passIC + 1]; k++)
+  for (k = passIC + 2;
+ 			((k < passIC + 2 + passInstructions[passIC + 1]) && (kk < input->length));
+ 			k++)
   if (input->chars[kk] == ENDSEGMENT || passInstructions[k] != input->chars[kk++])
   return 0;
   return 1;
  
