Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-087

Workarounds for TrueType Font Parsing Vulnerability - CVE-2011-3402
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Deny access to T2EMBED.DLL
Note Before applying this workaround, users should apply the latest Microsoft security updates. If you are not sure whether your software is up to date, visit Microsoft Update, scan your computer for available updates, and install any high-priority updates that are offered to you.
Note For this workaround, commands for Windows XP and Windows Server 2003 may only work in English language versions of these operating systems.
Note This workaround only mitigates the Web-based and file sharing attack scenarios. The local attack scenario will not be mitigated by this workaround.
Note See Microsoft Knowledge Base Article 2639417 to use the automated Microsoft Fix it solution to enable or disable this workaround to deny access to t2embed.dll.
On Windows XP and Windows Server 2003:

For 32-bit systems, enter the following command at an administrative command prompt:
Echo y| cacls "%windir%\system32\t2embed.dll" /E /P everyone:N


For 64-bit systems, enter the following commands from an administrative command prompt:
Echo y| cacls "%windir%\system32\t2embed.dll" /E /P everyone:N

Echo y| cacls "%windir%\syswow64\t2embed.dll" /E /P everyone:N



On Windows Vista, Windows 7, Windows Server 2008, and Windows Server 2008 R2:

For 32-bit systems, enter the following commands at an administrative command prompt:
Takeown.exe /f "%windir%\system32\t2embed.dll"

Icacls.exe "%windir%\system32\t2embed.dll" /deny *S-1-1-0:(F)


For 64-bit systems, enter the following commands at an administrative command prompt:
Takeown.exe /f "%windir%\system32\t2embed.dll"

Icacls.exe "%windir%\system32\t2embed.dll" /deny *S-1-1-0:(F)

Takeown.exe /f "%windir%\syswow64\t2embed.dll"`

Icacls.exe "%windir%\syswow64\t2embed.dll" /deny *S-1-1-0:(F)



Impact of Workaround. 

Applications that rely on embedded font technology will fail to display properly.
After applying this workaround, users of Windows XP and Windows Server 2003 may be reoffered the KB982132 and KB972270 security updates. These reoffered updates will fail to install. The reoffering is a detection logic issue and users who have successfully applied both the KB982132 and KB972270 security updates previously can ignore the reoffer.
Applications with functionality that relies on T2EMBED.DLL, such as generating PDF files, may fail to work as expected. For example, Microsoft Office software will fail to generate PDF files.
Microsoft Office 2003 software with the Microsoft Office Compatibility Pack may fail to open PowerPoint 2007 (.pptx) files; instead, generating the message, "This file was created by a newer version of Microsoft PowerPoint. Do you want to download a compatibility pack so that you can work with this file?", even though the Microsoft Office Compatibility Pack is already installed.

How to undo the workaround.
On Windows XP and Windows Server 2003:

For 32-bit systems, enter the following command at an administrative command prompt:
cacls "%windir%\system32\t2embed.dll" /E /R everyone


For 64-bit systems, enter the following commands at an administrative command prompt:
cacls "%windir%\system32\t2embed.dll" /E /R everyone

cacls "%windir%\syswow64\t2embed.dll" /E /R everyone



On Windows Vista, Windows 7, Windows Server 2008, and Windows Server 2008 R2:

For 32-bit systems, enter the following command at an administrative command prompt:
Icacls.exe "%windir%\system32\t2embed.DLL" /remove:d *S-1-1-0


For 64-bit systems, enter the following commands at an administrative command prompt:
Icacls.exe "%windir%\system32\t2embed.DLL" /remove:d *S-1-1-0

Icacls.exe "%windir%\syswow64\t2embed.DLL" /remove:d *S-1-1-0





 
