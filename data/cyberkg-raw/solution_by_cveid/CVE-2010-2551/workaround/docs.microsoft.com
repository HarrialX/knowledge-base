Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-054

#### Workarounds for SMB Pool Overflow Vulnerability - CVE-2010-2550
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block TCP ports 139 and 445 at the firewall**
  
    These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
    **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:
  
       -   Applications that use SMB (CIFS)  
       -   Applications that use mailslots or named pipes (RPC over SMB)  
       -   Server (File and Print Sharing)  
       -   Group Policy  
       -   Net Logon  
       -   Distributed File System (DFS)  
       -   Terminal Server Licensing  
       -   Print Spooler  
       -   Computer Browser  
       -   Remote Procedure Call Locator  
       -   Fax Service  
       -   Indexing Service  
       -   Performance Logs and Alerts  
       -   Systems Management Server  
       -   License Logging Service
  
    **How to undo the workaround.** Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
#### Workarounds for SMB Variable Validation Vulnerability - CVE-2010-2551
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block TCP ports 139 and 445 at the firewall**
  
    These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
    **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:
  
       -   Applications that use SMB (CIFS)  
       -   Applications that use mailslots or named pipes (RPC over SMB)  
       -   Server (File and Print Sharing)  
       -   Group Policy  
       -   Net Logon  
       -   Distributed File System (DFS)  
       -   Terminal Server Licensing  
       -   Print Spooler  
       -   Computer Browser  
       -   Remote Procedure Call Locator  
       -   Fax Service  
       -   Indexing Service  
       -   Performance Logs and Alerts  
       -   Systems Management Server  
       -   License Logging Service
  
    **How to undo the workaround.** Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
#### Workarounds for SMB Stack Exhaustion Vulnerability - CVE-2010-2552
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block TCP ports 139 and 445 at the firewall**
  
    These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
    **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below:
  
    -   Applications that use SMB (CIFS)  
    -   Applications that use mailslots or named pipes (RPC over SMB)  
    -   Server (File and Print Sharing)  
    -   Group Policy  
    -   Net Logon  
    -   Distributed File System (DFS)  
    -   Terminal Server Licensing  
    -   Print Spooler  
    -   Computer Browser  
    -   Remote Procedure Call Locator  
    -   Fax Service  
    -   Indexing Service  
    -   Performance Logs and Alerts  
    -   Systems Management Server  
    -   License Logging Service
  
    **How to undo the workaround.** Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312).
  
-   **Disable SMB v2**
  
    To modify the registry key, perform the following steps:
  
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services  
    3.  Click **LanmanServer**.  
    4.  Click **Parameters**.  
    5.  Right-click to add a new **DWORD (32 bit) Value**.  
    6.  Enter **smb2** in the **Name** data field, and change the **Value** data field to **0**.  
    7.  Exit.  
    8.  Restart the "Server" service by performing one of the following:  
        - Open up the computer management MMC, navigate to **Services and Applications**, click **Services**, right-click the **Server** service name and click **Restart**. Answer **Yes** in the pop-up menu.  
        - From a command prompt and with administrator privileges, type **net stop server** and then **net start server**.
  
    **Impact of workaround.** The host will not communicate using SMBv2. Instead, the host will communicate using SMB 1.0. This should not impact basic services such as file and printer sharing. These will continue to function as normal.
  
    **How to undo the workaround:**
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services  
    3.  Click **LanmanServer**.  
    4.  Click **Parameters**.  
    5.  Double-click **smb2**, and change the **Value** data field to **1**.  
    6.  Exit.  
    7.  Restart the "Server" service by performing one of the following:  
        - Open up the computer management MMC, navigate to **Services and Applications**, click **Services**, right-click the **Server** service name and click **Restart**. Answer **Yes** in the pop-up menu.  
        - From a command prompt and with administrator privileges, type **net stop server** and then **net start server**.
  
