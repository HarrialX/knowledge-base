Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-028

Workarounds for DirectX NULL Byte Overwrite Vulnerability - CVE-2009-1537
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable the parsing of QuickTime content in quartz.dll
To modify the registry key, follow these steps:
Warning Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry as specified in the steps below before you edit it.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup1.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.
Locate the following subkey:
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup2.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

Using a Managed Deployment Script

Create a backup copy of the registry keys by using a managed deployment script that contains the following commands:
For 32-bit Windows systems:
Regedit.exe /e QuickTime_Decoder_Backup.reg
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
For 64-bit Windows systems:
Regedit.exe /e QuickTime_Decoder_Backup1.reg
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
Regedit.exe /e QuickTime_Decoder_Backup2.reg
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}

Next, save the following to a file with a .REG extension, such as Disable_QuickTime_Parser.reg:
For 32-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]
For 64-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]
[-HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]

Run the above registry script on the target machine with the following command from an elevated command prompt:
Regedit.exe /s Disable_QuickTime_Parser.reg


Impact of workaround. QuickTime content playback will be disabled.
How to undo the workaround.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Click the File menu and select Import.
In the Import Registry File dialog box, select QuickTime_Parser_Backup.reg and click Open.

For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Click the File menu and select Import.
In the Import Registry File dialog box, select QuickTime_Parser_Backup1.reg and click Open.
In the Import Registry File dialog box, select QuickTime_Parser_Backup2.reg and click Open.

Using a Managed Deployment Script
For 32-bit Windows systems, restore the original state by running the following command:
Regedit.exe /s QuickTime_Parser_Backup.reg
For 64-bit Windows systems, restore the original state by running the following command:
Regedit.exe /s QuickTime_Parser_Backup1.reg
Regedit.exe /s QuickTime_Parser_Backup2.reg

Modify the Access Control List (ACL) on quartz.dll
To modify the ACL on quartz.dll to be more restrictive, follow these steps:
On Windows XP and Windows Server 2003 (all editions), run the following command from a command prompt (requires administrative privileges):
For 32-bit Windows systems:
Echo y| cacls %WINDIR%\SYSTEM32\quartz.DLL /E /P everyone:N
For 64-bit Windows systems:
Echo y| cacls %WINDIR%\SYSTEM32\quartz.DLL /E /P everyone:N
Echo y| cacls %WINDIR%\SYSWOW64\quartz.DLL /E /P everyone:N
Impact of workaround: Windows Media Player will not be able to play .AVI or .WAV files.
How to undo the workaround:
On Windows XP and Windows Server 2003 (all editions), run the following command from a command prompt (requires administrative privileges)
For 32-bit Windows systems:
cacls %WINDIR%\SYSTEM32\quartz.dll /E /R everyone
For 64-bit Windows systems:
cacls %WINDIR%\SYSTEM32\quartz.dll /E /R everyone
cacls %WINDIR%\SYSWOW64\quartz.dll /E /R everyone

Unregister quartz.dll
To unregister this DLL, run the following command from an elevated command prompt:
For 32-bit Windows systems:
Regsvr32.exe –u %WINDIR%\system32\quartz.dll
For 64-bit Windows systems:
Regsvr32.exe –u %WINDIR%\system32\quartz.dllRegsvr32.exe –u %WINDIR%\syswow64\quartz.dll
Impact of workaround: Windows Media Player will not be able to play .AVI or .WAV files.
How to undo the workaround: Run the following command from an elevated command prompt:
For 32-bit Windows systems:
Regsvr32.exe %WINDIR%\system32\quartz.dll
For 64-bit Windows systems:
Regsvr32.exe %WINDIR%\system32\quartz.dllRegsvr32.exe %WINDIR%\syswow64\quartz.dll

For non-multimedia folder types, the Windows shell attack vector can be mitigated by using Windows Classic Folders
To change folder options:

Click Start, click Control Panel, click Appearance and Themes, and then click Folder Options. Or, open any folder, such as My Documents, and on the Tools menu, click Folder Options.
On the General tab, under Tasks, select Use Windows classic folders.



Workarounds for DirectX Pointer Validation Vulnerability - CVE-2009-1538
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable the parsing of QuickTime content in quartz.dll
To modify the registry key, follow these steps:
Warning Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry as specified in the steps below before you edit it.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup1.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.
Locate the following subkey:
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup2.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

Using a Managed Deployment Script

Create a backup copy of the registry keys by using a managed deployment script that contains the following commands:
For 32-bit Windows systems:
Regedit.exe /e QuickTime_Decoder_Backup.
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
For 64-bit Windows systems:
Regedit.exe /e QuickTime_Decoder_Backup1.reg
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
Regedit.exe /e QuickTime_Decoder_Backup2.
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}

Next, save the following to a file with a .REG extension, such as Disable_QuickTime_Parser.reg:
For 32-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]
For 64-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]
[-HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]

Run the above registry script on the target machine with the following command from an elevated command prompt:
Regedit.exe /s Disable_QuickTime_Parser.reg


Impact of workaround. QuickTime content playback will be disabled.
How to undo the workaround.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Click the File menu and select Import.
In the Import Registry File dialog box, select QuickTime_Parser_Backup.reg and click Open.

For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Click the File menu and select Import.
In the Import Registry File dialog box, select QuickTime_Parser_Backup1.reg and click Open.
In the Import Registry File dialog box, select QuickTime_Parser_Backup2.reg and click Open.

Using a Managed Deployment Script
For 32-bit Windows systems, restore the original state by running the following command:
Regedit.exe /s QuickTime_Parser_Backup.reg
For 64-bit Windows systems, restore the original state by running the following command:
Regedit.exe /s QuickTime_Parser_Backup1.reg
Regedit.exe /s QuickTime_Parser_Backup2.reg

Modify the Access Control List (ACL) on quartz.dll
To modify the ACL on quartz.dll to be more restrictive, follow these steps:
On Windows XP and Windows Server 2003 (all editions), run the following command from a command prompt (requires administrative privileges):
For 32-bit Windows systems:
Echo y| cacls %WINDIR%\SYSTEM32\quartz.DLL /E /P everyone:N
For 64-bit Windows systems:
Echo y| cacls %WINDIR%\SYSTEM32\quartz.DLL /E /P everyone:N
Echo y| cacls %WINDIR%\SYSWOW64\quartz.DLL /E /P everyone:N
Impact of workaround: Windows Media Player will not be able to play .AVI or .WAV files.
How to undo the workaround:
On Windows XP and Windows Server 2003 (all editions), run the following command from a command prompt (requires administrative privileges)
For 32-bit Windows systems:
cacls %WINDIR%\SYSTEM32\quartz.dll /E /R everyone
For 64-bit Windows systems:
cacls %WINDIR%\SYSTEM32\quartz.dll /E /R everyone
cacls %WINDIR%\SYSWOW64\quartz.dll /E /R everyone

Unregister quartz.dll
To unregister this DLL, run the following command from an elevated command prompt:
For 32-bit Windows systems:
Regsvr32.exe –u %WINDIR%\system32\quartz.dll
For 64-bit Windows systems:
Regsvr32.exe –u %WINDIR%\system32\quartz.dll
Regsvr32.exe –u %WINDIR%\syswow64\quartz.dll
Impact of workaround: Windows Media Player will not be able to play .AVI or .WAV files.
How to undo the workaround: Run the following command from an elevated command prompt:
For 32-bit Windows systems:
Regsvr32.exe %WINDIR%\system32\quartz.dll
For 64-bit Windows systems:
Regsvr32.exe %WINDIR%\system32\quartz.dll
Regsvr32.exe %WINDIR%\syswow64\quartz.dll

For non-multimedia folder types, the Windows shell attack vector can be mitigated by using Windows Classic Folders
To change folder options:

Click Start, click Control Panel, click Appearance and Themes, and then click Folder Options. Or, open any folder, such as My Documents, and on the Tools menu, click Folder Options.
On the General tab, under Tasks, select Use Windows classic folders.



Workarounds for DirectX Size Validation Vulnerability - CVE-2009-1539
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Disable the parsing of QuickTime content in quartz.dll
To modify the registry key, follow these steps:
Warning Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry as specified in the steps below before you edit it.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Locate the following subkey:
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup1.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.
Locate the following subkey:
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
On the File menu, click Export.
In the Export Registry File dialog box, enter QuickTime_Parser_Backup2.reg and click Save.
Note This will create a backup of this registry key in the My Documents folder by default.
Press the Delete key on the keyboard to delete the registry key. When prompted to delete the registry key via the Confirm Key Delete dialog box, click Yes.

Using a Managed Deployment Script

Create a backup copy of the registry keys by using a managed deployment script that contains the following commands:
For 32-bit Windows systems:
Regedit.exe /e QuickTime_Decoder_Backup.reg
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
For 64-bit Windows systems:
Regedit.exe /e QuickTime_Decoder_Backup1.
HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}
Regedit.exe /e QuickTime_Decoder_Backup2.reg
HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}

Next, save the following to a file with a .REG extension, such as Disable_QuickTime_Parser.reg:
For 32-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]
For 64-bit Windows systems:
Windows Registry Editor Version 5.00
[-HKEY_CLASSES_ROOT\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]
[-HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{D51BD5A0-7548-11CF-A520-0080C77EF58A}]

Run the above registry script on the target machine with the following command from an elevated command prompt:
Regedit.exe /s Disable_QuickTime_Parser.reg


Impact of workaround. QuickTime content playback will be disabled.
How to undo the workaround.
Using the Interactive Method
For 32-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Click the File menu and select Import.
In the Import Registry File dialog box, select QuickTime_Parser_Backup.reg and click Open.

For 64-bit Windows systems:

Click Start, click Run, type Regedit in the Open box, and then click OK.
Click the File menu and select Import.
In the Import Registry File dialog box, select QuickTime_Parser_Backup1.reg and click Open.
In the Import Registry File dialog box, select QuickTime_Parser_Backup2.reg and click Open.

Using a Managed Deployment Script
For 32-bit Windows systems, restore the original state by running the following command:
Regedit.exe /s QuickTime_Parser_Backup.reg
For 64-bit Windows systems, restore the original state by running the following command:
Regedit.exe /s QuickTime_Parser_Backup1.reg
Regedit.exe /s QuickTime_Parser_Backup2.reg

Modify the Access Control List (ACL) on quartz.dll
To modify the ACL on quartz.dll to be more restrictive, follow these steps:
On Windows XP and Windows Server 2003 (all editions), run the following command from a command prompt (requires administrative privileges):
For 32-bit Windows systems:
Echo y| cacls %WINDIR%\SYSTEM32\quartz.DLL /E /P everyone:N
For 64-bit Windows systems:
Echo y| cacls %WINDIR%\SYSTEM32\quartz.DLL /E /P everyone:N
Echo y| cacls %WINDIR%\SYSWOW64\quartz.DLL /E /P everyone:N
Impact of workaround: Windows Media Player will not be able to play .AVI or .WAV files.
How to undo the workaround:
On Windows XP and Windows Server 2003 (all editions), run the following command from a command prompt (requires administrative privileges)
For 32-bit Windows systems:
cacls %WINDIR%\SYSTEM32\quartz.dll /E /R everyone
For 64-bit Windows systems:
cacls %WINDIR%\SYSTEM32\quartz.dll /E /R everyone
cacls %WINDIR%\SYSWOW64\quartz.dll /E /R everyone

Unregister quartz.dll
To unregister this DLL, run the following command from an elevated command prompt:
For 32-bit Windows systems:
Regsvr32.exe –u %WINDIR%\system32\quartz.dll
For 64-bit Windows systems:
Regsvr32.exe –u %WINDIR%\system32\quartz.dll
Regsvr32.exe –u %WINDIR%\syswow64\quartz.dll
Impact of workaround: Windows Media Player will not be able to play .AVI or .WAV files.
How to undo the workaround: Run the following command from an elevated command prompt:
For 32-bit Windows systems:
Regsvr32.exe %WINDIR%\system32\quartz.dll
For 64-bit Windows systems:
Regsvr32.exe %WINDIR%\system32\quartz.dll
Regsvr32.exe %WINDIR%\syswow64\quartz.dll

For non-multimedia folder types, the Windows shell attack vector can be mitigated by using Windows Classic Folders
To change folder options:

Click Start, click Control Panel, click Appearance and Themes, and then click Folder Options. Or, open any folder, such as My Documents, and on the Tools menu, click Folder Options.
On the General tab, under Tasks, select Use Windows classic folders.



