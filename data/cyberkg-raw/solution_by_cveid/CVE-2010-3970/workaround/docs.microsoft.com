Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-006

#### Workarounds for Windows Shell Graphics Processing Overrun Vulnerability - CVE-2010-3970
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Modify the Access Control List (ACL) on shimgvw.dll on Windows XP and Windows Server 2003 systems**
    
    **Note** See [Microsoft Knowledge Base Article 2483185](http://support.microsoft.com/kb/2483185) to use the automated **Microsoft Fix it** solution to enable or disable this workaround.
  
    To modify the ACL on shimgvw.dll to be more restrictive, run the following commands from a command prompt as an administrator:
  
    **For 32-bit editions of Windows XP and Windows Server 2003:**
  
    `Echo y| cacls %WINDIR%\SYSTEM32\shimgvw.dll /E /P everyone:N`
  
    **For 64-bit editions of Windows XP and Windows Server 2003:**
  
    ```
    Echo y| cacls %WINDIR%\SYSTEM32\shimgvw.dll /E /P everyone:N
    Echo y| cacls %WINDIR%\SYSWOW64\shimgvw.dll /E /P everyone:N
    ```
  
    **Impact of Workaround.** Media files typically handled by the Windows Shell graphics processor will not be displayed properly. Note that before you install the MS11-006 security update, you must undo this workaround from systems where you have previously applied it.
  
    **How to undo the workaround.**
  
    Run the following commands from a command prompt as an administrator:
  
    For 32-bit editions of Windows XP and Windows Server 2003:
  
    `cacls %WINDIR%\SYSTEM32\shimgvw.dll /E /R everyone`
  
    For 64-bit editions of Windows XP and Windows Server 2003:
  
    ```
    cacls %WINDIR%\SYSTEM32\shimgvw.dll /E /R everyone
    cacls %WINDIR%\SYSWOW64\shimgvw.dll /E /R everyone
    ```
  
-   **Disable viewing of thumbnails in Windows Explorer on Windows Vista and Windows Server 2008 systems**
  
    To disable viewing of thumbnails in Windows Explorer on Windows Vista and Windows Server 2008, perform the following steps:
  
    1.  Open **Control Panel** and select **Appearance and Personalization**.  
    2.  Select **Folder Options** from the menu.  
    3.  Select the **View** tab and ensure the **Always show icons, never thumbnails** option is selected. Click **OK** to save the settings.  
    4.  Close all open instances of Windows Explorer for the change to take effect.
  
    **Impact of Workaround.** Windows Explorer will not display thumbnail images.
  
    **How to undo the workaround.**
  
    To enable thumbnails in Windows Vista and Windows Server 2008, perform the following steps:
  
    1.  Open **Control Panel** and select **Appearance and Personalization**.  
    2.  Select **Folder Options** from the menu.  
    3.  Select the **View** tab and ensure the **Always show icons, never thumbnails** option is not selected. Click **OK** to save the settings.  
    4.  Close all open instances of Windows Explorer for the change to take effect.
  
