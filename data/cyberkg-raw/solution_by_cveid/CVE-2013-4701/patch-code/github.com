Original Source:
https://github.com/openid/php-openid/commit/625c16bb28bb120d262b3f19f89c2c06cb9b0da9

Commit history:

  @@ -234,7 +234,14 @@ function setXML($xml_string)
   return false;
          }
  
-  if (!@$this->doc->loadXML($xml_string)) {
+  // disable external entities and libxml errors
+  $loader = libxml_disable_entity_loader(true);
+  $errors = libxml_use_internal_errors(true);
+  $parse_result = @$this->doc->loadXML($xml_string);
+  libxml_disable_entity_loader($loader);
+  libxml_use_internal_errors($errors);
+ 
+  if (!$parse_result) {
   return false;
          }
  
  
