Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-066

Workarounds for Client Service for NetWare Memory Corruption Vulnerability - CVE-2006-4688:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.
Note CSNW is commonly associated with the Internetwork Packet Exchange (IPX) and Sequenced Packet Exchange (SPX) protocols. However, CSNW could be exploited by using any installed protocol. Because TCP/IP is the most commonly used protocol, the following workarounds are based on TCP/IP. If protocols such as IPX and SPX are being used, you should also block the appropriate ports for those protocols. For more information about IPX and SPX, visit this site.

Remove the Client Service for NetWare if you do not need it.
If you no longer need the Client Service for NetWare, remove it. To do this, follow these steps.
Windows XP

Open Network Connections.
Right-click a local area connection and then click Properties.
In the This connection uses the following items list click Client Service for NetWare.
Click the General tab and then click Uninstall.
Complete the removal by following the instructions on the screen.

Windows 2000

Log in as administrator.
Right-click on My Network Places.
Click Properties.
Click Local Area Connection.
Highlight CSNW and click Uninstall.
On the pop up dialog box that displays, click Yes.

Impact of Workaround: Some organizations require the affected component for important functions. Administrators should not remove the affected component unless they fully understand the effect that doing this will have on their environment.

Block TCP ports 139 and 445 at the firewall:
These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit the following Web site.
Impact of Workaround: Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below.
Applications that uses SMB (CIFS)
Applications that uses mailslots or named pipes (RPC over SMB)
Server (File and Print Sharing)
Group Policy
Net Logon
Distributed File System (DFS)
Terminal Server Licensing
Print Spooler
Computer Browser
Remote Procedure Call Locator
Fax Service
Indexing Service
Performance Logs and Alerts
Systems Management Server
License Logging Service

To help protect from network-based attempts to exploit this vulnerability, use a personal firewall, such as the Windows Firewall, which is included with Windows XP.
By default, the Windows Firewall feature in Windows XP and in Windows Server 2003 helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet.
To enable the Windows Firewall feature by using the Network Setup Wizard, follow these steps:
1.Click Start, and then click Control Panel.
2.Double-click Network Connections and then click Change Windows Firewall settings.
3.On the General tab, ensure that the On (recommended) value is selected. This will enable the Windows Firewall.
4.Once the Windows Firewall is enabled, select Don’t allow exceptions to prohibit all incoming traffic.
Note If you want to enable certain programs and services to communicate through the firewall, de-select Don’t allow exceptions and click the Exceptions tab. On the Exception tab, select the programs, protocols, and services you want to enable.

To help protect from network-based attempts to exploit this vulnerability, enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.


Workarounds for NetWare Driver Denial of Service Vulnerability - CVE-2006-4689:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.
Note CSNW is commonly associated with the Internetwork Packet Exchange (IPX) and Sequenced Packet Exchange (SPX) protocols. However, CSNW could be exploited by using any installed protocol. Because TCP/IP is the most commonly used protocol, the following workarounds are based on TCP/IP. If protocols such as IPX and SPX are being used, you should also block the appropriate ports for those protocols. For more information about IPX and SPX, visit the following Microsoft Web site.

Remove the Client Service for NetWare if you do not need it.
If you no longer need the Client Service for NetWare, remove it. To do this, follow these steps.
Windows XP

Open Network Connections
Right-click a local area connection and then click Properties.
In the This connection uses the following items list. click Client Service for NetWare.
Click the General tab and then click Uninstall.
Complete the removal by following the instructions on the screen.

Windows 2000

Log in as administrator
Right-click on My Network Places
Click Properties
Click Local Area Connection
Highlight CSNW and click Uninstall
On the pop up dialog box that displays, click Yes

Impact of Workaround: Some organizations require the affected component for important functions. Administrators should not remove the affected component unless they fully understand the effect that doing this will have on their environment.

Block TCP ports 139 and 445 at the firewall:
These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit the following Web site.
Impact of Workaround: Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below.
Applications that uses SMB (CIFS)
Applications that uses mailslots or named pipes (RPC over SMB)
Server (File and Print Sharing)
Group Policy
Net Logon
Distributed File System (DFS)
Terminal Server Licensing
Print Spooler
Computer Browser
Remote Procedure Call Locator
Fax Service
Indexing Service
Performance Logs and Alerts
Systems Management Server
License Logging Service

To help protect from network-based attempts to exploit this vulnerability, use a personal firewall, such as the Windows Firewall, which is included with Windows XP.
By default, the Windows Firewall feature in Windows XP and in Windows Server 2003 helps protect your Internet connection by blocking unsolicited incoming traffic. We recommend that you block all unsolicited incoming communication from the Internet.
To enable the Windows Firewall feature by using the Network Setup Wizard, follow these steps:
1.Click Start, and then click Control Panel.
2.Double-click Network Connections and then click Change Windows Firewall settings.
3.On the General tab, ensure that the On (recommended) value is selected. This will enable the Windows Firewall.
4.Once the Windows Firewall is enabled, select Don’t allow exceptions to prohibit all incoming traffic.
Note – if you want to enable certain programs and services to communicate through the firewall, de-select Don’t allow exceptions and click the Exceptions tab. On the Exception tab, select the programs, protocols, and services you want to enable.
.

To help protect from network-based attempts to exploit this vulnerability, enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.


