Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-017

Workarounds for Message Queuing Vulnerability - CAN-2005-0059:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Block the following at the firewall:

UDP ports 135, 137, 138, 445, 1801, and 3527, and TCP ports 135, 139, 445, 593, 1801, 2101, 2103, 2105, and 2107
All unsolicited inbound traffic on ports greater than 1024
Any other specifically configured RPC port

These ports are used to initiate a connection with RPC. Blocking them at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports that RPC uses, visit the following Web site.

Remove Message Queuing if you do not need it.
If you no longer need Message Queuing, remove it. To do this, follow these steps. These steps apply only to Windows XP Service Pack 1. For Windows 2000, follow the procedure that is included in the product documentation.
Note Special permissions may be required to remove Message Queuing. For more information, see the following Message Queuing documentation.

Click, Start, and then click Control Panel.
Double-click, Add or Remove Programs.
In the default Category View, click Add or Remove Programs.
Click Add/Remove Windows Components.
On the Windows Components Wizard page, under Components, click to clear the Message Queuing check box to remove Message Queuing, and then click Next.
Complete the Windows Components Wizard by following the instructions on the screen.

Impact of Workaround: Many organizations require Message Queuing to perform important functions. Administrators should not remove Message Queuing unless they fully understand the effect that doing this will have on their environment. For more information about Message Queuing, see the Message Queuing product documentation.


