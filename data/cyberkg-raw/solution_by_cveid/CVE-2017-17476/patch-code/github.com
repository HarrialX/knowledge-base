Original Source:
https://github.com/OTRS/otrs/commit/36e3be99cfe8a9e09afa1b75fdc39f3e28f561fc

Commit history:

  @@ -220,7 +220,7 @@ sub Output {
   my $Target  = $2;
   my $End     = $3;
   my $RealEnd = $4;
-  if ( lc $Target =~ /^(http:|https:|#|ftp:)/ ||
+  if ( lc($Target) =~ /^(http:|https:|#|ftp:)/ ||
   $Target !~ /\.(pl|php|cgi|fcg|fcgi|fpl)(\?|$)/ ||
   $Target =~ /(\?|&|;)\Q$Self->{SessionName}\E=/) {
   $AHref.$Target.$End.$RealEnd;
  @@ -238,7 +238,7 @@ sub Output {
   my $AHref = $1;
   my $Target = $2;
   my $End = $3;
-  if (lc $Target =~ m{^http s? :}smx || !$Self->{SessionID} ||
+  if (lc($Target) =~ m{^http s? :}smx || !$Self->{SessionID} ||
   $Target !~ /\.(pl|php|cgi|fcg|fcgi|fpl)(\?|$)/ ||
   $Target =~ /\Q$Self->{SessionName}\E=/) {
   $AHref.$Target.$End;
  
