Original Source:
https://github.com/torvalds/linux/commit/3aa02cb664c5fb1042958c8d1aa8c35055a2ebc4

Commit history:

  @@ -1886,8 +1886,8 @@ void snd_pcm_period_elapsed(struct snd_pcm_substream *substream)
   snd_timer_interrupt(substream->timer, 1);
  #endif
   _end:
-  snd_pcm_stream_unlock_irqrestore(substream, flags);
   kill_fasync(&runtime->fasync, SIGIO, POLL_IN);
+  snd_pcm_stream_unlock_irqrestore(substream, flags);
  }
  
  EXPORT_SYMBOL(snd_pcm_period_elapsed);
  
