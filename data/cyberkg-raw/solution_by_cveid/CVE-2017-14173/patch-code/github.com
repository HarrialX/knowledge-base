Original Source:
https://github.com/ImageMagick/ImageMagick/commit/50f54462076648ac2e36c3f58f4dadd4babbf1c9

Commit history:

  @@ -446,7 +446,9 @@ static Image *ReadTXTImage(const ImageInfo *image_info,ExceptionInfo *exception)
   ThrowReaderException(CorruptImageError,"ImproperImageHeader");
      image->columns=width;
      image->rows=height;
-  for (depth=1; (GetQuantumRange(depth)+1) < max_value; depth++) ;
+  for (depth=1; (GetQuantumRange(depth)+1) < max_value; depth++)
+  if (depth >= 64)
+  break;
      image->depth=depth;
      status=SetImageExtent(image,image->columns,image->rows,exception);
   if (status == MagickFalse)
  
