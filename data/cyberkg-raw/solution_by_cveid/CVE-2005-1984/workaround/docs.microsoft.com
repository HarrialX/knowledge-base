Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-043

Workarounds for Print Spooler Vulnerability - CAN-2005-1984:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the Print Spooler service
Disabling the Print Spooler service will help protect the affected system from attempts to exploit this vulnerability. To disable the Print Spooler service, follow these steps:

Click Start, and then click Control Panel. Alternatively, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Services.
Double-click Print Spooler.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the Print Spooler service by using the following command at the command prompt:
sc stop Spooler & sc config Spooler start= disabled
Impact of Workaround: If you disable the Print Spooler service, you cannot print locally or remotely. Therefore, we recommend this workaround only on systems that do not require printing.

On Windows 2000 Server Service Pack 4 remove the Print Spooler service from the NullSessionPipes registry key:
Windows 2000 Server Service Pack 4 and Windows XP Service Pack 1 allow anonymous connections to the affected service. To help prevent attempts to exploit this vulnerability by anonymous attackers, remove the Print Spooler Service from the NullSessionPipes subkey. This workaround will not prevent attacks from authenticated users. Use this workaround only if you cannot disable the Printer Spooler service.
Note Using Registry Editor incorrectly can cause serious problems that may require that you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to modify the registry, view the "Change Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you modify it.

Click Start, click Run, type "regedt32" (without the quotation marks), and then click OK.

In Registry Editor, locate the following registry key:
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\NullSessionPipes

Edit the registry key and remove the SPOOLSS value.

Restart the affected system after performing these actions.


Impact of Workaround: Anonymous connections to the Print Spooler service will not be allowed. This is the default behavior of later operating system versions.


