Original Source:
https://github.com/gpac/gpac/commit/2da2f68bffd51d89b1d272d22aa8cc023c1c066e

Commit history:

  @@ -419,11 +419,13 @@ GF_Err stbl_GetSampleInfos(GF_SampleTableBox *stbl, u32 sampleNumber, u64 *offse
   if ( stbl->ChunkOffset->type == GF_ISOM_BOX_TYPE_STCO) {
  			stco = (GF_ChunkOffsetBox *)stbl->ChunkOffset;
   if (!stco->offsets) return GF_ISOM_INVALID_FILE;
+  if (stco->nb_entries < sampleNumber) return GF_ISOM_INVALID_FILE;
  
  			(*offset) = (u64) stco->offsets[sampleNumber - 1];
  		} else {
  			co64 = (GF_ChunkLargeOffsetBox *)stbl->ChunkOffset;
   if (!co64->offsets) return GF_ISOM_INVALID_FILE;
+  if (co64->nb_entries < sampleNumber) return GF_ISOM_INVALID_FILE;
  
  			(*offset) = co64->offsets[sampleNumber - 1];
  		}
  
