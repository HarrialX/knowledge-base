Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-011

#### Workarounds for Vulnerability in Windows Services DACLs could result in elevation of privilege - CVE-2006-0023:
  
Microsoft has tested the following workarounds. The identified workarounds change the default DACLs on Windows XP Service Pack 1 and on Windows Server to the enhanced security DACLs that are used on Windows XP Service Pack 2 and on Windows Server 2003 Service Pack 1. Therefore, these workarounds are considered complete solutions to this issue. Because the recommended access controls have been shipping with the latest operating systems for some time, they are anticipated to constitute low risk. However, any DACL change carries some risk of application incompatibility.
  
-   **Use the sc.exe command to set modified access controls for the identified services:**
  
    **Note** You must run the **sc.exe** command as a privileged user. You can run this command by using a computer startup script or by using an SMS script. By running this command, you increase the security of the DACLs so that they are at the same level as Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. For more information about the **sc.exe** command and about how to set DACLs for Windows services, see the following [Microsoft Product Documentation](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/sc.mspx). This mitigation does not require that you restart the computer.
  
    **For Windows XP Service Pack 1, run each of the following commands. Each command changes the DACL on the associated affected service.**
  
    **sc** sdset ssdpsrv D:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;PU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SO)(A;;CCLCSWRPLORC;;;AU)(A;;RPWPDTRC;;;LS)
  
    **sc** sdset netbt D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPLOCRRC;;;PU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SO)(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;DT;;;LS)(A;;DT;;;NS)(A;;CCLCSWRPLOCRRC;;;NO)
  
    **sc** sdset upnphost  
    D:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;PU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SO)(A;;CCLCSWRPLORC;;;AU)(A;;CCDCLCSWLOCRRC;;;LS)
  
    **sc** sdset scardsvr D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCLCSWRPWPDTLOCRRC;;;LS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SO)(A;;CCLCSWRPLOCRRC;;;S-1-2-0)
  
    **sc** sdset dhcp D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)
  
    **sc** sdset dnscache D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPLOCRRC;;;PU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)
  
    **For Windows Server 2003 ,run each of the following commands. Each command changes the DACL on the associated affected service.**
  
    **sc** sdset netbt D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPLOCRRC;;;PU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SO)(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;DT;;;LS)(A;;DT;;;NS)(A;;CCLCSWRPLOCRRC;;;NO)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)
  
    **sc** sdset dhcp D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)
  
    **sc** sdset dnscache D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPLOCRRC;;;PU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)
  
    **Note** For Windows Server 2003 ,NetBT, DnsCache, and DHCP are the only identified affected services. In the Windows Server 2003 scenario, an attack must be launched by a member of the Network Configuration Operators group. This group is empty by default.
  
    **Impact of Workaround:** None
  
-   **Use Group Policy to deploy modified access controls for the identified services.**
  
    Domain administrators can use Group Policy and the security templates to deploy modified access controls to Windows XP Service Pack 1 systems. For more information about how to implement security templates by using Group Policy, see [Microsoft Knowledge Base Article 816585](http://support.microsoft.com/kb/816585). You do not have to restart the computer to complete this mitigation.
  
    **For Windows XP Service Pack 1, use the following security template to modify the Upnphost, SCardSvr, SSDPSRV, DnsCache, and DHCP services.**
  
    \[Unicode\]  
    Unicode=yes  
    \[Version\]  
    signature="$CHICAGO$"  
    Revision=1  
    \[Service General Setting\]  
    SSDPSRV,2,"D:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;PU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-32-549)(A;;CCLCSWRPLORC;;;AU)(A;;RPWPDTRC;;;S-1-5-19)"  
    upnphost,2,"D:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;PU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-32-549)(A;;CCLCSWRPLORC;;;AU)(A;;CCDCLCSWLOCRRC;;;S-1-5-19)"  
    scardsvr,2,"D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCLCSWRPWPDTLOCRRC;;;S-1-5-19)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-32-549)(A;;CCLCSWRPLOCRRC;;;S-1-2-0)"  
    dhcp,2,"D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)"  
    dnscache,2,"D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPLOCRRC;;;PU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)"
  
    **For Windows Server 2003,use the following security template to modify the DnsCache and DHCP services.**
  
    \[Unicode\]  
    Unicode=yes  
    \[Version\]  
    signature="$CHICAGO$"  
    Revision=1  
    \[Service General Setting\]  
    dhcp,,"D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)"  
    dnscache,,"D:(A;;CCLCSWLOCRRC;;;AU)(A;;CCLCSWRPLOCRRC;;;PU)(A;;CCLCSWRPWPDTLOCRRC;;;NO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWRPWPDTLOCRRC;;;SY)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)"
  
    **Note** For Windows XP Service Pack 1 and Windows Server 2003 ,changing the service DACLs on the NetBT service is not supported by using the Microsoft Group Policy Object Editor. Therefore, the NetBT service DACL change is not included in the security template for Windows Server 2003.
  
    **Note** For Windows Server 2003 ,NetBT, DHCP, and DnsCache are the only identified affected services. In the Windows Server 2003 scenario, a member of the Network Configuration Operators group must launch an attack. This group is empty by default and is rarely populated.
  
    **Impact of Workaround:** In addition to setting the Services DACLs the same as those for Windows XP Service Pack 2, the security template that is provided sets the service startup type for the affected service to its original default configuration of “Automatic.” Because Windows Server 2003 the supports the ability to configure startup type settings, the startup type is unchanged for Windows Server 2003.
  
-   **Modify the Windows registry to modify access controls for each of the identified services.**
  
    The preferred method of service modification is by using the **sc.exe** command. However, you can use the following command to modify the security DACLs of the affected services to the same level as Windows XP Service Pack 2. Users are encouraged to back up the registry before they make any modifications. For more information about registry scripts and about how to modify the Windows registry, see [Microsoft Knowledge Base Article 214752](http://support.microsoft.com/kb/214752).
  
    **For Windows XP Service Pack 1, modify the following registry keys to change the default Windows XP Service Pack 1 affected services**
  
    For the SSDPSRV service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\SSDPSRV\\Security /v Security /t REG\_BINARY /d \_  
    01001480bc000000c8000000140000003000000002001c000100000002801400ff010f00010100000000000100000\_  
    00002008c000600000000001400ff010f0001010000000000051200000000001800ff010f00010200000000000520\_  
    0000002002000000001800fd0102000102000000000005200000002302000000001800ff010f00010200000000000\_  
    52000000025020000000014009d00020001010000000000050b000000000014007000020001010000000000051300\_  
    0000010100000000000512000000010100000000000512000000
  
    For the NetBT service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\netbt\\Security /v Security /t REG\_BINARY /d \_  
    01001480e8000000f4000000140000003000000002001c000100000002801400ff010f00010100000000000100000\_  
    0000200b80008000000000014008d01020001010000000000050b000000000018009d010200010200000000000520\_  
    0000002302000000001800ff010f000102000000000005200000002002000000001800ff010f00010200000000000\_  
    5200000002502000000001400fd010200010100000000000512000000000014004000000001010000000000051300\_  
    00000000140040000000010100000000000514000000000018009d0102000102000000000005200000002c0200000\_  
    10100000000000512000000010100000000000512000000
  
    For the UPnPHost service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\upnphost\\Security /v Security /t REG\_BINARY /d \_  
    01001480bc000000c8000000140000003000000002001c000100000002801400ff010f00010100000000000100000\_  
    00002008c000600000000001400ff010f0001010000000000051200000000001800ff010f00010200000000000520\_  
    0000002002000000001800fd0102000102000000000005200000002302000000001800ff010f00010200000000000\_  
    52000000025020000000014009d00020001010000000000050b000000000014008f01020001010000000000051300\_  
    0000010100000000000512000000010100000000000512000000
  
    For the ScardSvr service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\scardsvr\\Security /v Security /t REG\_BINARY /d \_  
    01001480a4000000b0000000140000003000000002001c000100000002801400ff010f00010100000000000100000\_  
    000020074000500000000001400fd01020001010000000000051200000000001400fd010200010100000000000513\_  
    00000000001800ff010f000102000000000005200000002002000000001800ff010f0001020000000000052000000\_  
    025020000000014009d01020001010000000000020000000001010000000000051200000001010000000000051200\_  
    0000
  
    For the DHCP service:
  
    reg add HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\dhcp\\security /v Security /t REG\_BINARY /d \_  
    01001480900000009C000000140000003000000002001C00010000002801400FF010F00010100000000000100000000020060000\_  
    4000000000014008D01020001010000000000050B00000000001800FD010200012000000000005200000002C02000000001800FF\_  
    010F00010200000000005200000002002000000001400FD010200010100000000000512000000101000000000005120000000101\_  
    00000000000512000000
  
    For the DnsCache service:
  
    reg add HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\dnscache\\security /v Security /t REG\_BINARY /d\_  
    01001480A8000000B4000000140000003000000002001C00010000002801400FF010F00010100000000000100000000020078000500\_  
    0000000014008D01020001010000000000050B000000000018009D010200012000000000005200000002302000000001800FD010200\_  
    010200000000005200000002C02000000001800FF010F000102000000000005200000002002000000001400FD010200010100000000\_  
    00051200000001010000000000512000000010100000000000512000000
  
    **For Windows Server 2003 ,modify the following registry keys to change the default Windows Server 2003 affected service.**
  
    For the NetBT service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\netbt\\Security /v Security /t REG\_BINARY /d \_  
    01001480e8000000f4000000140000003000000002001c000100000002801400ff010f00010100000000000100000\_  
    0000200b80008000000000014008d01020001010000000000050b000000000018009d010200010200000000000520\_  
    0000002302000000001800ff010f000102000000000005200000002002000000001800ff010f00010200000000000\_  
    5200000002502000000001400fd010200010100000000000512000000000014004000000001010000000000051300\_  
    00000000140040000000010100000000000514000000000018009d0102000102000000000005200000002c0200000\_  
    10100000000000512000000010100000000000512000000
  
    For the DHCP service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\dhcp\\Security /v Security /t REG\_BINARY /d \_  
    01001480900000009C000000140000003000000002001C00010000002801400FF010F000101000000000001000\_  
    000000200600004000000000014008D01020001010000000000050B00000000001800FD0102000020000000000\_  
    05200000002C02000000001800FF010F000102000000000005200000002002000000001400FD01020001010000\_  
    000000051200000010100000000000512000000010100000000000512000000
  
    For the DnsCache service:
  
    reg add HKLM\\System\\CurrentControlSet\\Services\\dnscache\\Security /v Security /t REG\_BINARY /d \_  
    01001480900000009C000000140000003000000002001C00010000002801400FF010F000101000000000001000\_  
    000000200600004000000000014008D01020001010000000000050B00000000001800FD0102000020000000000\_  
    05200000002C02000000001800FF010F000102000000000005200000002002000000001400FD01020001010000\_  
    000000051200000010100000000000512000000010100000000000512000000
  
    **Note** For these registry key values, the “\_” character and a carriage return have been inserted for readability. Remove this character and this carriage return in order to execute the command correctly.
  
    **Impact of Workaround:** In addition to setting the services DACLs the same as those for Windows Server 2003 Service Pack 1 and Windows XP Service Pack 2, you do not have to restart the computer to complete this mitigation.
  
