Original Source:
https://github.com/opscode/chef/commit/33f0e9c58bbf047e1b401a834f3abfe72d9a8947

Commit history:

  @@ -49,13 +49,13 @@ def create
   exists = true 
   if params.has_key?(:inflated_object)
   params[:name] ||= params[:inflated_object].name
-  # We can only get here if we're admin or the validator. Only
-   # allow creating admin clients if we're already an admin.
-  if @auth_user.admin
-   params[:admin] ||= params[:inflated_object].admin
-   else
-   params[:admin] = false
-  end
+  params[:admin] ||= params[:inflated_object].admin
+  end
+ 
+  # We can only create clients if we're the admin or the validator.
+  # But only allow creating admin clients if we're already an admin.
+  if params[:admin] == true && @auth_user.admin != true
+  raise Forbidden, "You are not allowed to take this action."
   end
  
   begin
  
