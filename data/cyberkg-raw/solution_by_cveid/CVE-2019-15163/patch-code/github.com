Original Source:
https://github.com/the-tcpdump-group/libpcap/commit/437b273761adedcbd880f714bfa44afeec186a31

Commit history:

  @@ -1222,6 +1222,7 @@ daemon_AuthUserPwd(char *username, char *password, char *errbuf)
  #ifdef HAVE_GETSPNAM
   struct spwd *usersp;
  #endif
+  char *crypt_password;
  
   // This call is needed to get the uid
   if ((user = getpwnam(username)) == NULL)
  @@ -1252,7 +1253,13 @@ daemon_AuthUserPwd(char *username, char *password, char *errbuf)
  	user_password = user->pw_passwd;
  #endif
  
-  if (strcmp(user_password, (char *) crypt(password, user_password)) != 0)
+ 	crypt_password = crypt(password, user_password);
+  if (crypt_password == NULL)
+ 	{
+  pcap_snprintf(errbuf, PCAP_ERRBUF_SIZE, "Authentication failed");
+  return -1;
+ 	}
+  if (strcmp(user_password, crypt_password) != 0)
  	{
   pcap_snprintf(errbuf, PCAP_ERRBUF_SIZE, "Authentication failed: user name or password incorrect");
   return -1;
  
