Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-064

#### Workarounds for Microsoft DirectX Code Execution Vulnerability Parsing SAMI Files - CVE-2007-3901
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Modify the Access Control List for quartz.dll**
  
    On Windows XP (all editions), run the following command from a command prompt:
  
    `Echo y| Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /P everyone:N`
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    `Takeown.exe /f %WINDIR%\SYSTEM32\QUARTZ.DLLIcacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /save %TEMP%\QUARTZ_ACL.TXTIcacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /deny everyone:(F)`
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista. All files will fail to play in DirectX-enabled applications on Windows XP**.**
  
    **How to undo the workaround:** On Windows XP (all editions), run the following command from a command prompt:
  
    `Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /R everyone`
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    `Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /grant everyone:(F)Icacls.exe %WINDIR%\SYSTEM32 /restore %TEMP%\QUARTZ_ACL.TXT`
  
-   **Unregister the quartz.dll**
  
    `Regsvr32.exe –u %WINDIR%\SYSTEM32\QUARTZ.DLL`
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista. All files will fail to play in DirectX-enabled applications on Windows XP.
  
    **How to undo the workaround:** Run the following command from an elevated command prompt:
  
    `Regsvr32.exe %WINDIR%\SYSTEM32\QUARTZ.DLL`
  
#### Workarounds for Microsoft DirectX Code Execution Vulnerability Parsing WAV and AVI Files – CVE-2007-3895
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Modify the Access Control List for quartz.dll**
  
    On Windows XP (all editions), run the following command from a command prompt:
  
    `Echo y| Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /P everyone:N`
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    `Takeown.exe /f %WINDIR%\SYSTEM32\QUARTZ.DLLIcacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /save %TEMP%\QUARTZ_ACL.TXTIcacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /deny everyone:(F)`
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista. All files will fail to play in DirectX-enabled applications on Windows XP**.**
  
    **How to undo the workaround:** On Windows XP (all editions), run the following command from a command prompt:
  
    `Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /R everyone`
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    `Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /grant everyone:(F)Icacls.exe %WINDIR%\SYSTEM32 /restore %TEMP%\QUARTZ_ACL.TXT`
  
-   **Unregister the quartz.dll**
  
    `Regsvr32.exe –u %WINDIR%\SYSTEM32\QUARTZ.DLL`
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista. All files will fail to play in DirectX-enabled applications on Windows XP.
  
    **How to undo the workaround:** Run the following command from an elevated command prompt:
  
    `Regsvr32.exe %WINDIR%\SYSTEM32\QUARTZ.DLL`
  
