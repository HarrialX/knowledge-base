Original Source:
https://github.com/sferik/rails_admin/commit/b13e879eb93b661204e9fb5e55f7afa4f397537a

Commit history:

  @@ -11,6 +11,8 @@ class ActionNotAllowed < ::StandardError
   end
  
   class ApplicationController < Config.parent_controller.constantize
+  protect_from_forgery with: :exception
+ 
   before_action :_authenticate!
   before_action :_authorize!
   before_action :_audit!
  
  @@ -148,4 +148,17 @@
   is_expected.to have_selector('.label-danger')
   end
   end
+ 
+  describe 'CSRF protection' do
+  before do
+  allow_any_instance_of(ActionController::Base).to receive(:protect_against_forgery?).and_return(true)
+  end
+ 
+  it 'is enforced' do
+  visit new_path(model_name: 'league')
+  fill_in 'league[name]', with: 'National league'
+  find('input[name="authenticity_token"]', visible: false).set("invalid token")
+  expect { click_button 'Save' }.to raise_error ActionController::InvalidAuthenticityToken
+  end
+  end
  end
