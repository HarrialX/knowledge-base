Original Source:
https://github.com/Eugeny/ajenti/commit/3270fd1d78391bb847b4c9ce37cf921f485b1310

Commit history:

  @@ -322,8 +322,12 @@ class window.Control
  
  
   s: (value) ->
-  # TODO SANITIZE!
-         value
+         ('' + value) /* Forces the conversion to string. */
+         .replace(/&/g, '&amp;') /* This MUST be the 1st replacement. */
+             .replace(/'/g, '&apos;') /* The 4 other predefined entities, required. */
+             .replace(/"/g, '&quot;')
+             .replace(/</g, '&lt;')
+             .replace(/>/g, '&gt;')
  
   createDom: () ->
   ""
  
  @@ -6,4 +6,5 @@ class window.Controls.bind__template extends window.Control
   setupDom: (dom) ->
   super(dom)
   if @children.length > 0
-  @dom = @children[0].dom
+  @dom = @children[0].dom
+  @properties = @children[0].properties
  @@ -231,7 +231,7 @@ class window.Controls.fileupload extends window.Control
   super(dom)        
   @progress = new window.Controls.progressbar(@ui, {}, [])
   $(@dom).find('.pb').append($(@progress.dom))
-  @input = @dom.find('input')[0]
+  @input = $(@dom).find('input')[0]
   @input.addEventListener 'change', (e) =>
   file = @input.files[0]
   xhr = new XMLHttpRequest()
  
