Original Source:
https://github.com/simplesamlphp/simplesamlphp/commit/90dca835158495b173808273e7df127303b8b953

Commit history:

  @@ -623,6 +623,7 @@ private static function generateNameIdValue(SimpleSAML_Configuration $idpMetadat
   if ($attribute === NULL) {
   if (!isset($state['UserID'])) {
   SimpleSAML_Logger::error('Unable to generate NameID. Check the userid.attribute option.');
+  return NULL;
  				}
   $attributeValue = $state['UserID'];
   $idpEntityId = $idpMetadata->getString('entityid');
  
