Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-018

#### Workarounds for Active Directory Invalid Free Vulnerability - CVE-2009-1138
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block TCP ports 389, 636, 3268 and 3269 at the firewall**
  
    Block the following at the firewall:
  
    TCP ports 389, 636, 3268 and 3269
  
    These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Ports 389 and 636 provide LDAP and secure LDAP services respectively, while ports 3268 and 3269 are used by the Global Catalog server which also processes LDAP requests.
  
    Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx).
  
-   **Disable anonymous LDAP access on Microsoft Windows 2000 servers**
  
    Disabling anonymous LDAP access on Microsoft Windows 2000 servers will limit exploitation of this vulnerability to authenticated users only. For more information on LDAP NULL base (anonymous) connections, including a description of the impact of disabling them, see [Microsoft Knowledge Base Article 837964](http://support.microsoft.com/kb/837964).
  
#### Workarounds for Active Directory Memory Leak Vulnerability - CVE-2009-1139
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block TCP ports 389, 636, 3268 and 3269 at the firewall**
  
    Block the following at the firewall:
  
    TCP ports 389, 636, 3268 and 3269
  
    These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Ports 389 and 636 provide LDAP and secure LDAP services respectively, while ports 3268 and 3269 are used by the Global Catalog server which also processes LDAP requests.
  
    Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx).
  
-   **Disable anonymous LDAP access on Microsoft Windows 2000 servers**
  
    Disabling anonymous LDAP access on Microsoft Windows 2000 servers will limit exploitation of this vulnerability to authenticated users only. For more information on LDAP NULL base (anonymous) connections, including a description of the impact of disabling them, see [Microsoft Knowledge Base Article 837964](http://support.microsoft.com/kb/837964).
  
