Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-017

#### Workarounds for Office Web Components URL Parsing Vulnerability - CVE-2006-4695
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Prevent Office Web Components Library from running in Internet Explorer**.
  
    You can prevent the Office Web Components Library from running in Internet Explorer by setting the kill bit for the control in the registry.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    For detailed steps that you can use to prevent a control from running in Office Web Components, see [Microsoft Knowledge Base Article 240797](http://support.microsoft.com/kb/240797). Follow these steps in this article to create a Compatibility Flags value in the registry to prevent the Office Web Components library from running.
    
    **Note** The Class Identifiers and corresponding files where the library objects are contained are documented in the FAQ “What does the update do?” Replace {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX} below with the Class Identifiers found in this section.
  
    -   To set the kill bit for a CLSID with a value of {0002E510-0000-0000-C000-000000000046} and {0002E511-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.  
        Windows Registry Editor Version 5.00  
        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E510-0000-0000-C000-000000000046}\]  
        "Compatibility Flags"=dword:00000400  
        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E511-0000-0000-C000-000000000046}\]  
        "Compatibility Flags"=dword:00000400
  
    You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:
  
    -   [Group Policy Collection](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)  
    -   [What is Group Policy Object Editor?](http://technet2.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a31033.mspx?mfr=true)  
    -   [Core Group Policy Tools and Settings](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)
    
    **Note** You must restart Internet Explorer for your changes to take effect.
  
    **Impact of Workaround**: Disabling the Office Web Component prevents Internet Explorer from instantiating the control. This configuration causes program compatibility issues when Office Web Components functionality is required.
  
    **How to undo the Workaround**: You can undo the workaround documented above by following these steps:
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    -   To undo the kill bit for a CLSID with a value of {0002E510-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.  
        Windows Registry Editor Version 5.00  
        ;CLSID\_OWC9\_Spreadsheet, {0002E510-0000-0000-C000-000000000046}  
        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E510-0000-0000-C000-000000000046}\]  
        ;CLSID\_OWC9\_Spreadsheet, {0002E511-0000-0000-C000-000000000046}  
        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E511-0000-0000-C000-000000000046}\]
  
-   **Unregister the Office Web Components 2000 Library**
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    -   For Office 2000, type the following at the command prompt and select **Run**:  
        Regsvr32.exe /u "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"  
    -   For Office XP, type the following at the command prompt and select **Run**:  
        Regsvr32.exe /u "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"
  
    **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.
  
    **How to undo the Workaround:** To re-register the Office Web Components 2000, follow these steps:
  
    -   For Office 2000, type the following at the command prompt and select **Run**:  
        Regsvr32.exe "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"  
    -   For Office XP, type the following at the command prompt and select **Run**:  
        Regsvr32.exe "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"
  
#### Workarounds for Office Web Components DataSource Vulnerability – CVE-2007-1201
  
-   **Prevent Office Web Components Library from running in Internet Explorer**.
  
    You can prevent the Office Web Components Library from running in Internet Explorer by setting the kill bit for the control in the registry.
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    For detailed steps that you can use to prevent a control from running in Office Web Components, see [Microsoft Knowledge Base Article 240797](http://support.microsoft.com/kb/240797). Follow these steps in this article to create a Compatibility Flags value in the registry to prevent the Office Web Components library from running.
    
    **Note** The Class Identifiers and corresponding files where the library objects are contained are documented in the FAQ “What does the update do?” Replace {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX} below with the Class Identifiers found in this section.
  
    -   To set the kill bit for a CLSID with a value of {0002E533-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.  
        Windows Registry Editor Version 5.00  
        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E533-0000-0000-C000-000000000046}\]  
        "Compatibility Flags"=dword:00000400  
    -   To set the kill bit for a CLSID with a value of {0002E530-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.  
        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E530-0000-0000-C000-000000000046}\]  
        "Compatibility Flags"=dword:00000400
  
    You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:
  
    -   [Group Policy Collection](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)  
    -   [What is Group Policy Object Editor?](http://technet2.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a31033.mspx?mfr=true)  
    -   [Core Group Policy Tools and Settings](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)
    
    **Note** You must restart Internet Explorer for your changes to take effect.
  
    **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.
  
    **How to undo the Workaround**: You can undo the workaround documented above by following these steps:
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    -   To undo the kill bit for a CLSID with a value of {0002E510-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.  
        Windows Registry Editor Version 5.00  
        CLSID\_OWC9\_ DataSourceControl, {0002E533-0000-0000-C000-000000000046}  
        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E533-0000-0000-C000-000000000046}\]  
        CLSID\_OWC9\_ DataSourceControl, {0002E530-0000-0000-C000-000000000046}  
        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{0002E530-0000-0000-C000-000000000046}\]
  
-   **Unregister the Office Web Components 2000 Library**
  
    **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
    
    **Note** We recommend backing up the registry before you edit it.
  
    -   For Office 2000, type the following at the command prompt and select **Run**:  
        Regsvr32.exe /u "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"  
    -   For Office XP, type the following at the command prompt and select **Run**:  
        Regsvr32.exe /u "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"
  
    **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.
  
    **How to undo the Workaround:** To re-register the Office Web Components 2000, follow these steps:
  
    -   For Office 2000, type the following at the command prompt and select **Run**:  
        Regsvr32.exe "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"  
    -   For Office XP, type the following at the command prompt and select **Run**:  
        Regsvr32.exe "C:\\Program Files\\Microsoft Office\\Office\\MSOWC.DLL"
  
