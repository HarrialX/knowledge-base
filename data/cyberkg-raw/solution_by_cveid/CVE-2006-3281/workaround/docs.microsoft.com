Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-045

Workarounds for Folder GUID Code Execution Vulnerability - CVE-2006-3281:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Disable the Web Client service
Disabling the Web Client service will help protect the affected system from attempts to exploit this vulnerability. To disable the Web Client service, follow these steps:

Click Start, and then click Control Panel. Alternatively, point to Settings, and then click Control Panel.
Double-click Administrative Tools.
Double-click Services.
Double-click WebClient.
In the Startup type list, click Disabled.
Click Stop, and then click OK.

You can also stop and disable the Web Client service by using the following command at the command prompt:
sc stop WebClient & sc config WebClient start= disabled
Impact of Workaround: If the Web Client service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. If the Web Client service is disabled, any services that explicitly depend on the Web Client service will not start, and an error message will be logged in the System log. Windows Server 2003 users will not be able to use the "Open as Web Folder" functionality.

Use the Group Policy settings to disable the WebClient service on all affected systems that do not require this feature.
Because the Web Client service is a possible attack vector, disable the service by using the Group Policy settings. You can disable the startup of this service at either the local, site, domain, or organizational-unit level by using Group Policy object functionality in Windows 2000 domain environments or in Windows Server 2003 domain environments.
Note You may also review the Windows Server 2003 Security Guide. This guide includes information about how to disable services.
For more information about Group Policy, visit the following Microsoft Web sites:

Step-by-Step Guide to Understanding the Group Policy Feature Set
Windows 2000 Group Policy
Group Policy in Windows Server 2003

Impact of Workaround: If the Web Client service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. If the Web Client service is disabled, any services that explicitly depend on the Web Client service will not start, and an error message will be logged in the System log. Windows Server 2003 users will not be able to use the "Open as Web Folder" functionality.

Disable the file: protocol handler.
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
Note We recommend backing up the registry before you edit it.
To disable the file: protocol handler, follow these steps:

Close all instances of Internet Explorer
Click Start, click Run, type "regedt32 " (without the quotation marks), and then click OK
In Registry Editor, locate the following registry key:HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
Add or edit the DWORD value NoFileUrl
Set the value to 1

Impact of Workaround: URLs utilizing the file: handler will not function.

Block TCP ports 139 and 445 at the firewall:
Although WebDAV uses TCP port 80 for outbound communication, TCP ports 139 and 445 can be used outbound to attempt to connect to a malicious service and try to exploit this vulnerability. Blocking them at the firewall can help prevent systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit the following Web site.


