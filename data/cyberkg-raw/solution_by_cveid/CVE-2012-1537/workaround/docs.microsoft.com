Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-082

Workarounds for DirectPlay Heap Overflow Vulnerability - CVE-2012-1537
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Word 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Word 2003 and Microsoft Word 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.



Microsoft Office Software


Microsoft Word 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Wordl\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



Microsoft Word 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



For Microsoft Office 2010
Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.

Under Help, click Options.

Click Trust Center, and then click Trust Center Settings.

In the Trust Center, click File Block Settings.

Ensure the Open check box is selected for the following file types:
In Microsoft Word 2010:

Word 2003 Documents and Templates


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.

Click OK to apply the File Block Settings.
Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.


Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Word 2003 and Microsoft Word 2007, use the following registry scripts to undo the settings used to set the File Block policy:

Microsoft Office Software


Microsoft Word 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000


Microsoft Word 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000



For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.

 

Use Microsoft Office File Block policy to block the opening of RTF documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Word 2003 and Microsoft Word 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.



Microsoft Office Software


Microsoft Word 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Wordl\Security\FileOpenBlock]

"RtfFiles"=dword:00000001



Microsoft Word 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000001



For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Ensure the Open check box is selected for the following file types:
In Microsoft Word 2010:


RTF Files


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.
Click OK to apply the File Block Settings.

Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Word 2003 and Microsoft Word 2007, use the following registry scripts to undo the settings used to set the File Block policy:

Microsoft Office Software


Microsoft Word 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000000


Microsoft Word 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Word\Security\FileOpenBlock]

"RtfFiles"=dword:00000000



For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Prevent ActiveX controls from running in Office 2007 and Office 2010
To disable ActiveX controls in Microsoft Office 2007 and Microsoft Office 2010, perform the following steps:

Click File, click Options, click Trust Center, and then click Trust Center Settings.
Click ActiveX Settings in the left-hand pane, and then select Disable all controls without notifications.
Click OK to save your settings.

Impact of workaround. Office documents that use embedded ActiveX controls may not display as intended.
How to undo the workaround.
To re-enable ActiveX controls in Microsoft Office 2007 and Microsoft Office 2010, perform the following steps:

Click File, click Options, click Trust Center, and then click Trust Center Settings.
Click ActiveX Settings in the left-hand pane, and then deselect Disable all controls without notifications.
Click OK to save your settings.



 

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.

