Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-053

Workarounds for Windows Media Encoder Buffer Overrun Vulnerability - CVE-2008-3008
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Prevent WMEX.DLL from running in Internet Explorer
You can disable attempts to instantiate WMEX.DLL in Internet Explorer by setting the kill bit for the control in the registry.
Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.
For detailed steps that you can use to prevent a control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797. Follow these steps in this article to create a Compatibility Flags value in the registry to prevent WMEX.DLL from being instantiated in Internet Explorer.
To set the kill bit for WMEX.DLL, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
Windows Registry Editor Version 5.00
For Windows Media Encoder 9 Series running on 32-bit systems, or for Windows Media Encoder 9 Series x64 Edition running on 64-bit systems:
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{A8D3AD02-7508-4004-B2E9-AD33F087F43C}]
"Compatibility Flags"=dword:0x400
For Windows Media Encoder 9 Series running on 64-bit systems:
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{A8D3AD02-7508-4004-B2E9-AD33F087F43C}]
"Compatibility Flags"=dword:0x400
You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:

Group Policy collection
What is Group Policy Object Editor?
Core Group Policy tools and settings

Note You must restart Internet Explorer for your changes to take effect.
**Impact of workaround.**There is no impact since this control is not intended to be used in Internet Explorer.
How to undo the workaround.
To undo the workaround, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
Windows Registry Editor Version 5.00
For Windows Media Encoder 9 Series running on 32-bit systems, or for Windows Media Encoder 9 Series x64 Edition running on 64-bit systems:
[-HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{A8D3AD02-7508-4004-B2E9-AD33F087F43C}]
For Windows Media Encoder 9 Series running on 64-bit systems:
[-HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{A8D3AD02-7508-4004-B2E9-AD33F087F43C}]
You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy.
Note You must restart Internet Explorer for your changes to take effect.

Unregister WMEX.DLL
Note: Paths specified in this section are default install paths. If Windows Media Encoder 9 was not installed in the default location, verify the directory on which Windows Media Encoder is installed and modify the path specified in the examples below accordingly.
From an administrative command prompt, type the following command:
regsvr32.exe -u "%programfiles%\Windows Media Components\Encoder\wmex.dll"

Impact of workaround. Applications that rely on the Windows Media encoder may fail to work properly.
How to undo the workaround.
From an administrative command prompt, type the following command:
regsvr32.exe "%programfiles%\Windows Media Components\Encoder\wmex.dll"


Deny access to WMEX.DLL
Windows 2000, Windows XP, and Windows Server 2003:
From an administrative command prompt, type the following command:
Echo y| cacls "%programfiles%\Windows Media Components\Encoder\wmex.dll" /E /P everyone:N

Windows Vista and Windows Server 2008:
From an administrative command prompt, type the following commands:
Takeown.exe /f "%programfiles%\Windows Media Components\Encoder\wmex.dll"
Icacls.exe "%programfiles%\Windows Media Components\Encoder\wmex.dll" /save %TEMP%\WMEX_ACL.TXT
Icacls.exe "%programfiles%\Windows Media Components\Encoder\wmex.dll" /deny everyone:(F)

Impact of workaround. Applications that rely on the Windows Media encoder may fail to work properly.
How to undo the workaround.

Windows 2000, Windows XP, and Windows Server 2003:
Configure the file to inherit its permissions from the parent folder using the steps outlined in this KB article: Microsoft Knowledge Base Article 308419 or run the following command from an administrative command prompt to remove the 'everyone' account ACE:
cacls "%programfiles%\Windows Media Components\Encoder\wmex.dll" /E /R everyone

Windows Vista and Windows Server 2008:
From an administrative command prompt, type the following commands:
icacls "%programfiles%\Windows Media Components\Encoder\wmex.dll" /grant everyone:(F)
icacls "%programfiles%\Windows Media Components\Encoder\wmex.dll" /restore %TEMP%\WMEX_ACL.TXT





-   V1.1 (September 10, 2008): Corrected the "Installing without user intervention" and "Installing without restarting" switches in the **Security Update Deployment** sections for Windows Vista and Windows Server 2008. Also changed "C:\\Program Files" to "%programfiles%" in the **Workarounds for Windows Media Encoder Buffer Overrun Vulnerability - CVE-2008-3008** commands.  
-   V2.0 (September 15, 2008): Added entry to the **Frequently Asked Questions (FAQ) Related to This Security Update** section to communicate the re-release of the Norwegian language update for Windows Media Encoder 9 Series running on Microsoft Windows 2000 Service Pack 4, Windows Media Encoder 9 Series running on Windows XP Service Pack 2 and Windows XP Service Pack 3, and Windows Media Encoder 9 Series running on Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2. Customers who require the Norwegian language updates need to download and install the re-released updates.
  
*Built at 2014-04-18T13:49:36Z-07:00*

							






Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 


















Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021









Is this page helpful?



Yes



No





Any additional feedback?


Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. Privacy policy.

Skip
Submit




Thank you.

 
In this article
























Theme




















Light					



















Dark					



















High contrast					




 



Previous Version Docs
Blog
Contribute
Privacy & Cookies
Terms of Use
Trademarks
© Microsoft 2021
