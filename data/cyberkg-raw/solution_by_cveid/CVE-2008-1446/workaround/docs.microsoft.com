Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-062

#### Workarounds for Integer Overflow in IPP Service Vulnerability - CVE-2008-1446
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Disable the IPP Service**
  
    To disable IPP Service in IIS 5.0 and IIS 5.1
  
    1.  Open **Internet Services Manager**.  
    2.  Right-click the **Default Website** and choose **Properties**.  
    3.  Go to the **Home Directory** tab and select **Configuration**.  
    4.  Scroll down to find the **.printer** extension and the corresponding path to **msw3prt.dll**.  
    5.  Click **Remove**.  
    6.  Click **OK**.  
    7.  Restart the IIS Service.
    
    **Note** Internet Printing can be configured via group policy as well as via the Internet Services Manager. If there is a conflict between the group policy settings and those in the Internet Service Manager, the group policy settings take precedence. If you remove Internet Printing via the Internet Services Manager, be sure to verify that it wonâ€™t be re-enabled by either local or domain group policies. (The default group policy neither enables nor disables Internet Printing.) In the MMC Group Policy snap-in, check Computer Configuration | Administrative Templates | Printing |Web-based Printing.
  
    To disable IPP Service in IIS 6.0
  
    1.  Start **IIS Manager** or the **IIS snap-in**.  
    2.  Expand **\* server\_name**, where server\_name is the name of the server.  
    3.  Click **Web Service Extensions**.  
    4.  On the right pane, click **Internet Printing**, and then click **Prohibited**.  
    5.  Quit IIS Manager.
  
    To disable IPP Service in IIS 7.0 on Windows Server 2008
  
    1.  If **ServerManager** is not running, click **Start**, click **Administrative Tools**, and then click **Server Manager**. (If the **User Account Control** dialog box appears, confirm that the action it displays is what you want, and then click **Continue**.)  
    2.  Expand the Roles node, and then right-click **Print Services** and select **Remove Role Services**.  
    3.  The Remove Role Services wizard will appear. If the **Internet Printing** option is checked then clear the check box, click **Next**, and then **Remove** to complete the wizard.
  
    **Impact of workaround.** Users will not be able to connect to any shared printers through Internet Printing.
  
    **How to undo the workaround.**
  
    To enable IPP Service in IIS 5.0 and IIS 5.1
  
    1.  Open **Internet Services Manager**.  
    2.  Right-click the **Default Website** and choose **Properties**.  
    3.  Go to the **Home Directory** tab and select **Configuration**.  
    4.  Scroll down to find the **.printer** extension and the corresponding path to **msw3prt.dll**.  
    5.  Click **Add**.  
    6.  In the field marked **Executable**, input the following:  
        %systemroot%\\system32\\msw3prt.dll  
    7.  In the field marked **Extension**, input the following:  
        .printer  
    8.  In the field marked **Limit to**, input the following:  
        GET,POST  
    9.  Once this is complete, restart the IIS service.
  
    To enable IPP Service in IIS 6.0
  
    1.  Start **IIS Manager** or the **IIS snap-in**.  
    2.  Expand **\* server\_name**, where server\_name is the name of the server.  
    3.  Click **Web Service Extensions**.  
    4.  On the right pane, click **Internet Printing**, and then click **Allow**.  
    5.  Quit IIS Manager.
  
    To enable IPP Service in IIS 7.0
  
    1.  If **ServerManager** is not running, click **Start**, click **Administrative Tools**, and then click **Server Manager**. (If the **User Account Control** dialog box appears, confirm that the action it displays is what you want, and then click **Continue**.)  
    2.  Expand the Roles node, and then right-click **Print Services** and select **Add Role Services**.  
    3.  The Add Role Services wizard will appear. Check the **Internet Printing** option, click **Next**, and then **Install** to complete the wizard.
  
-   **Run the IIS Lockdown Tool 2.1**
  
    On Microsoft Windows 2000 running IIS 5.0 or Windows XP running IIS 5.1, the IIS Lockdown Wizard version 2.1 can be used to disable unnecessary features, including Internet Printing. To run this wizard, complete the following actions:
  
    1.  Download the IIS Lockdown Tool 2.1 from [here](https://www.microsoft.com/download/details.aspx?familyid=dde9efc0-bb30-47eb-9a61-fd755d23cdec&displaylang=en).  
    2.  Do one of the following:  
        To start the installation immediately, click **Open** or **Run this program from its current location**.  
        To copy the download to your computer for installation at a later time, click **Save** or **Save this program to disk**.
  
    **Impact of Workaround.**
  
    Users will not be able to connect to any shared printers through Internet Printing. Additionally, the IIS Lockdown tool Users will not be able to connect to any shared printers through Internet Printing. For a complete list of changes made by the IIS Lockdown tool, see the following [MSDN article](http://msdn.microsoft.com/en-us/library/aa302365.aspx).
  
    **How to undo the workaround.**
  
    To undo the changes made by IIS Lockdown, run **IISlockd.exe** a second time and choose to undo the changes. The undo operation restores the system settings that were in effect immediately before you previously ran IISLockdown. These details are contained in the log file \\WINNT\\System32\\inetsrv\\0blt-log. Therefore, it is important that you test the system promptly after you run IISLockdown. If an undo is required, perform it immediately.
    
    **Note** The URLScan ISAPI filter that is installed as part of IIS Lockdown is not removed as part of the undo process. You can remove URLScan manually by using the ISAPI filters tab at the server level in Internet Services Manager.
  
