Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-045

Workarounds for Name Validation Vulnerability - CAN-2004-0567:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block TCP port 42 and UDP port 42 at your firewall.
These ports are used to initiate a connection with a remote WINS server. Blocking these ports at the firewall will help prevent systems that are behind that firewall from being attacked by attempts to exploit this vulnerability. It is possible that other ports may be found that could be used to exploit this vulnerability. The ports that are listed are the most common attack vectors. We recommend blocking all inbound unsolicited communication from the Internet.

Remove WINS if you do not need it.
In many organizations, WINS only provides services for legacy systems. If WINS is no longer needed, you could remove it by following this procedure. These steps apply only to Windows 2000 and later versions. For Windows NT 4.0, follow the procedure that is included in the product documentation.
To configure WINS components and services:

Click Start, and then click Control Panel, open Add or Remove Programs.
In the default Category View, click Add or Remove Programs.
Click Add/Remove Windows Components.
On the Windows Components Wizard page, under Components, click Networking Services, and then click Details.
Click to clear the Windows Internet Naming Service (WINS) check box to remove WINS.
Complete the Windows Components Wizard by following the instructions on the screen.

Impact of Workaround: Many organizations require WINS to perform name registration and name resolution functions on their network. Administrators should not remove WINS unless they fully understand the affect that doing this will have on their network. For more information about WINS, see the WINS product documentation. Also, if an administrator is removing the WINS functionality from a server that will continue to provide shared resources on the network, the administrator must correctly reconfigure the system to use the remaining name resolution services within the local network. For more information about WINS visit the following Microsoft Web site. For more information about how to determine if you need NETBIOS or WINS name resolution and DNS configuration, visit the following Microsoft Web site.

On Windows 2000 Server and Windows Server 2003, use IPSec communication to secure traffic between WINS server replication partners.
Use Internet Protocol Security (IPSec) to help protect network communications. For detailed information about how to use IPSec to help protect WINS from this issue, see Microsoft Knowledge Base Article 890710.
Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.
Impact of Workaround: If you set up IPSec incorrectly, you may cause serious WINS replication problems on your corporate network. For additional information about IPSec security considerations, visit the following Microsoft Web site.


Workarounds for Association Context Vulnerability - CAN-2004-1080:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Block TCP port 42 and UDP port 42 at your firewall.
These ports are used to initiate a connection with a remote WINS server. Blocking these ports at the firewall will help prevent systems that are behind that firewall from being attacked by attempts to exploit this vulnerability. It is possible that other ports may be found that could be used to exploit this vulnerability. The ports that are listed are the most common attack vectors. We recommend blocking all inbound unsolicited communication from the Internet.

Remove WINS if you do not need it.
In many organizations, WINS only provides services for legacy systems. If WINS is no longer needed, you could remove it by following this procedure. These steps apply only to Windows 2000 and later versions. For Windows NT 4.0, follow the procedure that is included in the product documentation.
To configure WINS components and services:

Click Start, and then click Control Panel, open Add or Remove Programs.
In the default Category View, click Add or Remove Programs.
Click Add/Remove Windows Components.
On the Windows Components Wizard page, under Components, click Networking Services, and then click Details.
Click to clear the Windows Internet Naming Service (WINS) check box to remove WINS.
Complete the Windows Components Wizard by following the instructions on the screen.

Impact of Workaround: Many organizations require WINS to perform name registration and name resolution functions on their network. Administrators should not remove WINS unless they fully understand the affect that doing this will have on their network. For more information about WINS, see the WINS product documentation. Also, if an administrator is removing the WINS functionality from a server that will continue to provide shared resources on the network, the administrator must correctly reconfigure the system to use the remaining name resolution services within the local network. For more information about WINS visit the following Microsoft Web site. For more information about how to determine if you need NETBIOS or WINS name resolution and DNS configuration, visit the following Microsoft Web site.

On Windows 2000 Server and Windows Server 2003, use IPSec communication to secure traffic between WINS server replication partners.
Use Internet Protocol Security (IPSec) to help protect network communications. For detailed information about how to use IPSec to help protect WINS from this issue, see HYPERLINK "http://support.microsoft.com/kb/890710"Microsoft Knowledge Base Article 890710.
Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.
Impact of Workaround: If you set up IPSec incorrectly, you may cause serious WINS replication problems on your corporate network. For additional information about IPSec security considerations, visit the following Microsoft Web site.


