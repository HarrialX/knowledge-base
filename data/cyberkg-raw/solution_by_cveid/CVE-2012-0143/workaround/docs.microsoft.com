Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030

Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2003 and Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



For Microsoft Office 2010 
Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.

Under Help, click Options.

Click Trust Center, and then click Trust Center Settings.

In the Trust Center, click File Block Settings.

Ensure the Open check box is selected for the following file types:
In Microsoft Excel 2010:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.

Click OK to apply the File Block Settings.


Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000





For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.
 



Command to enable MOICE to be the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .pot=PowerPoint.Template.8
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2003 and Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

 [HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

 "BinaryFiles"=dword:00000001



Microsoft Excel 2007
Windows Registry Editor Version 5.00

 [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

 "BinaryFiles"=dword:00000001



For Microsoft Office 2010 
Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.

Under Help, click Options.

Click Trust Center, and then click Trust Center Settings.

In the Trust Center, click File Block Settings.

Ensure the Open check box is selected for the following file types:
In Microsoft Excel 2010:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.

Click OK to apply the File Block Settings.


Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

 [HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

 "BinaryFiles"=dword:00000000


Microsoft Excel 2007
Windows Registry Editor Version 5.00

 [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

 "BinaryFiles"=dword:00000000



For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.
 



Command to enable MOICE to be the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .pot=PowerPoint.Template.8
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2003
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001




Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.
How to undo the workaround.
For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy:
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000




Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.
 



Command to enable MOICE to be the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .pot=PowerPoint.Template.8
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007
Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.
The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
Use the registry script that is appropriate for your Office software.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileValidation]

"InvalidFileUIOptions"=dword:00000001


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security\FileValidation]

"InvalidFileUIOptions"=dword:00000001



Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.
How to undo the workaround.
Use the appropriate registry script for your software to undo the settings set by this workaround.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileValidation]

"InvalidFileUIOptions"=dword:00000000


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security\FileValidation]

"InvalidFileUIOptions"=dword:00000000




Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010
The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
Use the registry script that is appropriate for your Office software.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2010
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Security\FileValidation]

"DisableEditFromPV"=dword:00000001



Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.
How to undo the workaround.
Use the appropriate registry script for your software to undo the settings set by this workaround.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2010
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Security\FileValidation]

"DisableEditFromPV"=dword:00000000




Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2003 and Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



For Microsoft Office 2010 
Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.

Under Help, click Options.

Click Trust Center, and then click Trust Center Settings.

In the Trust Center, click File Block Settings.

Ensure the Open check box is selected for the following file types:
In Microsoft Excel 2010:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.

Click OK to apply the File Block Settings.


Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000



For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.
 



Command to enable MOICE to be the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .pot=PowerPoint.Template.8
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Set Office File Validation to disable the opening of files that fail validation in Excel 2007
Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.
The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
Use the registry script that is appropriate for your Office software.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security\FileValidation]

"InvalidFileUIOptions"=dword:00000001



Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.
How to undo the workaround.
Use the appropriate registry script for your software to undo the settings set by this workaround.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security\FileValidation]

"InvalidFileUIOptions"=dword:00000000




Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010
The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
Use the registry script that is appropriate for your Office software.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2010
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Security\FileValidation]

"DisableEditFromPV"=dword:00000001



Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.
How to undo the workaround.
Use the appropriate registry script for your software to undo the settings set by this workaround.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2010
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Security\FileValidation]

"DisableEditFromPV"=dword:00000000




Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



For Microsoft Office 2010 
Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.

Under Help, click Options.

Click Trust Center, and then click Trust Center Settings.

In the Trust Center, click File Block Settings.

Ensure the Open check box is selected for the following file types:
In Microsoft Excel 2010:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.

Click OK to apply the File Block Settings.


Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:
 



Microsoft Office Software
Registry Script


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000



For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.
 



Command to enable MOICE to be the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .pot=PowerPoint.Template.8
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locations
Microsoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.
For Microsoft Office 2003 and Microsoft Office 2007
The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.
Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000001



For Microsoft Office 2010 
Open Microsoft Excel 2010 and perform the following steps:

Click the File tab.

Under Help, click Options.

Click Trust Center, and then click Trust Center Settings.

In the Trust Center, click File Block Settings.

Ensure the Open check box is selected for the following file types:
In Microsoft Excel 2010:

Excel 2007 and later Binary Workbooks
Excel 97-2003 Add-in Files
Excel 97-2003 Workbooks and Templates
Excel 95-97 Workbooks and Templates
Excel 95 Workbooks
Excel 4 Workbooks
Excel 4 Worksheets
Excel 3 Worksheets
Excel 2 Worksheets


Under Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.

Click OK to apply the File Block Settings.


Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.
Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.
How to undo the workaround.
For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy:
 



Microsoft Office Software
Registry Script


Microsoft Excel 2003
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Office\11.0\PowerPoint\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000


Microsoft Excel 2007
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\12.0\Excel\Security\FileOpenBlock]

"BinaryFiles"=dword:00000000



For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:

Click the File tab.
Under Help, click Options.
Click Trust Center, and then click Trust Center Settings.
In the Trust Center, click File Block Settings.
Clear the Open check box for the file types that you previously selected.
Click OK to apply the File Block settings.


Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sources
Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.
The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.
To install MOICE, you must have Office 2003 or Office 2007 installed.
To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.
MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.
Enable MOICE
Note See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.
To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE.
 



Command to enable MOICE to be the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=oice.word.document


For Excel, run the following commands from a command prompt:
ASSOC .XLS=oice.excel.sheet
ASSOC .XLT=oice.excel.template
ASSOC .XLA=oice.excel.addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .PPT=oice.powerpoint.show
ASSOC .POT=oice.powerpoint.template
ASSOC .PPS=oice.powerpoint.slideshow



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.
For more information on MOICE, see Microsoft Knowledge Base Article 935865.
Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.
How to undo the workaround. Run the commands to disable MOICE as specified in the table below.
 



Command to disable MOICE as the registered handler


For Word, run the following command from a command prompt:
ASSOC .doc=Word.Document.8


For Excel, run the following commands from a command prompt:
ASSOC .xls=Excel.Sheet.8
ASSOC .xlt=Excel.Template
ASSOC .xla=Excel.Addin


For PowerPoint, run the following commands from a command prompt:
ASSOC .ppt=PowerPoint.Show.8
ASSOC .pot=PowerPoint.Template.8
ASSOC .pps=PowerPoint.SlideShow.8



Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.

Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources
Do not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file.


