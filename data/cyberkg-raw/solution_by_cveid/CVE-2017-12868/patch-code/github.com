Original Source:
https://github.com/simplesamlphp/simplesamlphp/commit/4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e

Commit history:

  @@ -404,8 +404,8 @@ public static function secureCompare($known, $user)
   return false; // length differs
          }
   $diff = 0;
-         for ($i = 0; $i < $len; ++$i) {
-  $diff |= $known[$i] ^ $user[$i];
+         for ($i = 0; $i < $len; $i++) {
+  $diff |= ord($known[$i]) ^ ord($user[$i]);
          }
   // if all the bytes in $a and $b are identical, $diff should be equal to 0
   return $diff === 0;
  
