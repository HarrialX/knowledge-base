Original Source:
https://github.com/NavigateCMS/Navigate-CMS/commit/f1f47126b359d73a2635306ae46d8719c14d240b

Commit history:

  @@ -551,7 +551,7 @@ public static function check_upload($file_upload, $extension_name)
          }
  
   // check every php file included
-  $files = core_recursive_file_search($tempdir,  '/.*\/*.php/');
+  $files = core_recursive_file_search($tempdir,  '/.*\/*.(php|phtml)/');
  
   $prohibited_functions = array(
   'eval(',
  @@ -566,8 +566,12 @@ public static function check_upload($file_upload, $extension_name)
  
   foreach($files as $file)
          {
-  // remove all spaces
+  if(!file_exists($file))
+             {
+  continue;
+             }
   $file_content = file_get_contents($file);
+  // remove all spaces
   $file_content = str_replace(array(' ', "\t", "\r", "\n"), '', $file_content);
  
   foreach($prohibited_functions as $pf)
  
