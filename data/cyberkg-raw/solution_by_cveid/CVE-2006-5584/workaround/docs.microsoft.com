Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2006/ms06-077

Workarounds for RIS Writable Path Vulnerability - CVE-2006-5584:
Microsoft has tested the following workarounds. Although these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified in the following section.

Configure the TFTP service as read only.
You can configure the TFTP service as read only by setting a value in the registry.
Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in regedit.exe.
Note We recommend backing up the registry before you edit it.
To prevent the RIS server from accepting unauthorized access, add the following to the registry using Regedit.exe.

Click Start, and click Run, type “regedit” (without the quotation marks), and the click OK.
In Registry Editor, create the following registry key:
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TFTPD\Parameters
Add the REG_SZ Value: Masters. Set the value to 0. This value disables writable TFTPD access.
You must restart the TFTP service for this change to take effect
TP service:
Click Start, click Run, type Run type “cmd” (without the quotation marks), and then click OK.
In the cmd Window type “Net stop TFTPD” (without the quotation marks) and press Enter.


Block port 69 (UDP) at the firewall.
This port is used to initiate a connection with the affected component. Blocking UDP port 69 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit the following Web site.

Stop the TFTP service if it is not needed

Click Start, click Run, type “cmd” (without the quotation marks), and then click OK.
In the cmd Window type “Net stop TFTPD” (without the quotation marks) and press Enter.

Impact of Workaround: If you disable the TFTP service, users will not be able to upload, view or write to the contents of TFTP directories.

To help protect from network-based attempts to exploit this vulnerability, enable advanced TCP/IP filtering on systems that support this feature.
You can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.

To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPSec on the affected systems.
Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in Microsoft Knowledge Base Article 313190 and Microsoft Knowledge Base Article 813878.


