Original Source:
https://github.com/MISP/MISP/commit/c1a0b3b2809b21b4df8c1efbc803aff700e262c3

Commit history:

  @@ -49,11 +49,14 @@ public function isBlacklisted($ip, $username)
   // first remove old expired rows
   $this->clean();
   // count
-  $params = array('conditions' => array(
-  'Bruteforce.ip' => $ip,
-  'Bruteforce.username' => $username),);
+  $params = array(
+  'conditions' => array(
+  'Bruteforce.ip' => $ip,
+  'LOWER(Bruteforce.username)' => trim(strtolower($username)))
+         );
   $count = $this->find('count', $params);
-  if ($count >= Configure::read('SecureAuth.amount')) {
+  $amount = Configure::check('SecureAuth.amount') ? Configure::read('SecureAuth.amount') : 5;
+  if ($count >= $amount) {
   return true;
          } else {
   return false;
  
