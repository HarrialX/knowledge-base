Original Source:
https://github.com/neomutt/neomutt/commit/1b0f0d0988e6df4e32e9f4bf8780846ea95d4485

Commit history:

  @@ -330,7 +330,7 @@ static int msg_parse_fetch(struct ImapHeader *h, char *s)
        }
        s++;
        ptmp = tmp;
-  while (*s && *s != '\"')
+  while (*s && (*s != '\"') && (ptmp != (tmp + sizeof(tmp) - 1)))
          *ptmp++ = *s++;
   if (*s != '\"')
   return -1;
  @@ -343,7 +343,7 @@ static int msg_parse_fetch(struct ImapHeader *h, char *s)
        s += 11;
   SKIPWS(s);
        ptmp = tmp;
-  while (isdigit((unsigned char) *s))
+  while (isdigit((unsigned char) *s) && (ptmp != (tmp + sizeof(tmp) - 1)))
          *ptmp++ = *s++;
        *ptmp = '\0';
   if (mutt_str_atol(tmp, &h->content_length) < 0)
  
