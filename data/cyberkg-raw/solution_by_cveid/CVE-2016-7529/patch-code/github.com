Original Source:
https://github.com/ImageMagick/ImageMagick/commit/a2e1064f288a353bc5fef7f79ccb7683759e775c

Commit history:

  @@ -347,7 +347,8 @@ static MagickBooleanType load_tile(Image *image,Image *tile_image,
      *xcfdata,
      *xcfodata;
  
-   xcfdata=(XCFPixelInfo *) AcquireQuantumMemory(data_length,sizeof(*xcfdata));
+   xcfdata=(XCFPixelInfo *) AcquireQuantumMemory(MagickMax(data_length,
+     tile_image->columns*tile_image->rows),sizeof(*xcfdata));
   if (xcfdata == (XCFPixelInfo *) NULL)
   ThrowBinaryException(ResourceLimitError,"MemoryAllocationFailed",
        image->filename);
  
