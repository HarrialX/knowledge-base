Original Source:
https://github.com/wikimedia/analytics-quarry-web/commit/4b7e1d6a3a52ec6cf826a971135a38b0f74785d2

Commit history:

  @@ -398,9 +398,15 @@ def pref_get(key):
   return "Authentication required", 401
  
   if key in get_preferences():
-  return Response(json.dumps({'key': key, 'value': get_preferences()[key]}))
+  return Response(
+  json.dumps({'key': key, 'value': get_preferences()[key]}),
+  mimetype='application/json'
+         )
   else:
-  return Response(json.dumps({'key': key, 'error': 'novalue'}))
+  return Response(
+  json.dumps({'key': key, 'error': 'novalue'}),
+  mimetype='application/json'
+         )
  
  
  @app.route("/api/preferences/set/<key>/<value>")
  @@ -409,7 +415,10 @@ def pref_set(key, value):
   return "Authentication required", 401
  
   get_preferences()[key] = (None if value == 'null' else value)
-  return Response(json.dumps({'key': key, 'success': ''})), 201
+  return Response(
+  json.dumps({'key': key, 'success': ''}),
+  mimetype='application/json'
+     ), 201
  
  
  if __name__ == '__main__':
  
