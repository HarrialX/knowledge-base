Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-033

#### Workarounds for MJPEG Decoder Vulnerability - CVE-2008-0011
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Modify the Access Control List for quartz.dll**
  
    On Windows XP (all editions), run the following command from a command prompt (requires administrative privileges):
  
    ```
    Echo y| Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /P everyone:N
    ```
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    ```
    Takeown.exe /f %WINDIR%\SYSTEM32\QUARTZ.DLL
    Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /save %TEMP%\QUARTZ_ACL.TXT
    Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /deny everyone:(F)
    ```
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista. All files will fail to play in DirectX-enabled applications on Windows XP**.**
  
    **How to undo the workaround:** On Windows XP (all editions), run the following command from a command prompt (requires administrative privileges):
  
    ```
    Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /R everyone
    ```
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    ```
    Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /grant everyone:(F)
    Icacls.exe %WINDIR%\SYSTEM32 /restore %TEMP%\QUARTZ_ACL.TXT
    ```
  
-   **Unregister the quartz.dll**
  
    Run the following command from an elevated command prompt:
  
    ```
    Regsvr32.exe –u %WINDIR%\SYSTEM32\QUARTZ.DLL
    ```
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista. All files will fail to play in DirectX-enabled applications on Windows XP.
  
    **How to undo the workaround:** Run the following command from an elevated command prompt:
  
    ```
    Regsvr32.exe %WINDIR%\SYSTEM32\QUARTZ.DLL
    ```
  
-   **Disable the MJPEG Encoder**
  
    To modify the registry key to disable the MJPEG encoder, follow these steps:
    
    **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  Locate and then click the following registry subkey:  
        HKEY\_CLASSES\_ROOT\\CLSID\\  
    3.  Right click on {301056D0-6DFF-11D2-9EEB-006008039E37} and select **Export**. Save the file to disk.  
    4.  Delete the entire {301056D0-6DFF-11D2-9EEB-006008039E37} key.  
    5.  Quit the registry editor.
  
    **Impact of workaround:** Users will not be able to play MJPEG files.
  
    **How to undo the workaround:**
  
    1.  Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.  
    2.  On the **File** menu, click **Import**.  
    3.  In **Look in**, select the drive, folder, or network computer and folder where the file you previously exported is located.  
    4.  Select the correct file name and click **Open**.
  
#### Workarounds for SAMI Format Parsing Vulnerability - CVE-2008-1444
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Modify the Access Control List for quartz.dll**
  
    On Windows XP (all editions), run the following command from a command prompt (requires administrative privileges):
  
    ```
    Echo y| Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /P everyone:N
    ```
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    ```
    Takeown.exe /f %WINDIR%\SYSTEM32\QUARTZ.DLL
    Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /save %TEMP%\QUARTZ_ACL.TXT
    Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /deny everyone:(F)
    ```
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows XP.
  
    **How to undo the workaround:** On Windows XP (all editions), run the following command from a command prompt:
  
    ```
    Cacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /E /R everyone
    ```
  
    On Windows Vista (all editions), run the following command from an elevated command prompt:
  
    ```
    Icacls.exe %WINDIR%\SYSTEM32\QUARTZ.DLL /grant everyone:(F)
    Icacls.exe %WINDIR%\SYSTEM32 /restore %TEMP%\QUARTZ_ACL.TXT
    ```
  
    -   **Unregister the quartz.dll**
  
        Run the following command from an elevated command prompt:
  
    ```
    Regsvr32.exe –u %WINDIR%\SYSTEM32\QUARTZ.DLL
    ```
  
    **Impact of workaround:** WAV and AVI files will fail to play in DirectX-enabled applications on Windows Vista.
  
    **How to undo the workaround:** Run the following command from an elevated command prompt:
  
    ```
    Regsvr32.exe %WINDIR%\SYSTEM32\QUARTZ.DLL
    ```
  
