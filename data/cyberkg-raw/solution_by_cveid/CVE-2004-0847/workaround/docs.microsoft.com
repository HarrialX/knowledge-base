Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2005/ms05-004

Workarounds for Path Validation Vulnerability - CAN-2004-0847:
Microsoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.

Apply the mitigation code module discussed in Microsoft Knowledge Base article 887289. The mitigation code module provides protection on a server-basis.
An alternative to installing the module on a per application-basis is to make the following change to the global.asax file in the application root directory for each application on an affected system:
<script runat=server language=cs>void Application_BeginRequest(object src, EventArgs e) { if (Request.Path.IndexOf('\\') >= 0 || System.IO.Path.GetFullPath(Request.PhysicalPath) != Request.PhysicalPath) { throw new HttpException(404, "not found"); }}</script>
Install and Use URLScan. URLScan will help protect against a large number of issues stemming from improperly formed URL requests including the publicly described issues addressed by this bulletin. URLScan does not protect your system as comprehensively as either the mitigation code module or the global.asax script below. Information on URLScan is available here http://www.microsoft.com/technet/security/tools/urlscan.mspx.

