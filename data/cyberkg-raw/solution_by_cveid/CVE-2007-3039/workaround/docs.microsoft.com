Original Source:
https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-065

#### Workarounds for Message Queuing Service Remote Code Execution Vulnerability â€“ CVE-2007-3039
  
Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:
  
-   **Block the following at the firewall:**  
    -   All unsolicited inbound traffic on ports greater than 1024  
    -   Any other specifically configured RPC port
  
        These ports are used to initiate a connection with RPC. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports that RPC uses, visit [TCP and UDP Port Assignments](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/cnet/cnfc_por_gdqc.mspx?mfr=true).
  
-   **Disable the Message Queuing Service:**
  
    -   Interactively:
  
        Disabling the Message Queuing service will help protect the affected system from attempts to exploit this vulnerability. To disable the Message Queuing service, follow these steps:
  
        1.  Click **Start**, and then click **Control Panel**. Alternatively, point to **Settings**, and then click **Control Panel**.  
        2.  Double-click **Administrative Tools**. Alternatively, click **Switch to Classic View** and then double-click **Administrative Tools**.  
        3.  Double-click **Services**.  
        4.  Double-click **Message Queuing**.  
        5.  In the **Startup type** list, click **Disabled**.  
        6.  Click **Stop**, and then click **OK**.
  
        You can also stop and disable the MSMQ service by using the following command at the command prompt (available in Windows XP and in the Microsoft Windows 2000 Resource Kit):
  
        `sc stop MSMQ & sc config MSMQ start= disabled`
  
    -   By Group Policy:
  
        Disable the Message Queuing service by using the Group Policy settings. You can disable the startup of this service at either the local, site, domain, or organizational-unit level by using Group Policy object functionality in Microsoft Windows 2000 domain environments or in Windows Server 2003 domain environments.
  
        **Note:** You may also review the Windows Server 2003 Security Guide. This guide includes information about how to disable services.
  
        For more information about Group Policy, visit the following Microsoft Web sites:
  
        -   [Step-by-Step Guide to Understanding the Group Policy Feature Set](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/technologies/directory/activedirectory/stepbystep/gpfeat.mspx)  
        -   [Windows 2000 Group Policy](http://technet.microsoft.com/en-us/library/bb742376.aspx)  
        -   [Group Policy in Windows Server 2003](http://www.microsoft.com/windowsserver2003/technologies/management/grouppolicy/default.mspx)
  
    **How to undo the workaround:** Use the steps above to set the Startup Type to **Automatic** and start the service.
  
